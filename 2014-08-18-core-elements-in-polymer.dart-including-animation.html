---
title: 'Core Elements in Polymer.Dart (Including Animation)'
layout: post
published: '2014-08-18T23:59:00-04:00'
feed: 'japh(r) by Chris Strom'
link: 'http://feedproxy.google.com/~r/JaphrByChrisStrom/~3/pkG_UmpWfkI/core-elements-in-polymerdart-including.html'
author:
    name: 'Chris Strom'
    email: noreply@blogger.com
    url: 'https://plus.google.com/117928918793969810642'
tags:
    - chain
    - core-elements
    - dart
    - dartlang
    - 'material design'
    - paper-elements
    - polymer

---

<div class="top-chain-links"></div><br />When last I tried to use <a href="http://www.polymer-project.org/docs/elements/core-elements.html">Core Element</a> in <a href="https://www.dartlang.org/polymer-dart/">Polymer.dart</a>, it <a href="http://japhr.blogspot.com/2014/06/non-worky-attempts-at-core-elements-in.html">did not go well</a>. I know the team has made incredible progress in the interim, so tonight seems an opportune time to find out how much better things are.<br /><br />The Core and <a href="http://www.polymer-project.org/docs/elements/paper-elements.html">Paper</a> element work that I have been building in the JavaScript <code>&lt;x-pizza&gt;</code> element should be a solid test. I start, as I do with all <a href="http://dartlang.org/">Dart</a> projects, with a <code>pubspec.yaml</code> including Paper and Core dependencies:<br /><pre class="prettyprint">name: paper<br />dependencies:<br />  polymer: any<br /><b>  core_elements: any<br />  paper_elements: any</b><br />dev_dependencies:<br />  scheduled_test: any<br />transformers:<br />- polymer:<br />    entry_points:<br />    - web/index.html<br />    - test/index.html</pre>A quick <code>pub install</code> and I should be good to go:<br /><pre class="prettyprint">$ pub install<br />Resolving dependencies... (1.4s)<br />Downloading paper_elements 0.1.0+3...<br />Downloading core_elements 0.1.1+2...<br />Downloading quiver 0.18.2...<br />Got dependencies!</pre>I add some initial core imports and elements to the <code>&lt;x-pizza-toppings&gt;</code> child element:<br /><pre class="prettyprint">&lt;link rel="import" href="../../../packages/polymer/polymer.html"&gt;<br /><b>&lt;link rel="import" href="../../../packages/core_elements/core_icons.html"&gt;<br />&lt;link rel="import" href="../../../packages/core_elements/core_item.html"&gt;</b><br />&lt;polymer-element name="x-pizza-toppings"&gt;<br />  &lt;template&gt;<br />    &lt;!-- ... --&gt;<br />    &lt;template repeat="{{ingredient in ingredients}}"&gt;<br /><b>      &lt;core-item<br />         icon="add-circle"<br />         label="{{ingredient}}"<br />         on-tap="{{add}}"&gt;<br />      &lt;/core-item&gt;</b><br />    &lt;/template&gt;<br />    &lt;!-- ... --&gt;<br />  &lt;/template&gt;<br />  &lt;script type="application/dart" src="x_pizza_toppings.dart"&gt;&lt;/script&gt;<br />&lt;/polymer-element&gt;</pre>And, when I load things up in <a href="http://www.dartlang.org/dartium/">Dartium</a>, I get a nice old failure:<br /><pre class="prettyprint">Exception: Unsupported operation: Couldn't find `document._registerDartTypeUpgrader`. Please make sure that `packages/web_components/dart_support.js` is loaded and available before calling this function.</pre>Aha! So that is what the <code>dart_support.js</code> script does. I know that it is included in generated Polymer.dart code, but until now I could find no use for it.<br /><br />To resolve, I add this back in the main <code>index.html</code> page that pulls in Polymer, the Polymer elements that I want to use, and initializes everything:<br /><pre class="prettyprint">&lt;!DOCTYPE html&gt;<br />&lt;html lang="en"&gt;<br />  &lt;head&gt;<br />    &lt;!-- Load platform polyfills --&gt;<br />    &lt;script src="packages/web_components/platform.js"&gt;&lt;/script&gt;<br /><b>    &lt;script src="packages/web_components/dart_support.js"&gt;&lt;/script&gt;</b><br /><br />    &lt;!-- Load component(s) --&gt;<br />    &lt;link rel="import"<br />          href="packages/paper/elements/x-pizza.html"&gt;<br /><br />    &lt;!-- Start Polymer --&gt;<br />    &lt;script type="application/dart"&gt;<br />      export 'package:polymer/init.dart';<br />    &lt;/script&gt;<br />  &lt;/head&gt;<br />  &lt;body&gt;<br />    &lt;div class="container"&gt;<br />      &lt;h1&gt;Ye Olde Dart Pizza Shoppe&lt;/h1&gt;<br />      &lt;x-pizza&gt;&lt;/x-pizza&gt;<br />    &lt;/div&gt;<br />  &lt;/body&gt;<br />&lt;/html&gt;<br /></pre>That aside, there are relatively few issues that I have to address converting the <code>&lt;x-pizza></code> element from JavaScript to Dart. I have to mark properties that are used in the template as <code>@observable</code>. I believe that was the only “significant” change required and it was not that difficult.<br /><br />I do note that I can omit the import of transitions (i.e. the hero transition code). When I was building the JavaScript version, I thought this was required, but even after double checking the JavaScript version, it seems that importing the <code>core-animated-pages</code> is sufficient to pull in the transition code, which makes sense:<pre class=prettyprint>&lt;link rel="import" href="../../../packages/polymer/polymer.html"><br />&lt;link rel="import" href="../../../packages/core_elements/core_icon.html"><br />&lt;link rel="import" href="../../../packages/core_elements/core_pages.html"><br /><b>&lt;link rel="import" href="../../../packages/core_elements/core_animated_pages.html"></b><br />&lt;link rel="import" href="x-pizza-toppings.html"><br />&lt;polymer-element name="x-pizza"><br />  &lt;template><br />    &lt;!-- ... --><br />    &lt;core-animated-pages selected="{{toppingsListOrDetails}}" transitions="hero-transition"><br />      &lt;!-- ... --><br />    &lt;/core-animated-pages><br />  &lt;/template><br />  &lt;script type="application/dart" src="x_pizza.dart">&lt;/script><br />&lt;/polymer-element><br /></pre>And all of this works just fine:<br /><br /><div class="separator" style="clear: both; text-align: center;"><object width="320" height="266" class="BLOG_video_class" id="BLOG_video-9d94059d0ceecfdd" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0"><param name="movie" value="//www.youtube.com/get_player"><param name="bgcolor" value="#FFFFFF"><param name="allowfullscreen" value="true"><param name="flashvars" value="flvurl=http://redirector.googlevideo.com/videoplayback?id%3D9d94059d0ceecfdd%26itag%3D5%26source%3Dblogger%26app%3Dblogger%26cmo%3Dsensitive_content%3Dyes%26ip%3D0.0.0.0%26ipbits%3D0%26expire%3D1412294986%26sparams%3Dip,ipbits,expire,id,itag,source%26signature%3D45A5B9438D697EC8678C58ABED1C8BBDB667A509.16E908B7A51F221165FC34BEB3F7A94665103190%26key%3Dck2&amp;iurl=http://video.google.com/ThumbnailServer2?app%3Dblogger%26contentid%3D9d94059d0ceecfdd%26offsetms%3D5000%26itag%3Dw160%26sigh%3DKljOVAZRTvFOZULVhAYGWO2W1CY&amp;autoplay=0&amp;ps=blogger"><embed src="//www.youtube.com/get_player" type="application/x-shockwave-flash" width="320" height="266" bgcolor="#FFFFFF" flashvars="flvurl=http://redirector.googlevideo.com/videoplayback?id%3D9d94059d0ceecfdd%26itag%3D5%26source%3Dblogger%26app%3Dblogger%26cmo%3Dsensitive_content%3Dyes%26ip%3D0.0.0.0%26ipbits%3D0%26expire%3D1412294986%26sparams%3Dip,ipbits,expire,id,itag,source%26signature%3D45A5B9438D697EC8678C58ABED1C8BBDB667A509.16E908B7A51F221165FC34BEB3F7A94665103190%26key%3Dck2&iurl=http://video.google.com/ThumbnailServer2?app%3Dblogger%26contentid%3D9d94059d0ceecfdd%26offsetms%3D5000%26itag%3Dw160%26sigh%3DKljOVAZRTvFOZULVhAYGWO2W1CY&autoplay=0&ps=blogger" allowFullScreen="true" /></object></div><br />Well, maybe 100% fine. I need to figure out why the icons are the wrong size. There is also a flash of unstyled CSS when the page first loads. I think this would not be an issue if the element were compiled to JavaScript (instead of loaded via <code>pub serve</code>)—something to check another day. Those minor issues aside, this worked pretty well. Infinitely better than the last time I tried it!<br /><br /><br /><span style="color: #cccccc;">Day #156</span>  <br /><br /><div class="bottom-chain-links"><a href="http://japhr.blogspot.com/2014/08/polymer-track-and-holdpulse-events.html">‹prev</a> | <a href="http://japhr.blogspot.com/2013/11/new-chain-patterns-in-polymer.html">My Chain</a> | <a href="http://japhr.blogspot.com/2014/08/core-icon-in-polymerdart.html">next›</a> </div><script>var b_links = document.getElementsByClassName('bottom-chain-links'),      t_links = document.getElementsByClassName('top-chain-links');  if (b_links.length == 1 && t_links.length == 1) {   t_links[0].innerHTML = b_links[0].innerHTML; } </script><img src="http://feeds.feedburner.com/~r/JaphrByChrisStrom/~4/pkG_UmpWfkI" height="1" width="1"/>
