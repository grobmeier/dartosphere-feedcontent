---
title: 'A Nearly Modern Factory Method Pattern'
layout: post
published: '2016-02-09T22:16:00-08:00'
feed: 'japh(r) by Chris Strom'
link: 'http://feedproxy.google.com/~r/JaphrByChrisStrom/~3/98SPXfx4S8E/a-nearly-modern-factory-method-pattern.html'
author:
    name: 'Chris Strom'
    email: noreply@blogger.com
    url: 'https://plus.google.com/117928918793969810642'
tags:
    - chain
    - dart
    - dartlang
    - 'design patterns'
    - 'factory method pattern'

---

<div class=top-chain-links></div><br />I could make do with the examples of the <a href="https://en.wikipedia.org/wiki/Factory_method_pattern">factory method pattern</a> that I have been using. Still, I would prefer an example that touches the modern web a little closer. Or at least the web. So tonight I try my hand at a venerable, if simple, form builder.<br /><br />I am not going to worry too much about the details of adding different types of HTML form inputs at this point. To kick things off, I start by adding variations of text input fields to a container. So my <a href="http://dartlang.org">Dart</a> abstract creator class declares that it needs to be constructed with a container element:<pre class=prettyprint>abstract class FormBuilder {<br />  Element container;<br />  FormBuilder(this.container);<br />}</pre>Next, I declare an <code>addInput()</code> method that will append an input field to the container:<pre class=prettyprint>abstract class FormBuilder {<br />  // ...<br />  void addInput() {<br />    var input = _labelFor(inputElement);<br />    container.append(input);<br />  }<br />  // ...<br />}</pre>The <code>_labelFor()</code> helper method is unimportant in this discussion. It merely adds a text label to the input element. What is important here is the <code>inputElement</code> property. That is going to be the factory method in the factory method pattern. It lacks the usual trailing parentheses because it will be a getter method:<pre class=prettyprint>abstract class FormBuilder {<br />  // ...<br />  InputElement get inputElement;<br />  // ...<br />}</pre>It lacks a method body because the definition of what <code>inputElement</code> does will have to come from subclasses.<br /><br />Putting these all together, I have a prototypical "creator" in the factory method pattern:<pre class=prettyprint>abstract class FormBuilder {<br />  Element container;<br />  FormBuilder(this.container);<br />  void addInput() {<br />    var input = _labelFor(inputElement);<br />    container.append(input);<br />  }<br />  InputElement get inputElement;<br />  // ...<br />}</pre>It declares a factory method, <code>inputElement</code>, and an operation that uses that factory, <code>addInput()</code>. The <code>creator</code> in the classic factory method pattern is an interface for concrete implementations. <br /><br />For a first pass at a concrete creator class, I declare a <code>RandomBuilder</code> class. As the name implies, the <code>inputElement</code> factory method randomly chooses from a selection of input element types:<pre class=prettyprint>import 'dart:math' show Random;<br /><br />class RandomBuilder extends FormBuilder {<br />  RandomBuilder(el): super(el);<br />  InputElement get inputElement {<br />    var rand = new Random().nextInt(6);<br /><br />    if (rand == 0) return new WeekInputElement();<br />    if (rand == 1) return new NumberInputElement();<br />    if (rand == 2) return new TelephoneInputElement();<br />    if (rand == 3) return new UrlInputElement();<br />    if (rand == 4) return new TimeInputElement();<br />    return new TextInputElement();<br />  }<br />}</pre>The other piece of the pattern is the "product." The product in this case the standard <code>InputElement</code> from <code>dart:html</code> â€” nobody ever said that the product had be a hand-coded class, after all. Given that, the concrete products are the various types of input elements that are randomly returned from the getter factory method.<br /><br />And there you have it: a simple, web implementation of the factory method pattern! <br /><br />I can use this in client code by creating a new form builder element as part of a button click handler:<pre class=prettyprint><code>  var button = new ButtonElement()<br />    ..appendText('Build Input')<br />    ..onClick.listen((_){<br />        new RandomBuilder(container).addInput();<br />      });</code></pre>This might be a little too simplistic, but I rather like the example. It feels accessible for most web developers. It could also serve as a building block for further examples. I may continue to explore slightly more modern examples tomorrow, though other patterns beckon. Stay tuned!<br /> <br /><br /><i>Play with the code on DartPad: <a href="https://dartpad.dartlang.org/ed63a78724e4a8605793">https://dartpad.dartlang.org/ed63a78724e4a8605793</a>.</i><br /><br /><br /><span style="color: #ccc">Day #90</span>  <br /><br /><p class=bottom-chain-links><a href="http://japhr.blogspot.com/2016/02/silly-factories-in-factory-method.html">&lsaquo;prev</a> | <a href="http://japhr.blogspot.com/2015/11/design-patterns-in-dart.html">My Chain</a> | <span style="color: #ccc">next&rsaquo;</span> </p><script>var b_links = document.getElementsByClassName('bottom-chain-links'),      t_links = document.getElementsByClassName('top-chain-links');  if (b_links.length == 1 && t_links.length == 1) {   t_links[0].innerHTML = b_links[0].innerHTML; } </script><img src="http://feeds.feedburner.com/~r/JaphrByChrisStrom/~4/98SPXfx4S8E" height="1" width="1" alt=""/>
