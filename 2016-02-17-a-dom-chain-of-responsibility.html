---
title: 'A DOM Chain of Responsibility'
layout: post
published: '2016-02-17T23:10:00-08:00'
feed: 'japh(r) by Chris Strom'
link: 'http://feedproxy.google.com/~r/JaphrByChrisStrom/~3/R2qqH99HHj4/a-dom-chain-of-responsibility.html'
author:
    name: 'Chris Strom'
    email: noreply@blogger.com
    url: 'https://plus.google.com/117928918793969810642'
tags:
    - chain
    - 'chain of responsibility pattern'
    - dart
    - dartlang
    - 'design patterns'

---

<div class=top-chain-links></div><br />A major theme of the forthcoming <a href="http://designpatternsindart.com/">Design Patterns in Dart</a> is that design patterns are more useful for describing how systems are already designed, not for designing systems in the first place. The implications and applicability of patterns then aid programmers to understand how systems can evolve, once patterns are recognized in them. <br /><br />With that in mind... consider a <code>&lt;div></code> with ID of "bottom" inside a <code>&lt;div></code> with ID of "middle" inside a <code>&lt;div></code> with ID of "top":<br /><br /><a href="https://1.bp.blogspot.com/-zqlF_A7iSj8/VsVnpobc29I/AAAAAAABEKY/09oCAIbz9lg/s1600/01-chain_of_responsibility.png" imageanchor="1" ><img border="0" src="https://1.bp.blogspot.com/-zqlF_A7iSj8/VsVnpobc29I/AAAAAAABEKY/09oCAIbz9lg/s640/01-chain_of_responsibility.png" width=570 /></a><br /><br />There are three <a href="http://dartlang.org">Dart</a> element objects:<pre class=prettyprint><code>  var bottom = query('#bottom'),<br />    middle = query('#middle'),<br />    top = query('#top');</code></pre>If the bottom-most sees a request in the form of a click without modifier key, then it handles the request, preventing successors from seeing the request:<pre class=prettyprint><code>  bottom.onClick.listen((e){<br />    if (e.ctrlKey) return;<br />    if (e.shiftKey) return;<br /><br />    bottom.style.border =<br />      bottom.style.border.contains('green') ?<br />        '' : '3px green dashed';<br />    e.stopPropagation();<br />  });</code></pre>But if modifier key (shift or control) is held down while clicking in the middle of the "bottom" <code>&lt;div></code>, the request passes along to the successor. The next element object in line here is the "middle" <ocde>&lt;div></code>. If the request is received by this object with the shift key depressed, it handles the request, preventing successor from seeing the request:<pre class=prettyprint><code>  middle.onClick.listen((e){<br />    if (e.ctrlKey) return;<br /><br />    middle.style.border =<br />      middle.style.border.contains('blue') ?<br />        '' : '3px blue dashed';<br />    e.stopPropagation();<br />  });</code></pre>Finally, if it is not the control key, but the shift key that is depressed while clicking the "bottom" element, the request passes through both the <code>bottom</code> handler and the <code>middle</code> handler—both of which opt not to handle the request. In this case, the request is finally handled by <code>top</code>:<pre class=prettyprint><code class="lang-dart">  top.onClick.listen((_){<br />    top.style.border =<br />      top.style.border.contains('orange') ?<br />        '' : '3px orange dotted';<br />  });</code></pre>So is this a chain of responsibility pattern? Of course! There are concrete handler objects all of the same type. They all declare the same method to process a request object. The method may be in the form of an event listener instead of a pure method, but the overall intent and structure is the same. This is a chain of responsibility—and one that just about every web developer implemented at some point without thinking about the pattern.<br /><br />And the implications and applicability? Well, that's a tale for another day.<br /><br /><i>Play with the code on DartPad: <a href="https://dartpad.dartlang.org/12bf7fa9c76c6d16fe5f">https://dartpad.dartlang.org/12bf7fa9c76c6d16fe5f</a>.</i><br /><br /><br /><span style="color: #ccc">Day #98</span>  <br /><br /><p class=bottom-chain-links><a href="http://japhr.blogspot.com/2016/02/in-which-i-take-things-one-step-too-far.html">&lsaquo;prev</a> | <a href="http://japhr.blogspot.com/2015/11/design-patterns-in-dart.html">My Chain</a> | <a href="http://japhr.blogspot.com/2016/02/delegated-events-chain-of-responsibility.html">next&rsaquo;</a> </p><script>var b_links = document.getElementsByClassName('bottom-chain-links'),      t_links = document.getElementsByClassName('top-chain-links');  if (b_links.length == 1 && t_links.length == 1) {   t_links[0].innerHTML = b_links[0].innerHTML; } </script><img src="http://feeds.feedburner.com/~r/JaphrByChrisStrom/~4/R2qqH99HHj4" height="1" width="1" alt=""/>
