---
title: 'Not-So-Simple Mouse Animations in SVG'
layout: post
published: '2014-05-21T23:59:00-04:00'
feed: 'japh(r) by Chris Strom'
link: 'http://feedproxy.google.com/~r/JaphrByChrisStrom/~3/u--iZ1qRapk/simple-mouse-animations-in-svg.html'
author:
    name: 'Chris Strom'
    email: noreply@blogger.com
    url: 'https://plus.google.com/117928918793969810642'
tags:
    - chain
    - dart
    - dartlang
    - inkscape
    - polymer
    - svg

---

<div class=top-chain-links></div><br />I am curious about SVG animation in <a href="http://www.polymer-project.org/">Polymer</a>. I already have a little animation working in my <code>&lt;x-pizza></code> custom pizza builder element:<br /><br /><a href="http://3.bp.blogspot.com/-JRgy_CQJVSQ/U31wNQDSNsI/AAAAAAAAZo4/rY_uJzzn2bM/s1600/03-x_pizza_with_svg_images.png" imageanchor="1" ><img border="0" src="http://3.bp.blogspot.com/-JRgy_CQJVSQ/U31wNQDSNsI/AAAAAAAAZo4/rY_uJzzn2bM/s320/03-x_pizza_with_svg_images.png" /></a><br /><br />When new toppings are added, they glide in from the left and float down onto the pizza. I do not want to categorize the implementation of this animation as ugly, so let's just call it… <a href="http://japhr.blogspot.com/2014/01/day-1000-animated-svg-in-polymer.html">involved</a>. I have two separate <code>window.requestAnimationFrame()</code> timers running to translate the X and Y coordinates of the group containing the toppings. The solution may be involved, but it works brilliantly—low overhead and quite smooth.<br /><br />Still, I would like to improve my SVG animation skills so tonight I try something a little simpler: animating toppings on mouse-over. In particular, I would like the topping to pop-up with a drop shadow when the discerning pizza buyer hovers over the individual topping.<br /><br />I have come across JavaScript callbacks inside Inkscape:<br /><br /><a href="http://3.bp.blogspot.com/-SVxYIdXn9hs/U31xohBlrOI/AAAAAAAAZpA/BD5AAcx4ixQ/s1600/01-interactivty_hunh.png" imageanchor="1" ><img border="0" src="http://3.bp.blogspot.com/-SVxYIdXn9hs/U31xohBlrOI/AAAAAAAAZpA/BD5AAcx4ixQ/s400/01-interactivty_hunh.png" /></a><br /><br />But I'll be darned if I can figure out what to put in those fields. Besides, I am currently coding in <a href="http://dartlang.org">Dart</a>, so that seems less than ideal.<br /><br />Instead, I define two different layers for this particular SVG. The “rest” state layer, which I name “down”:<br /><br /><a href="http://4.bp.blogspot.com/-hoIozK4XNTM/U31yRouL4NI/AAAAAAAAZpI/qzh3l1w4MMs/s1600/02-down.png" imageanchor="1" ><img border="0" src="http://4.bp.blogspot.com/-hoIozK4XNTM/U31yRouL4NI/AAAAAAAAZpI/qzh3l1w4MMs/s400/02-down.png" /></a><br /><br />And the on-hover layer, which I name “up”:<br /><br /><a href="http://1.bp.blogspot.com/-U6U2dsUdzBo/U31yRr4k_0I/AAAAAAAAZpM/nUsA8PlevMA/s1600/03-up_loayer.png" imageanchor="1" ><img border="0" src="http://1.bp.blogspot.com/-U6U2dsUdzBo/U31yRr4k_0I/AAAAAAAAZpM/nUsA8PlevMA/s400/03-up_loayer.png" /></a><br /><br />When I save this as plain (not Inkscape formatted) SVG, I leave the “eye” icon on the Up layer closed so that the image will default to the down/rest state. Checking the saved SVG, this is indeed styled with <code>style="display:none"</code> on the Up layer:<pre class=prettyprint>&lt;?xml version="1.0" encoding="UTF-8" standalone="no"?><br />&lt;!-- Created with Inkscape (http://www.inkscape.org/) --><br />&lt;svg<br />   xmlns:svg="http://www.w3.org/2000/svg"<br />   xmlns="http://www.w3.org/2000/svg"<br />   version="1.1"<br />   width="32"<br />   height="32"><br />  &lt;defs><br />    &lt;filter<br />       color-interpolation-filters="sRGB"<br />       id="filter3790"><br />      &lt;!-- drop shadow filter definition here... --><br />    &lt;/filter><br />  &lt;/defs><br />  &lt;g<br />     id="down"<br />     style="display:inline"><br />    &lt;path<br />       d="M 22,12 A 10,10 0 1 1 2,12 10,10 0 1 1 22,12 z"<br />       transform="translate(2.8577037,1.6074583)"<br />       style="fill:#d40000;fill-opacity:1;stroke:#000000;stroke-width:1.5;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none" /><br />  &lt;/g><br />  &lt;g<br />     id="up"<br /><b>     style="display:none"></b><br />    &lt;path<br />       d="M 22,12 A 10,10 0 1 1 2,12 10,10 0 1 1 22,12 z"<br />       style="fill:#d40000;fill-opacity:1;stroke:#000000;stroke-width:1.5;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none;filter:url(#filter3790)" /><br />  &lt;/g><br />&lt;/svg></pre>I had to manually edit those <code>id</code> attributes.<br /><br />To animate, I then add some mouse stream event listeners:<pre class=prettyprint><code>  _svgImage(basename) => new GElement()..append(<br />    new ImageElement()<br />      ..setAttributeNS(<br />          'http://www.w3.org/1999/xlink',<br />          'href',<br />          '/packages/svg_example/images/$basename.svg'<br />        )<br />      ..setAttribute('width', '32')<br />      ..setAttribute('height', '32')<br /><b>      ..onMouseOver.listen((e){<br />          this.query('#up').style.display = '';<br />          this.query('#down').style.display = 'none';<br />        })<br />      ..onMouseLeave.listen((e){<br />          this.query('#up').style.display = 'none';<br />          this.query('#down').style.display = '';<br />        })</b><br />   );</code></pre>The problem with that approach is that the up and down layers are in the image that is loaded into the <code>ImageElement</code> object:<pre class=prettyprint><code>    new ImageElement()<br />      ..setAttributeNS(<br />          'http://www.w3.org/1999/xlink',<br />          'href',<br />          '/packages/svg_example/images/$basename.svg'<br />        )<br />        // ...</code></pre>As such, when I query for the up and down layers, they are not in the ImageElement that I am dynamically creating. They are in the SVG image file that is loaded by virtue of that <code>href</code> attribute. And I cannot figure out how to dynamically gain access to it.<br /><br />On a lark, I try adding onmouseover attributes to the static SVG file. I also try defining <code>&lt;style></code> tags within the static SVG. Neither seems to have an effect when loaded from an <code>ImageElement</code>—both work when the static SVG is loaded directly, but not in my application code. So I would seem to be at an impasse. <br /><br />There must be some way to get at the underlying SVG when loaded as an <code>&lt;image></code>. I will continue digging for it tomorrow.<br /><br /><br /><br /><span style="color: #ccc">Day #70</span>  <br /><br /><p class=bottom-chain-links><a href="http://japhr.blogspot.com/2014/05/limited-svg-manipulation-in-dart.html">&lsaquo;prev</a> | <a href="http://japhr.blogspot.com/2013/11/new-chain-patterns-in-polymer.html">My Chain</a> | <a href="http://japhr.blogspot.com/2014/05/polymer-elements-loading-svg-in-polymer.html">next&rsaquo;</a> </p><script>var b_links = document.getElementsByClassName('bottom-chain-links'),      t_links = document.getElementsByClassName('top-chain-links');  if (b_links.length == 1 && t_links.length == 1) {   t_links[0].innerHTML = b_links[0].innerHTML; } </script><img src="http://feeds.feedburner.com/~r/JaphrByChrisStrom/~4/u--iZ1qRapk" height="1" width="1"/>
