---
title: 'Using the google-map Polymer in Polymer.dart Elements'
layout: post
published: '2015-03-27T00:52:00-04:00'
feed: 'japh(r) by Chris Strom'
link: 'http://feedproxy.google.com/~r/JaphrByChrisStrom/~3/Lxpha9qcXlU/using-google-map-polymer-in-polymerdart.html'
author:
    name: Anonymous
    email: noreply@blogger.com
    url: 'http://www.blogger.com/profile/00135361916531185929'
tags:
    - chain
    - dart
    - dartlang
    - google-maps
    - google-maps-api
    - js-interop
    - polymer

---

<div class=top-chain-links></div><br />Thanks to the magic of <a href="https://pub.dartlang.org/packages/custom_element_apigen">custom_element_apigen</a>, I was able to use the JavaScript <code>&lt;google-map></code> <a href="http://www.polymer-project.org/">Polymer</a> element in a <a href="http://dartlang.org">Dart</a> application last night. In the end it was, dare I say it, easy. <br /><br />Tonight, I would like to dynamically use <code>&lt;google-map></code> from a custom built <a href="https://www.dartlang.org/polymer-dart/">Polymer.dart</a> element, let's call it <code>&lt;x-map></code>. I start by altering my sample page to import this definition instead of directly pulling in the custom_element_apigen version of <code>&lt;google-map></code>:<pre class=prettyprint>&lt;html lang="en"><br />  &lt;head><br />    &lt;script type="application/dart"><br /><b>      import 'package:my_maps/elements/x_map.dart';</b><br />      export 'package:polymer/init.dart';<br />    &lt;/script><br />  &lt;/head><br />  &lt;body unresolved><br />    &lt;div class="container"><br />      &lt;h1>A Simple Map...&lt;/h1><br /><b>      &lt;x-map latitude="39.283" longitude="-76.616">&lt;/x-map></b><br />    &lt;/div><br />  &lt;/body><br />&lt;/html></pre>Instead of the usual, boring map of San Francisco, I start with coordinates of a city with some character. In the backing class defined in <code>x_map.dart</code>, I need to support the latitude and longitude attributes. I also need to import the <code>&lt;google-map></code> element:<pre class=prettyprint>@HtmlImport('x-map.html')<br />library x_map;<br /><br />import 'package:polymer/polymer.dart';<br /><b>import '../google_map.dart';</b><br /><br />@CustomTag('x-map')<br />class XMap extends PolymerElement {<br /><b>  @published float latitude = 0.0;<br />  @published float longitude = 0.0;</b><br /><br />  XMap.created(): super.created();<br />}</pre>As a side-note, I confess that I am alarmed at how quickly I am getting used to this code-import of Polymer definitions. I have used the <code>&lt;link></code> imports throughout  <a href="http://patternsinpolymer.com/">Patterns in Polymer</a>. It would be hard to switch at this point—especially since the JavaScript version of the book would still have to use <code>&lt;link></code> imports—but darn these are nice.<br /><br />At any rate, I import <code>google_map.dart</code>, which is the Dart wrapper generated last night. I also annotate my desired, published attributes. So next up is the HTML template definition.<br /><br />My first pass at <code>&lt;x-map></code> is a trivial Polymer template. In it, I bind my latitude and longitude attributes in the <code>&lt;google-map></code> attributes of the same name:<pre class=prettyprint>&lt;polymer-element name="x-map"><br />  &lt;template><br />    &lt;h1>x map&lt;/h1><br /><b>    &lt;google-map<br />       latitude="{{latitude}}"<br />       longitude="{{longitude}}">&lt;/google-map></b><br />    &lt;style><br />      @import '/packages/my_maps/assets/bootstrap.min.css';<br /><b>      google-map {<br />        height: 600px;<br />      }</b><br />    &lt;/style><br />  &lt;/template><br />&lt;/polymer-element></pre>I need to style <code>&lt;google-map></code> lest it display with zero height. With that, I have a working custom Polymer element that itself uses a Google map:<br /><br /><a href="http://1.bp.blogspot.com/-x6g_C54ioIU/VRTSvCof6sI/AAAAAAAAoAg/ZPqmx90KUyg/s1600/01-x_map_balitmore.png" imageanchor="1" ><img border="0" src="http://1.bp.blogspot.com/-x6g_C54ioIU/VRTSvCof6sI/AAAAAAAAoAg/ZPqmx90KUyg/s400/01-x_map_balitmore.png" /></a><br /><br />Next up, I would like to verify that I can easily update attributes of <code>&lt;google-map></code> from my custom element. I could add text fields, but that's dull. Let's try a <code>paper-slider</code> instead.<br /><br />I update the <a href="http://pub.dartlang.org/">Dart Pub</a> packaging configuration to include paper elements:<pre class=prettyprint>name: my_maps<br />dependencies:<br />  polymer: any<br /><b>  paper_elements: any</b><br />dev_dependencies:<br />  custom_element_apigen: any<br />transformers:<br />- polymer:<br />    entry_points:<br />    - web/index.html</pre>After a quick <code>pub install</code> I am ready to add a slider to my element. I import it into the backing class:<pre class=prettyprint>@HtmlImport('x-map.html')<br />library x_map;<br /><br />import 'package:polymer/polymer.dart';<br /><b>import 'package:paper_elements/paper_slider.dart';</b><br />import '../google_map.dart';<br /><br />@CustomTag('x-map')<br />class XMap extends PolymerElement {<br />  // ...<br />}</pre>Then add it to the HTML template definition:<pre class=prettyprint>&lt;polymer-element name="x-map"><br />  &lt;template><br />    &lt;h1>x map&lt;/h1><br />    &lt;google-map<br />       latitude="{{latitude}}"<br />       longitude="{{longitude}}">&lt;/google-map><br /><br />    &lt;p><br /><b>      &lt;paper-slider <br />         min="{{longitude - 2}}"<br />         max="{{longitude + 2}}" <br />         value="{{longitude}}">&lt;/paper-slider></b><br />    &lt;/p><br />    &lt;>-- ... --><br />  &lt;/template><br />&lt;/polymer-element></pre>That works brilliantly:<br /><br /><a href="http://1.bp.blogspot.com/-wW6t_PWSSCM/VRTVpDmHRyI/AAAAAAAAoAs/g-_E9xNprnc/s1600/02-slider_hooked_to_map.png" imageanchor="1" ><img border="0" src="http://1.bp.blogspot.com/-wW6t_PWSSCM/VRTVpDmHRyI/AAAAAAAAoAs/g-_E9xNprnc/s400/02-slider_hooked_to_map.png" /></a><br /><br />The slider is bound to the longitude of the map, so updating it (as I did above by clicking to the right) updates my element's longitude, which is bound to the <code>&lt;google-map></code> longitude. The end result is that updating the slider updates the map.<br /><br />So far, working with <code>&lt;google-map></code> from Polymer.dart seems quite nice. Up tomorrow, I think that I would like to add custom children to  my custom <code>&lt;x-map></code> such that they act as markers on the map. I have the feeling that the shadow DOM is going to make that a little tricky. <br /><br /><br /><span style="color: #ccc">Day #10</span>  <br /><br /><p class=bottom-chain-links><a href="http://japhr.blogspot.com/2015/03/custom-element-api-generation-for.html">&lsaquo;prev</a> | <a href="http://japhr.blogspot.com/2013/11/new-chain-patterns-in-polymer.html">My Chain</a> | <a href="http://japhr.blogspot.com/2015/03/adopting-children-in-polymerdart.html">next&rsaquo;</a> </p><script>var b_links = document.getElementsByClassName('bottom-chain-links'),      t_links = document.getElementsByClassName('top-chain-links');  if (b_links.length == 1 && t_links.length == 1) {   t_links[0].innerHTML = b_links[0].innerHTML; } </script><img src="http://feeds.feedburner.com/~r/JaphrByChrisStrom/~4/Lxpha9qcXlU" height="1" width="1" alt=""/>
