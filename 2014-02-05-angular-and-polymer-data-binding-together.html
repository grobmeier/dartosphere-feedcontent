---
title: 'Angular and Polymer Data Binding, Together!'
layout: post
published: '2014-02-05T08:58:00-08:00'
feed: 'Seth Ladd''s Blog'
link: 'http://feedproxy.google.com/~r/SethLaddsBlog/~3/Qx4r_C_fhic/angular-and-polymer-data-binding.html'
author:
    name: Anonymous
    email: noreply@blogger.com
    url: 'http://www.blogger.com/profile/13906800552603557213'
tags:
    - angular
    - dart
    - dartlang
    - polymer

---

<br /><img height="454" src="https://lh6.googleusercontent.com/pJ6hVT4TF5zkTg5JojxpYf_C-6BMQ7mscM_-b2x3qoRDdNv0JeOxI5xjly_TwYVvJm4nX_JMjVNCbhx08agffmq76GdsCB1oCSO1RjsSlfH-vW8MBNOHuL9n2A" width="640" /><br /><br /><br /><div style="text-align: center;"><i>Angular and Polymer, sitting in a DOM tree,</i></div><div style="text-align: center;"><i>B-i-n-d-i-n-g.</i></div><div style="text-align: center;"><i>First comes components,</i></div><div style="text-align: center;"><i>Then comes elements,</i></div><div style="text-align: center;"><i>Then comes the interop with the node dot bind.</i></div><br /><a href="http://angulardart.org/">Angular</a>, a super heroic MVC framework, and <a href="http://polymer-project.org/">Polymer</a>, polyfills and enhancements for custom elements built on top of Web Components, can live harmoniously in the same app. This post shows you how to connect Angular-controlled components to Polymer-controlled elements via data binding. And we do it all in <a href="https://www.dartlang.org/">Dart</a>.<br /><br /><h2>Angular <i>and</i> Polymer</h2><br />I get asked "Should I use Angular or Polymer?" a lot. My answer is, "Yes". That is, both libraries have distinct strengths, and you can use both in the same app.<br /><br />Polymer excels at creating encapsulated custom elements. You can use those custom elements in any web app or web page, regardless if that app is built with Angular, Ember, etc. Angular excels at application engineering, with dependency injection, end-to-end testability, routing, and services.<br /><br /><br /><img height="381" src="https://lh4.googleusercontent.com/lJJ3-2tzMUItRlkQ98R_3v9XZbpPJipi3ObioEMMMyjAegEEDn5hZ0X4K6UvaYn2REoHYTz4-GcoM_WfS1Pj3J-IchFnDNjVMjn4SAAah2XO1ep3umk1_QrkTQ" width="640" /><br /><br />Here are some features that Angular offers:<br /><ul><li>directives - kind of like mixins or traits for DOM nodes</li><li>dependency injection</li><li>testing support</li><li>routing</li><li>services</li><li>server communication</li></ul><div>Here are some features that Polymer offers:<br /><ul><li>&lt;polymer-element&gt; - convenient way to declare custom elements</li><li>widgets</li><li>polyfills for new web platform features</li><li>encapsulation for the DOM</li><li>built on emerging web standards</li></ul>There are some similar features between the two libraries. Both libraries implement a data binding solution (which we cover below). Angular is beginning to build on top of emerging web standards (like Shadow DOM). I expect that, over time, more and more of Angular will take advantage of the Web Components family of specifications.<br /><h2>Interop</h2>We can interop Angular and Polymer via the DOM, as well as via data binding.<br /><br /><h3>DOM interop</h3><br />We've always been able to use the DOM for basic interop between custom elements and Angular. For example, setting an attribute on a custom element is a type of API interop. Simply creating the custom element and inserting it into the document is another type of interop. Polymer and Angular already interop at the DOM layer.<br /><br />For example, here's an example of an Angular managed page that includes a Polymer element.<br /><br /><div class="separator" style="clear: both; text-align: center;"><img border="0" src="http://4.bp.blogspot.com/-zXQRFYGykJY/UvJJfYL2crI/AAAAAAABYHM/phUKn4pQDNI/s1600/Dart_Editor.png" height="377" width="640" /></div><br /><br />In the above code, Angular manages the binding of the <span style="font-family: Courier New, Courier, monospace;">cool</span> variable in the HTML. When cool changes, everywhere you see <span style="font-family: Courier New, Courier, monospace;">{{cool}}</span> also changes. Yes, even when bound into an attribute of a custom element!<br /><br />The &lt;my-element&gt; is just a custom Polymer element encapsulates an input field and displays a value. Here's the code:<br /><br /><pre class="prettyprint lang-dart"><code><br />&lt;polymer-element name="my-element"&gt;<br />  &lt;template&gt;<br />    &lt;p&gt;<br />      &lt;input type="text" value="{{message}}"&gt; Polymer binding: {{message}}<br />    &lt;/p&gt;<br />  &lt;/template&gt;<br />  &lt;script type="application/dart" src="my_element.dart"&gt;&lt;/script&gt;<br />&lt;/polymer-element&gt;<br /></code></pre><br />The Angular code can set attributes on &lt;my-element&gt;, listen for DOM events from &lt;my-element&gt;, and of course even insert children elements inside of &lt;my-element&gt;. So in a sense, Angular can interop with Polymer elements just like any other DOM element.<br /><br />However, there is an issue. Can you spot it in the animated GIF below?<br /><br /><div class="separator" style="clear: both; text-align: center;"><img border="0" src="http://4.bp.blogspot.com/-OtHB3jRMT6o/UvJf8nmc-SI/AAAAAAABYHw/4xCVAN1ltLM/s1600/before.gif" height="297" width="400" /></div><br />Any changes to <span style="font-family: Courier New, Courier, monospace;">cool</span> initiated from inside the Polymer element <b>are not propagated</b>&nbsp;back out into the outside DOM or Angular. We need real bi-directional data binding: Angular down into Polymer, and Polymer back out to Angular.<br /><br /><h3>Data binding interop</h3><br />Polymer manages data binding through a feature called <a href="http://www.polymer-project.org/platform/node_bind.html">Node.bind()</a>.&nbsp;Node.bind() is a "new method added to all DOM nodes which instructs them to bind the named property to the data provided". Angular does not use Node.bind() out of the box, so Angular is unable to listen for changes that are initiated from Polymer.<br /><br />Until now.<br /><br /><a href="https://plus.google.com/+JustinFagnani">Justin Fagnani</a>, an engineer on the Dart team, released <a href="http://pub.dartlang.org/packages/angular_node_bind">angular_node_bind</a>, a Dart package that bridges the Angular and Polymer worlds. It is an Angular module that can listen for Node.bind() changes and propagate the changes into Angular.<br /><br />Justin explains why this package can help:<br /><br /><ul><li>Node.bind() takes care of setting up the binding, including two-way bindings, eliminating the need for directives for every property for two-way bindings.</li><li>Custom elements that expose properties will be properly bound, again including two-way bindings. You can use the growing collection of custom element libraries in your Angular app.</li></ul><br />To use angular_node_bind, add the following to your app's pubspec.yaml file:<br /><br /><pre class="prettyprint lang-yaml"><code><br />name: angularpolymer<br />description: A demo of Angular and Polymer data binding.<br />dependencies:<br />  angular: any<br />  angular_node_bind: any<br />  browser: any<br />  polymer: any<br />transformers:<br />- polymer:<br />    entry_points: web/angularpolymer.html<br /></code></pre><br />Register the NodeBindModule with Angular:<br /><br /><pre class="prettyprint lang-dart"><code><br />import 'package:polymer/polymer.dart' show initPolymer;<br />import 'package:angular/angular.dart' show ngBootstrap;<br />import 'package:angular_node_bind/angular_node_bind.dart' show NodeBindModule;<br /><br />void main() {<br />  initPolymer().run(() {<br />    ngBootstrap(module: new NodeBindModule());<br />  });<br />}<br /></code></pre><br />Finally, change the syntax used for binding into Polymer elements, from {{...}} to [[...]]:<br /><br /><pre class="prettyprint"><code><br />&lt;my-element message="[[cool]]"&gt;&lt;/my-element&gt;<br /></code></pre><br />Notice the binding expression is now <span style="font-family: Courier New, Courier, monospace;">[[cool]]</span> instead of <span style="font-family: Courier New, Courier, monospace;">{{cool}}</span>. The angular_node_bind module looks for [[ ... ]] and wires up Node.bind().<br /><br />Here is a little movie of how the app works with true bi-directional data binding between Polymer and Angular:<br /><br /><div class="separator" style="clear: both; text-align: center;"><img border="0" src="http://3.bp.blogspot.com/-UXUbXHlaAXA/UvJgI6uztsI/AAAAAAABYH4/2VEPxyDB3LY/s1600/after.gif" height="275" width="400" /></div><br /><br />Notice how changes from Angular are reflected in the Polymer element, and how changes from within the Polymer element are reflected in the Angular code. Awesome!<br /><h2>Summary</h2>You can use Polymer custom elements inside of an Angular app in at least two ways. Polymer elements are just like regular DOM elements, so they have attributes, emit events, and can contain children elements. Use Dart's angular_node_bind package to connect Polymer's data binding to Angular's data binding for true bi-directional data sharing.<br /><br />Lovely, Angular and Polymer holding hands.<br /><h2>Get the source code</h2>You can check out the <a href="https://github.com/sethladd/dart-angular-polymer-data-binding">source code</a>&nbsp;mentioned in this post.<br /><span style="font-family: Arial; font-size: 15px; vertical-align: baseline; white-space: pre-wrap;"></span></div><img src="http://feeds.feedburner.com/~r/SethLaddsBlog/~4/Qx4r_C_fhic" height="1" width="1" alt=""/>
