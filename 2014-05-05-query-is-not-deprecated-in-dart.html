---
title: 'Query is Not Deprecated in Dart'
layout: post
published: '2014-05-05T23:50:00-04:00'
feed: 'japh(r) by Chris Strom'
link: 'http://feedproxy.google.com/~r/JaphrByChrisStrom/~3/guqC6ARVXvs/query-is-not-deprecated-in-dart.html'
author:
    name: 'Chris Strom'
    email: noreply@blogger.com
    url: 'https://plus.google.com/117928918793969810642'
tags:
    - bash
    - chain
    - dart
    - dartlang
    - testing

---

<div class=top-chain-links></div><br />Look, I know that <a href="http://www.dartlang.org/docs/editor/">Dart Editor</a> says that <code>query()</code> is deprecated in <a href="http://dartlang.org">Dart</a>, but it's really not.<br /><br />I mean, sure <a href="https://groups.google.com/a/dartlang.org/d/msg/web-ui/dJnz6DbyPbs/VIWDzih_-XQJ">it's deprecated</a>, but it's deprecated so that a DOM method of the same name that returns nearly the same thing can replace it. And, since the newer version will (most likely) return an active node list, it'll be more what developers tend to expect and use less memory than the current version. So I stick with <code>query()</code> in my various books and will continue to do so until the deprecation is completed and the new an improved <code>query()</code> arrives.<br /><br />That leaves me with a bit of a bother, however. What is the best practice for ignoring <code>query()</code> / <code>queryAll()</code> “deprecation” warnings? In <a href="http://dart4hipsters.com/">Dart for Hipsters</a>, I had been ignoring all hints in my <code>test_runner.sh</code>:<pre class=prettyprint># Static type analysis<br />echo<br />echo "Static type analysis (expecting 4 warnings)..."<br /><br />results=$(<b>dartanalyzer --no-hints</b> test.dart 2>&amp;1)</pre>I think that is probably a case of throwing the baby out with the bath water. So instead, I opt for an approach that we have found works nicely in the <a href="https://github.com/eee-c/ice-code-editor">ICE Code Editor</a> test suite—we grep-ignore hints that are OK which should leave me with no hints. In the book's test quite, this looks something like:<pre class=prettyprint>echo "Static type analysis..."<br /><br />results=$(dartanalyzer test.dart 2>&amp;1)<br />results_ignoring_ok_deprecations=$(<br />  echo "$results" | \<br /><b>    grep -v "'query' is deprecated" | \<br />    grep -v "'queryAll' is deprecated" | \</b><br />    grep -v "hints found.$"<br />)<br />echo "$results_ignoring_ok_deprecations"</pre>The results variable name, <code>results_ignoring_ok_deprecations</code> is a bit, but it was the best that we could come up with—and all agreed that a long, descriptive name was better than the alternative.<br /><br />Since I am intentionally writing some broken code in Dart for Hipsters, I also use this as an opportunity to ignore warnings in specific files from specific lines. The static <code>dartanalyzer</code> code thus becomes:<pre class=prettyprint>echo "Static type analysis..."<br /><br />results=$(dartanalyzer test.dart 2>&amp;1)<br />results_ignoring_ok_deprecations=$(<br />  echo "$results" | \<br />    grep -v "'query' is deprecated" | \<br />    grep -v "'queryAll' is deprecated" | \<br /><br /><b>    # Known / intentional errors:<br />    grep -v "code/primitives/types.dart, line 34" | \<br />    grep -v "code/primitives/types.dart, line 42" | \<br />    grep -v "code/varying_the_behavior/test/calling_methods_from_no_such_method.dart, line 22" | \<br />    grep -v "code/varying_the_behavior/test/calling_methods_from_no_such_method.dart, line 26" | \</b><br /><br />    grep -v "hints found.$"<br />)<br />echo "$results_ignoring_ok_deprecations"<br /><br /><br />count=$(echo "$results_ignoring_ok_deprecations" | wc -l)<br />if [[ "$count" != "1" ]]<br />then<br />  exit 1<br />fi<br /><br />echo<br />echo "Looks good!"<br /></pre>I feel much better about that approach than the previous baby and bath water approach. Now, if you'll excuse me, it seems that I have two dozen or so unused imports in my code...<br /><br /><br /><span style="color: #ccc">Day #55</span>  <br /><br /><p class=bottom-chain-links><a href="http://japhr.blogspot.com/2014/05/thankful-for-large-test-suite-returning.html">&lsaquo;prev</a> | <a href="http://japhr.blogspot.com/2013/11/new-chain-patterns-in-polymer.html">My Chain</a> | <a href="http://japhr.blogspot.com/2014/05/dart-is-much-saner-than-its-pre-alpha.html">next&rsaquo;</a> </p><script>var b_links = document.getElementsByClassName('bottom-chain-links'),      t_links = document.getElementsByClassName('top-chain-links');  if (b_links.length == 1 && t_links.length == 1) {   t_links[0].innerHTML = b_links[0].innerHTML; } </script><img src="http://feeds.feedburner.com/~r/JaphrByChrisStrom/~4/guqC6ARVXvs" height="1" width="1"/>
