---
title: 'Does @ComputedProperty Make Observables?'
layout: post
published: '2014-08-05T23:59:00-04:00'
feed: 'japh(r) by Chris Strom'
link: 'http://feedproxy.google.com/~r/JaphrByChrisStrom/~3/TKzGYsMy0h4/i-remain-somewhat-confused-about.html'
author:
    name: 'Chris Strom'
    email: noreply@blogger.com
    url: 'https://plus.google.com/117928918793969810642'
tags:
    - annotations
    - chain
    - dart
    - dartlang
    - polymer

---

<div class=top-chain-links></div><br />I remain somewhat confused about the purpose of the <code>@ComputedProperty</code> annotation in the latest 0.12 release of <a href="https://www.dartlang.org/polymer-dart/">Polymer.dart</a>. I had planned on further exploring “timing” issues that may have necessitated this annotation, but <a href="https://plus.google.com/+MatthewButler">Matthew Butler</a> was kind enough to point me in a different direction. Specifically, he indicated that the primary utility of <code>@ComputedProperty</code> was that it marked its properties as observable.<br /><br />I, being slightly dense, took this a little too literally. Given a <code>@ComputedProperty</code> of <code>numToppings</code> in child elements of <code>&lt;x-pizza></code>:<pre class=prettyprint>@CustomTag('x-pizza-toppings')<br />class XPizzaToppings extends PolymerElement {<br />  List&lt;String> model = toObservable([]);<br /><br /><b>  @ComputedProperty("model.length")<br />  int get numToppings => readValue(#numToppings);</b><br /><br />  int get numToppings_old => model.length;<br />  // ...<br />}</pre>I first tried listening to changes to <code>numToppings</code> in the parent element's constructor:<pre class=prettyprint>@CustomTag('x-pizza')<br />class XPizza extends PolymerElement {<br />  // ...<br />  XPizza.created(): super.created() {<br /><b>    firstHalf.numToppings.changes.listen((changeRecord) {<br />      print("$changeRecord");<br />    });</b><br />  }<br />  // ...<br />}</pre>But that is not what Matthew meant. At least I don't think so. Mostly because <code>numToppings</code> is not a real observable. It is a simple integer with no changes stream:<pre class=prettyprint>Exception: Class 'int' has no instance getter 'changes'.<br />NoSuchMethodError: method not found: 'changes'<br />Receiver: 0<br />Arguments: []</pre>Instead, perhaps this is something that updates the template:<pre class=prettyprint>&lt;link rel="import" href="../../../packages/polymer/polymer.html"><br />&lt;polymer-element name="x-pizza-toppings"><br />  &lt;template><br />    &lt;p><br />      &lt;select id="ingredients" class="form-control" value="{{current}}"><br />        &lt;option value="">Choose an ingredient...&lt;/option><br />        &lt;option template repeat="{{ingredient in ingredients}}"><br />          {{ingredient}}<br />        &lt;/option><br />      &lt;/select><br />      &lt;button id="add" on-click="{{add}}" type="button" class="btn btn-default"><br />        Add {{name}}<br />      &lt;/button><br /><b>      (Currently: {{ numToppings }}, {{ numToppings_old }})</b><br />    &lt;/p><br />  &lt;/template><br />  &lt;script type="application/dart" src="x_pizza_toppings.dart">&lt;/script><br />&lt;/polymer-element></pre>Except it doesn't. <br /><br />The <code>numToppings</code> property is a <code>@ComputedProperty</code>. The <code>numToppings_old</code> is a plain-old, un-annotated getter property. So if the benefit of <code>@ComputedProperty</code> is that it is observable, I would expect only the first number to change when I add a topping. But, when I add a topping, both are immediately changed in the UI:<br /><br /><a href="http://3.bp.blogspot.com/-sdiaUHYUhb0/U-GpO25UztI/AAAAAAAAdus/hw7Dhza_19M/s1600/01-all_getters_updated.png" imageanchor="1" ><img border="0" src="http://3.bp.blogspot.com/-sdiaUHYUhb0/U-GpO25UztI/AAAAAAAAdus/hw7Dhza_19M/s400/01-all_getters_updated.png" /></a><br /><br />So I remain confused over the utility of <code>@ComputerProperty</code>. Both it and plain-old getter properties seem to behave the same both in the template and in simple <code>created()</code> life cycle checks (the latter from last night). Am I doing something wrong here?<br /><br /><br /><span style="color: #ccc">Day #144</span>  <br /><br /><p class=bottom-chain-links><a href="http://japhr.blogspot.com/2014/08/the-polymerdart-computedproperty.html">&lsaquo;prev</a> | <a href="http://japhr.blogspot.com/2013/11/new-chain-patterns-in-polymer.html">My Chain</a> | <span style="color: #ccc">next&rsaquo;</span> </p><script>var b_links = document.getElementsByClassName('bottom-chain-links'),      t_links = document.getElementsByClassName('top-chain-links');  if (b_links.length == 1 && t_links.length == 1) {   t_links[0].innerHTML = b_links[0].innerHTML; } </script><img src="http://feeds.feedburner.com/~r/JaphrByChrisStrom/~4/TKzGYsMy0h4" height="1" width="1"/>
