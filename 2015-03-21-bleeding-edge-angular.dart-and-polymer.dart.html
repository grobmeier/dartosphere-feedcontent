---
title: 'Bleeding Edge Angular.dart and Polymer.dart'
layout: post
published: '2015-03-21T00:30:00-04:00'
feed: 'japh(r) by Chris Strom'
link: 'http://feedproxy.google.com/~r/JaphrByChrisStrom/~3/kjpWdulzuYc/bleeding-edge-angulardart-and.html'
author:
    name: 'Chris Strom'
    email: noreply@blogger.com
    url: 'https://plus.google.com/117928918793969810642'
tags:
    - angular
    - chain
    - dart
    - 'dart pub'
    - dartlang
    - polymer

---

<div class=top-chain-links></div><br />When last <a href="http://japhr.blogspot.com/2014/09/testing-angular-and-polymerdart.html">I checked</a>, the state of <a href="https://www.dartlang.org/polymer-dart/">Polymer.dart</a> and <a href="https://github.com/angular/angular.dart">Angular.dart</a> was pretty rough. I had to override multiple dependencies just to get the two to install side-by-side. At the time, that seemed to work, but hardly seemed a long-term solution. Let's see if the situation has improved.<br /><br />I continue to work with the latest development release version of <a href="http://dartlang.org">Dart</a> (the newest Polymer.dart requires it):<pre class=prettyprint>$ dart --version<br />Dart VM version: 1.9.0-dev.10.12 (Fri Mar 20 06:26:15 2015) on "linux_x64"</pre>In the angular example code from <a href="http://patternsinpolymer.com/">Patterns in Polymer</a>, I start with optimism in my heart. I comment out the old dependency overrides in my <code>pubspec.yaml</code> package file:<pre class=prettyprint>name: angular_example<br />dependencies:<br />  angular: any<br />  polymer: any<br />  angular_node_bind:<br />    git: https://github.com/eee-c/angular_node_bind.git<br /><b># dependency_overrides:<br />#   args: any<br />#   code_transformers: any<br />#   html5lib: any<br />#   observe: any</b><br />dev_dependencies:<br />  scheduled_test: any<br />transformers:<br />- angular:<br />    html_files:<br />      - web/partials/custom.html<br />- polymer:<br />    entry_points:<br />      - web/index.html<br />      - test/index.html<br /></pre>And then I attempt to upgrade to the latest, compatible versions:<pre class=prettyprint>$ pub upgrade   <br />Resolving dependencies... (38.5s) </pre>And it just stops there. Well, it does not stopâ€”the CPU is pegged and the fan on my laptop bolts into high gear.<br /><br />Some time later, pub gives up the ghost:<pre class=prettyprint>Connection closed before full header was received</pre>So it seems that I must give <a href="http://pub.dartlang.org/">Dart Pub</a> a gentle nudge at minimum. I start by explicitly requiring the latest Polymer:<pre class=prettyprint>name: angular_example<br />dependencies:<br />  angular: any<br />  <b>polymer: ">=0.16.0"</b><br />  angular_node_bind:<br />    git: https://github.com/eee-c/angular_node_bind.git<br /># ...</pre>Since this is in support of a Polymer book, it seems more appropriate to get the latest Polymer library working with a possibly older version of Angular. But even that fails. I still timeout when trying to <code>pub upgrade</code>. It would appear that a gentle nudge is insufficient. Time for a hard shove down the stairs...<br /><br />I check the generated <code>pubspec.lock</code> of a Polymer only project and an Angular-old project. Comparing the two, I find that Polymer is using a newer version of the <code>observe</code> package and a new version of the <code>collection</code> package.<br /><br />In the <code>pubspec.lock</code> for the Polymer-only project, I have:<pre class=prettyprint># ...<br />  collection:<br />    description: collection<br />    source: hosted<br />    version: "1.1.0"<br /># ...<br />  observe:<br />    description: observe<br />    source: hosted<br />    version: "0.13.0+1"<br /># ...</pre>In the <code>pubspec.lock</code> for the Angular-only project, I have:<pre class=prettyprint># ...<br />  collection:<br />    description: collection<br />    source: hosted<br />    version: "0.9.4"<br /># ...<br />  observe:<br />    description: observe<br />    source: hosted<br />    version: "0.12.2+1"<br /># ....</pre>In both cases, I opt for Polymer to win (again because I am more interested in evaluating Polymer). So I update my Polymer-Angular example application to include some dependency overrides:<pre class=prettyprint>name: angular_example<br />dependencies:<br />  angular: any<br />  polymer: ">=0.16.0"<br />  angular_node_bind:<br />    git: https://github.com/eee-c/angular_node_bind.git<br /><b>dependency_overrides:<br />  collection: '>=0.9.1 &lt;1.2.0'<br />  observe: '>=0.12.0 &lt;0.14.0'</b><br /># ...</pre>That is less than ideal, but I console myself with two rationalizations. First, this halves the number of dependency overrides that I previously had to use. Second, I am using a pre-release version of Polymer. So I do not look too closely and claim progress.<br /><br />Especially since a <code>pub upgrade</code> now completes successfully:<pre class=prettyprint>$ pub upgrade<br />Resolving dependencies... (11.7s)<br />  ...<br /><b>  angular 1.1.0</b><br />  angular_node_bind 0.2.0 from git https://github.com/eee-c/angular_node_bind.git at d7b694<br />  ...<br />! collection 1.1.0 (overridden)<br />  ...<br />> di 3.3.4 (was 3.3.3)<br />...<br />! observe 0.13.0+1 (overridden)<br />  ...<br /><b>> polymer 0.16.0+6 (was 0.15.5+4)</b><br />  ...<br />Warning: You are using these overridden dependencies:<br />! collection 1.1.0<br />! observe 0.13.0+1<br />Changed 14 dependencies! <br />...</pre>Best of all, the Angular and Polymer code still double binds the shared attributes. Angular binds the <code>&lt;x-pizza></code> element's <code>value</code> attribute to a local variable of its own, which it also binds in a <code>&lt;textarea></code>:<br /><br /><a href="http://3.bp.blogspot.com/-V42hWKIJbXY/VQzxoHwG3MI/AAAAAAAAntQ/2h59TyU7ih8/s1600/01-worky_angular_polymer.png" imageanchor="1" ><img border="0" src="http://3.bp.blogspot.com/-V42hWKIJbXY/VQzxoHwG3MI/AAAAAAAAntQ/2h59TyU7ih8/s400/01-worky_angular_polymer.png" /></a><br /><br />When I update the Polymer element, adding sausage to the second half of my <code>&lt;x-pizza></code> Polymer element, Angular sees the attribute change and binds the new value into the <code>&lt;textarea></code>:<br /><br /><a href="http://3.bp.blogspot.com/-1EIIKViQkeA/VQzxoYzyagI/AAAAAAAAntY/HsnpJ-8bsmI/s1600/02-update_from_polymer.png" imageanchor="1" ><img border="0" src="http://3.bp.blogspot.com/-1EIIKViQkeA/VQzxoYzyagI/AAAAAAAAntY/HsnpJ-8bsmI/s400/02-update_from_polymer.png" /></a><br /><br />Similarly, when I manually edit the JSON in the <code>&lt;textarea></code>, the <code>&lt;x-pizza></code> Polymer element is updated:<br /><br /><a href="http://2.bp.blogspot.com/-2kt4L_XCkXU/VQzxoKrIKnI/AAAAAAAAntU/KLpdAXXOt_4/s1600/03-update_from_angular.png" imageanchor="1" ><img border="0" src="http://2.bp.blogspot.com/-2kt4L_XCkXU/VQzxoKrIKnI/AAAAAAAAntU/KLpdAXXOt_4/s400/03-update_from_angular.png" /></a><br /><br />Yay!<br /><br />I close by noting that a <a href="https://github.com/angular/angular.dart/commit/485fa7cdc50df15e7997a39b5970c99cd8d7ec32">recent commit to Angular.dart</a> relaxed the <code>observe</code> package sufficiently so that overrides will no longer be needed. At that point, only an override of the <code>collection</code> dependency will stand between Angular.dart and Polymer.dart in the same project. Exciting!<br /><br /><span style="color: #ccc">Day #4</span>  <br /><br /><p class=bottom-chain-links><a href="http://japhr.blogspot.com/2015/03/simple-solutions-to-asynchronous.html">&lsaquo;prev</a> | <a href="http://japhr.blogspot.com/2013/11/new-chain-patterns-in-polymer.html">My Chain</a> | <span style="color: #ccc">next&rsaquo;</span> </p><script>var b_links = document.getElementsByClassName('bottom-chain-links'),      t_links = document.getElementsByClassName('top-chain-links');  if (b_links.length == 1 && t_links.length == 1) {   t_links[0].innerHTML = b_links[0].innerHTML; } </script><img src="//feeds.feedburner.com/~r/JaphrByChrisStrom/~4/kjpWdulzuYc" height="1" width="1" alt=""/>
