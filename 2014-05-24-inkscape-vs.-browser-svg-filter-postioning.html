---
title: 'Inkscape vs. Browser SVG Filter Postioning'
layout: post
published: '2014-05-24T23:59:00-04:00'
feed: 'japh(r) by Chris Strom'
link: 'http://feedproxy.google.com/~r/JaphrByChrisStrom/~3/1R_8CWDifEw/inkscape-vs-browser-svg-filter.html'
author:
    name: 'Chris Strom'
    email: noreply@blogger.com
    url: 'https://plus.google.com/117928918793969810642'
tags:
    - chain
    - dart
    - dartlang
    - inkscape
    - polymer
    - svg

---

<div class=top-chain-links></div><br />I ended last night's <a href="http://www.polymer-project.org/">Polymer</a> / SVG effort with a problem. Not so much a Polymer problem as an SVG problem. I have some fairly simple DOM animation triggered by mouse-overs:<br /><br /><a href="http://1.bp.blogspot.com/-OSRH5lbzD3g/U4FZlYucxtI/AAAAAAAAZuw/GoXXbAvXd6E/s1600/03-no_drop_shadow.png" imageanchor="1" ><img border="0" src="http://1.bp.blogspot.com/-OSRH5lbzD3g/U4FZlYucxtI/AAAAAAAAZuw/GoXXbAvXd6E/s640/03-no_drop_shadow.png" /></a><br /><br />All of this works, except the stinking drop shadow filter, which is getting clipped. This seemed a simple problem at first—I assumed that I only needed to resize the SVG “pepperoni” in my <code>&lt;x-pizza></code> pizza building custom element. But no matter how I resized the SVG—attributes, style, mucking with the SVG itself, or even trying it different browsers—I could not get the shadow to be unclipped. I am honestly tempted to just drop it (yeah, I said it) and move on to other, more Polymer-y things. But darn it, why won't it unclip? (declip?)<br /><br />Happily, Emanuele Sabetta had a suggestion in <a href="http://japhr.blogspot.com/2014/05/dom-animation-of-svg.html#comments">last night's comments</a>. Instead of fiddling with the elements attributes, perhaps I need to change the filter attributes.<br /><br />So I fire up Inkscape again, open my pepperoni SVG file, and start the Filter Editor (Filters → Filter Editor…):<br /><br /><a href="http://1.bp.blogspot.com/-0JHaRviZmo0/U4FiPfllSpI/AAAAAAAAZvA/rSOYnbExAUk/s1600/01-inkscape_filter_editor.png" imageanchor="1" ><img border="0" src="http://1.bp.blogspot.com/-0JHaRviZmo0/U4FiPfllSpI/AAAAAAAAZvA/rSOYnbExAUk/s400/01-inkscape_filter_editor.png" /></a><br /><br />First off, wow. That is a lot of filtering for a simple drop shadow. Looking through it, I can understand why some of it is needed, but two blurs? Anyhow, after recovering from filter astonishment, I see that the filter area (the dashed box) does seem to clip some of the drop shadow. Hopefully this is the problem. I change the width and height to 1.5—it would seem that is 1.5× the path being shadowed, not the entire image. I then adjust the center of the filter accordingly so that it still encompasses the area that I would like to see the effect:<br /><br /><a href="http://1.bp.blogspot.com/-rj3-8tGT1Gs/U4FkByYPuOI/AAAAAAAAZvM/MP49KPIb3Oo/s1600/02-change_inkscape_filter_size_pos.png" imageanchor="1" ><img border="0" src="http://1.bp.blogspot.com/-rj3-8tGT1Gs/U4FkByYPuOI/AAAAAAAAZvM/MP49KPIb3Oo/s400/02-change_inkscape_filter_size_pos.png" /></a><br /><br />Checking the resulting XML in Inkscape's XML Editor, I see that this results in three new attributes to the filter:<br /><br /><a href="http://2.bp.blogspot.com/-zg2eUvdb0oo/U4Fm_AXdX1I/AAAAAAAAZvY/Hu7lxZW1wIQ/s1600/03-inkscape_xml.png" imageanchor="1" ><img border="0" src="http://2.bp.blogspot.com/-zg2eUvdb0oo/U4Fm_AXdX1I/AAAAAAAAZvY/Hu7lxZW1wIQ/s400/03-inkscape_xml.png" /></a><br /><br />Well, heck. I can type those in myself in the SVG being used in <code>&lt;x-pizza></code>:<pre class=prettyprint>&lt;?xml version="1.0" encoding="UTF-8" standalone="no"?><br />&lt;!-- Created with Inkscape (http://www.inkscape.org/) --><br />&lt;svg<br />   xmlns:svg="http://www.w3.org/2000/svg"<br />   xmlns="http://www.w3.org/2000/svg"<br />   version="1.1"<br />   width="32"<br />   height="32"><br />  &lt;defs><br />    &lt;filter<br />       color-interpolation-filters="sRGB"<br /><b>       height="1.5"<br />       width="1.5"<br />       y="-0.4"</b><br />       id="filter3790"><br />      &lt;feFlood<br />      &lt;!-- ... --><br />  &lt;/defs><br />  &lt;!-- ... --><br />&lt;/svg></pre>And, when I reload that in the browser, I find:<br /><br /><a href="http://2.bp.blogspot.com/-K3hvH9Tqq9A/U4FnwQ8RLyI/AAAAAAAAZvg/tT2lFfda75Q/s1600/04-still_clipped.png" imageanchor="1" ><img border="0" src="http://2.bp.blogspot.com/-K3hvH9Tqq9A/U4FnwQ8RLyI/AAAAAAAAZvg/tT2lFfda75Q/s400/04-still_clipped.png" /></a><br /><br />Arrrgh! Are you kidding me?! It's still clipped!<br /><br />Ah, but it is not clipped as much, and not at all in the x-direction. So I change the height to 2.5, reload and...<br /><br /><a href="http://2.bp.blogspot.com/-2QLEncNsyEA/U4FoRfg5wsI/AAAAAAAAZvo/zd1xrO8sWoQ/s1600/05-not_clipped.png" imageanchor="1" ><img border="0" src="http://2.bp.blogspot.com/-2QLEncNsyEA/U4FoRfg5wsI/AAAAAAAAZvo/zd1xrO8sWoQ/s400/05-not_clipped.png" /></a><br /><br />&lt;Sniff>. It's so beautiful!<br /><br />I am unsure why there is a discrepancy between Inkscape's bounding area in the Filter Editor and the area that is actually clipped in the image. I trial-and-error the actual lower limit of the height and y-position of the filter to find:<pre class=prettyprint><code>    &lt;filter<br />       color-interpolation-filters="sRGB"<br />       height="2.0"<br />       width="1.5"<br />       y="-0.2"<br />       id="filter3790"></code></pre>So fiddling with the values in Inkscape's Filter Editor put me on the right track, but only manual intervention got me the full solution:<br /><br /><a href="http://4.bp.blogspot.com/-XirD5H6Xi0c/U4FqcAFbSII/AAAAAAAAZv0/86iJeYJujUQ/s1600/05-effect_in_action.png" imageanchor="1" ><img border="0" src="http://4.bp.blogspot.com/-XirD5H6Xi0c/U4FqcAFbSII/AAAAAAAAZv0/86iJeYJujUQ/s400/05-effect_in_action.png" /></a><br /><br />No matter how I got the solution, I will take it.<br /><br /><br /><span style="color: #ccc">Day #73</span>  <br /><br /><br /><p class=bottom-chain-links><a href="http://japhr.blogspot.com/2014/05/dom-animation-of-svg.html">&lsaquo;prev</a> | <a href="http://japhr.blogspot.com/2013/11/new-chain-patterns-in-polymer.html">My Chain</a> | <a href="http://japhr.blogspot.com/2014/05/one-svg-filter-to-rule-them-all.html">next&rsaquo;</a> </p><script>var b_links = document.getElementsByClassName('bottom-chain-links'),      t_links = document.getElementsByClassName('top-chain-links');  if (b_links.length == 1 && t_links.length == 1) {   t_links[0].innerHTML = b_links[0].innerHTML; } </script><img src="http://feeds.feedburner.com/~r/JaphrByChrisStrom/~4/1R_8CWDifEw" height="1" width="1"/>
