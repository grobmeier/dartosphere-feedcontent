---
title: 'Translating the Web-UI x-click-counter to Polymer.dart'
layout: post
published: '2013-08-13T07:00:00+01:00'
feed: Dartwatch
link: 'http://feedproxy.google.com/~r/Dartwatch/~3/fX9bNK9cE3A/translating-web-ui-x-click-counter-to.html'
author:
    name: 'Chris Buckett'
    email: noreply@blogger.com
    url: 'https://plus.google.com/117571249567635877826'
tags:
    - article

---

This blog post shows how to take the Web UI sample "x-click-component" project created from Dart Editor wizard, and convert it into a Polymer.dart project. &nbsp;Along the way, I'll highlight some of the differences between Web-UI and Polymer (and some of the similarities).<br /><br />Dart's web components project, called Web-UI, is <a href="http://news.dartlang.org/2013/07/introducing-polymer-dart.html">migrating over</a> to the Polymer project's web component framework. <br /><br />One of the key differences between the Dart's Web UI project and Polymer is that Polymer doesn't require a separate build step (or the <span style="font-family: Courier New, Courier, monospace;">/out/</span> folder), at least while you're developing (you'll still want a build step when you deploy, to combine all the external imports).<br /><br /><b>Note</b>: This blog post was written using Dart 0.6.15 r25822 and Polymer 0.5.3. <br /><h2>Creating the project</h2><br />Let's start by creating a new project in the editor.<br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://2.bp.blogspot.com/-3Z2SKF6O7MU/Ugn_76M26EI/AAAAAAAAKOk/757wd9bjkzw/s1600/newproject.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="291" src="http://2.bp.blogspot.com/-3Z2SKF6O7MU/Ugn_76M26EI/AAAAAAAAKOk/757wd9bjkzw/s320/newproject.png" width="320" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Create a new Web Application (using the web_ui library) project</td></tr></tbody></table>This creates you a web project structure containing a set of example files. &nbsp;After a few seconds, pub has installed the various packages and <span style="font-family: Courier New, Courier, monospace;">build.dart</span> has finished running, your folder structure probably looks something like this:<br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://1.bp.blogspot.com/-Bl95vOkuTU4/UgoAijO_k5I/AAAAAAAAKOs/FSRIHE2D_nc/s1600/starting_folder_structure.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="200" src="http://1.bp.blogspot.com/-Bl95vOkuTU4/UgoAijO_k5I/AAAAAAAAKOs/FSRIHE2D_nc/s320/starting_folder_structure.png" width="320" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">The starting web-ui folder structure</td></tr></tbody></table><h2>Removing Web UI and Build.dart</h2><div>The first step (and I'm sure you'll do this with a smile on your face) is to stop <span style="font-family: Courier New, Courier, monospace;">build.dart</span> running. &nbsp;Right click it, and click the handy menu option "Don't run build.dart"</div><div><br /></div><div>Next, open the pubspec.yaml file, and remove all the current dependencies (likely to be <span style="font-family: Courier New, Courier, monospace;">browser</span>, <span style="font-family: Courier New, Courier, monospace;">js</span> and <span style="font-family: Courier New, Courier, monospace;">web_ui</span>). &nbsp;Add a <span style="font-family: Courier New, Courier, monospace;">polymer</span> dependency:</div><div><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-hXM7DB7t_sQ/UgoFIeSl59I/AAAAAAAAKO8/MUDSiOhF7vM/s1600/web_ui+to+polymer.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="89" src="http://3.bp.blogspot.com/-hXM7DB7t_sQ/UgoFIeSl59I/AAAAAAAAKO8/MUDSiOhF7vM/s320/web_ui+to+polymer.png" width="320" /></a></div><h2>Changing the custom element to Polymer</h2><div>In your project there will be two files that represent the existing Web UI <span style="font-family: Courier New, Courier, monospace;">x-click-counter</span> custom element. &nbsp;These are <span style="font-family: Courier New, Courier, monospace;">xclickcounter.html</span>, which provides the layout, and <span style="font-family: Courier New, Courier, monospace;">xclickcounter.dart</span>, which provides the script. &nbsp;</div><div><br />The existing <span style="font-family: Courier New, Courier, monospace;">x-click-counter</span> defines itself as a custom element, has a button that lets you click it to increment a data bound value. &nbsp;It looks like the screenshot below:<br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://1.bp.blogspot.com/-oUOjBSM9Hyc/UgoHhTfy_EI/AAAAAAAAKPM/lUFQELcpnOo/s1600/clickme.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" src="http://1.bp.blogspot.com/-oUOjBSM9Hyc/UgoHhTfy_EI/AAAAAAAAKPM/lUFQELcpnOo/s1600/clickme.png" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Example screenshot of the x-click-counter component</td></tr></tbody></table>We'll go through a couple of iterations to modify this to Polymer. &nbsp;First, we'll just get the custom element to show up in the page, and then we'll come back and look at the interactivity and data binding.<br /><br /></div><div>Before modification, <span style="font-family: Courier New, Courier, monospace;">xclickcounter.html</span> looks like this:</div><div><h4>xclickcounter.html before modification:</h4><div style="background: #ffffff; border-width: .1em .1em .1em .8em; border: solid gray; overflow: auto; padding: .2em .6em; width: auto;"><table><tbody><tr><td><pre style="line-height: 125%; margin: 0;"> 1<br /> 2<br /> 3<br /> 4<br /> 5<br /> 6<br /> 7<br /> 8<br /> 9<br />10<br />11<br />12<br />13<br />14<br />15</pre></td><td><pre style="line-height: 125%; margin: 0;"><span style="color: #557799;">&lt;!DOCTYPE html&gt;</span><br /><br /><span style="color: #007700;">&lt;html&gt;</span><br />  <span style="color: #007700;">&lt;body&gt;</span><br />    <span style="color: #007700;">&lt;element</span> <span style="color: #0000cc;">name=</span><span style="background-color: #fff0f0;">"x-click-counter"</span> <span style="color: #0000cc;">constructor=</span><span style="background-color: #fff0f0;">"CounterComponent"</span> <span style="color: #0000cc;">extends=</span><span style="background-color: #fff0f0;">"div"</span><span style="color: #007700;">&gt;</span><br />      <span style="color: #007700;">&lt;template&gt;</span><br />        <span style="color: #007700;">&lt;div&gt;</span><br />          <span style="color: #007700;">&lt;button</span> <span style="color: #0000cc;">on-click=</span><span style="background-color: #fff0f0;">"increment()"</span><span style="color: #007700;">&gt;</span>Click me<span style="color: #007700;">&lt;/button&gt;&lt;br</span> <span style="color: #007700;">/&gt;</span><br />          <span style="color: #007700;">&lt;span&gt;</span>(click count: {{count}})<span style="color: #007700;">&lt;/span&gt;</span><br />        <span style="color: #007700;">&lt;/div&gt;</span><br />      <span style="color: #007700;">&lt;/template&gt;</span><br />      <span style="color: #007700;">&lt;script </span><span style="color: #0000cc;">type=</span><span style="background-color: #fff0f0;">"application/dart"</span> <span style="color: #0000cc;">src=</span><span style="background-color: #fff0f0;">"xclickcounter.dart"</span><span style="color: #007700;">&gt;&lt;/script&gt;</span><br />    <span style="color: #007700;">&lt;/element&gt;</span><br />  <span style="color: #007700;">&lt;/body&gt;</span><br /><span style="color: #007700;">&lt;/html&gt;</span><br /></pre></td></tr></tbody></table></div><!-- end --></div><div><br /></div><div>There are three key parts that you need to be aware of in the original Web UI element:<br /><br /><ul><li>Line 5: The <span style="font-family: Courier New, Courier, monospace;">&lt;element&gt;</span> tag</li><li>Line 8: Calling an <span style="font-family: Courier New, Courier, monospace;">increment()</span> function</li><li>Line 9: Databinding a <span style="font-family: Courier New, Courier, monospace;">{{count}}</span> value</li></ul></div><div>Start by modifying this to be a polymer element. &nbsp;Change the &lt;element&gt; tag on line 5 to be a &lt;polymer-element&gt; and update the closing &lt;/element&gt; tag on line 13. A polymer element is a like a supercharged custom element, with functionality provided by the Polymer framework. &nbsp;It automatically uses things like the Shadow DOM and allows for simple component registration. <br />Notice also that the name is changed from <span style="font-family: Courier New, Courier, monospace;">x-click-counter</span> to <span style="font-family: Courier New, Courier, monospace;">my-clickcounter</span>, (for the sake of simplicity, I'm not going to rename the filenames). &nbsp;I've also removed the <span style="font-family: Courier New, Courier, monospace;">{{count}}</span> binding for now. We'll add it back again, soon<br /><!-- HTML generated using hilite.me --><br /><h4>xclickcounter.html after modification:</h4><!-- HTML generated using hilite.me --><br /><div style="background: #ffffff; border-width: .1em .1em .1em .8em; border: solid gray; overflow: auto; padding: .2em .6em; width: auto;"><table><tbody><tr><td><pre style="line-height: 125%; margin: 0;"> 1<br /> 2<br /> 3<br /> 4<br /> 5<br /> 6<br /> 7<br /> 8<br /> 9<br />10<br />11<br />12<br />13<br />14<br />15</pre></td><td><pre style="line-height: 125%; margin: 0;"><span style="color: #557799;">&lt;!DOCTYPE html&gt;</span><br /><br /><span style="color: #007700;">&lt;html&gt;</span><br />  <span style="color: #007700;">&lt;body&gt;</span><br />    <span style="color: #007700;">&lt;polymer-element</span> <span style="color: #0000cc;">name=</span><span style="background-color: #fff0f0;">"my-clickcounter"</span><span style="color: #007700;">&gt;</span><br />      <span style="color: #007700;">&lt;template&gt;</span><br />        <span style="color: #007700;">&lt;div&gt;</span><br />          <span style="color: #007700;">&lt;button</span> <span style="color: #0000cc;">on-click=</span><span style="background-color: #fff0f0;">"increment()"</span><span style="color: #007700;">&gt;</span>Click me<span style="color: #007700;">&lt;/button&gt;&lt;br</span> <span style="color: #007700;">/&gt;</span><br />          <span style="color: #007700;">&lt;span&gt;</span>(click count: )<span style="color: #007700;">&lt;/span&gt;</span><br />        <span style="color: #007700;">&lt;/div&gt;</span><br />      <span style="color: #007700;">&lt;/template&gt;</span><br />      <span style="color: #007700;">&lt;script</span> <span style="color: #0000cc;">type=</span><span style="background-color: #fff0f0;">"application/dart"</span> <span style="color: #0000cc;">src=</span><span style="background-color: #fff0f0;">"xclickcounter.dart"</span><span style="color: #007700;">&gt;&lt;/script&gt;</span><br />    <span style="color: #007700;">&lt;/polymer-element&gt;</span><br />  <span style="color: #007700;">&lt;/body&gt;</span><br /><span style="color: #007700;">&lt;/html&gt;</span><br /></pre></td></tr></tbody></table></div><!-- end --> <br /><blockquote class="tr_bq"><b>Important</b>: &nbsp;Web Component custom elements names need to contain a hyphen. The intention is that the first part before the hyphen is a vendor prefix (to differentiate between different clickcounter components, for example). &nbsp;See this discussion on the <a href="https://groups.google.com/d/msg/polymer-dev/90Dq_2bk8CU/UuSk13rE8PgJ" target="_blank">polymer mailing lists</a>.</blockquote>Let's change the associated script in the xclickcounter.dart file. &nbsp;This represents our element in code. &nbsp;Before modification it looks like this:<br /><br /><h4>xclickcounter.dart before modification:</h4><div style="background: #ffffff; border-width: .1em .1em .1em .8em; border: solid gray; overflow: auto; padding: .2em .6em; width: auto;"><table><tbody><tr><td><pre style="line-height: 125%; margin: 0;"> 1<br /> 2<br /> 3<br /> 4<br /> 5<br /> 6<br /> 7<br /> 8<br /> 9<br />10</pre></td><td><pre style="line-height: 125%; margin: 0;"><span style="color: #008800; font-weight: bold;">import</span> <span style="background-color: #fff0f0;">'package:web_ui/web_ui.dart'</span>;<br /><br /><span style="color: #008800; font-weight: bold;">class</span> <span style="color: #bb0066; font-weight: bold;">CounterComponent</span> <span style="color: #008800; font-weight: bold;">extends</span> WebComponent {<br />  <span style="background-color: #ffaaaa; color: red;">@</span>observable<br />  <span style="color: #333399; font-weight: bold;">int</span> count <span style="color: #333333;">=</span> <span style="color: #6600ee; font-weight: bold;">0</span>;<br /><br />  <span style="color: #333399; font-weight: bold;">void</span> increment() {<br />    count<span style="color: #333333;">++</span>;<br />  }<br />}<br /></pre></td></tr></tbody></table></div><!--end-->First, let's change line 1 to import the polymer libary: <br /><br /><!-- HTML generated using hilite.me --><br /><div style="background: #ffffff; border-width: .1em .1em .1em .8em; border: solid gray; overflow: auto; padding: .2em .6em; width: auto;"><pre style="line-height: 125%; margin: 0;"><span style="color: #008800; font-weight: bold;">import</span> <span style="background-color: #fff0f0;">'package:polymer/polymer.dart'</span>;<br /></pre></div><!-- end --> <br /><br />Then let's change line 3 -&nbsp;<span style="font-family: Courier New, Courier, monospace;">CounterComponent</span> class to extend <span style="font-family: Courier New, Courier, monospace;">PolymerElement</span> instead of <span style="font-family: Courier New, Courier, monospace;">WebComponent</span><br /><br /><!-- HTML generated using hilite.me --><br /><div style="background: #ffffff; border-width: .1em .1em .1em .8em; border: solid gray; overflow: auto; padding: .2em .6em; width: auto;"><pre style="line-height: 125%; margin: 0;"><span style="color: #008800; font-weight: bold;">class</span> <span style="color: #bb0066; font-weight: bold;">CounterComponent</span> <span style="color: #008800; font-weight: bold;">extends</span> PolymerElement {<br /></pre></div><!-- end --> <br />Finally, we need to provide a method of registering our my-clickcounter element with the browser. The JavaScript version of Polymer elements do this using a JavaScript call, but in Dart, we can use a <span style="font-family: Courier New, Courier, monospace;">@CustomTag('my-clickcounter')</span>&nbsp;class annotation. &nbsp;The full changed xclickcounter.dart file is shown below (note, we'll return to the commented out functionality in a few steps:<br /><br /><h4>xclickcounter.dart after modification:</h4><div style="background: #ffffff; border-width: .1em .1em .1em .8em; border: solid gray; overflow: auto; padding: .2em .6em; width: auto;"><table><tbody><tr><td><pre style="line-height: 125%; margin: 0;"> 1<br /> 2<br /> 3<br /> 4<br /> 5<br /> 6<br /> 7<br /> 8<br /> 9<br />10<br />11</pre></td><td><pre style="line-height: 125%; margin: 0;"><span style="color: #008800; font-weight: bold;">import</span> <span style="background-color: #fff0f0;">'package:polymer/polymer.dart'</span>;<br /><br /><span style="background-color: #ffaaaa; color: red;">@</span>CustomTag(<span style="background-color: #fff0f0;">"my-clickcounter"</span>)<br /><span style="color: #008800; font-weight: bold;">class</span> <span style="color: #bb0066; font-weight: bold;">CounterComponent</span> <span style="color: #008800; font-weight: bold;">extends</span> PolymerElement {<br /><span style="color: #888888;">//  @observable</span><br /><span style="color: #888888;">//  int count = 0;</span><br /><span style="color: #888888;">//</span><br /><span style="color: #888888;">//  void increment() {</span><br /><span style="color: #888888;">//    count++;</span><br /><span style="color: #888888;">//  }</span><br />}<br /></pre></td></tr></tbody></table></div><!-- end --> <br />Now that the layout and script for the custom element is changed to use Polymer, let's see how you actually use them in your application's main page.<br /><h2>Using the Custom Element in your page</h2></div><div>Currently, our main page (called polymerclicker1.html), and our main script (called polymerclicker1.dart) use Web UI. &nbsp;The Web UI version of the files look like this</div><div><br /></div><h4>polymerclicker1.dart before modification:</h4><div><!-- HTML generated using hilite.me --><br /><div style="background: #ffffff; border-width: .1em .1em .1em .8em; border: solid gray; overflow: auto; padding: .2em .6em; width: auto;"><table><tbody><tr><td><pre style="line-height: 125%; margin: 0;"> 1<br /> 2<br /> 3<br /> 4<br /> 5<br /> 6<br /> 7<br /> 8<br /> 9<br />10<br />11<br />12<br />13<br />14</pre></td><td><pre style="line-height: 125%; margin: 0;"><span style="color: #008800; font-weight: bold;">import</span> <span style="background-color: #fff0f0;">'dart:html'</span>;<br /><span style="color: #008800; font-weight: bold;">import</span> <span style="background-color: #fff0f0;">'package:web_ui/web_ui.dart'</span>;<br /><br /><span style="color: #888888;">// initial value for click-counter</span><br /><span style="color: #333399; font-weight: bold;">int</span> startingCount <span style="color: #333333;">=</span> <span style="color: #6600ee; font-weight: bold;">5</span>;<br /><br /><span style="color: #888888;">/**</span><br /><span style="color: #888888;"> * Learn about the Web UI package by visiting</span><br /><span style="color: #888888;"> * http://www.dartlang.org/articles/dart-web-components/.</span><br /><span style="color: #888888;"> */</span><br /><span style="color: #333399; font-weight: bold;">void</span> main() {<br />  <span style="color: #888888;">// Enable this to use Shadow DOM in the browser.</span><br />  <span style="color: #888888;">//useShadowDom = true;</span><br />}<br /></pre></td></tr></tbody></table></div><!-- end --></div><h4></h4><h4>polymerclicker1.html before modification</h4><div><!-- HTML generated using hilite.me --><br /><div style="background: #ffffff; border-width: .1em .1em .1em .8em; border: solid gray; overflow: auto; padding: .2em .6em; width: auto;"><table><tbody><tr><td><pre style="line-height: 125%; margin: 0;"> 1<br /> 2<br /> 3<br /> 4<br /> 5<br /> 6<br /> 7<br /> 8<br /> 9<br />10<br />11<br />12<br />13<br />14<br />15<br />16<br />17<br />18<br />19<br />20<br />21<br />22<br />23<br />24</pre></td><td><pre style="line-height: 125%; margin: 0;"><span style="color: #557799;">&lt;!DOCTYPE html&gt;</span><br /><br /><span style="color: #007700;">&lt;html&gt;</span><br />  <span style="color: #007700;">&lt;head&gt;</span><br />    <span style="color: #007700;">&lt;meta</span> <span style="color: #0000cc;">charset=</span><span style="background-color: #fff0f0;">"utf-8"</span><span style="color: #007700;">&gt;</span><br />    <span style="color: #007700;">&lt;title&gt;</span>Sample app<span style="color: #007700;">&lt;/title&gt;</span><br />    <span style="color: #007700;">&lt;link</span> <span style="color: #0000cc;">rel=</span><span style="background-color: #fff0f0;">"stylesheet"</span> <span style="color: #0000cc;">href=</span><span style="background-color: #fff0f0;">"polymerclicker1.css"</span><span style="color: #007700;">&gt;</span><br />    <br />    <span style="color: #888888;">&lt;!-- import the click-counter --&gt;</span><br />    <span style="color: #007700;">&lt;link</span> <span style="color: #0000cc;">rel=</span><span style="background-color: #fff0f0;">"import"</span> <span style="color: #0000cc;">href=</span><span style="background-color: #fff0f0;">"xclickcounter.html"</span><span style="color: #007700;">&gt;</span><br />  <span style="color: #007700;">&lt;/head&gt;</span><br />  <span style="color: #007700;">&lt;body&gt;</span><br />    <span style="color: #007700;">&lt;h1&gt;</span>Polymerclicker1<span style="color: #007700;">&lt;/h1&gt;</span><br />    <br />    <span style="color: #007700;">&lt;p&gt;</span>Hello world from Dart!<span style="color: #007700;">&lt;/p&gt;</span><br />    <br />    <span style="color: #007700;">&lt;div</span> <span style="color: #0000cc;">id=</span><span style="background-color: #fff0f0;">"sample_container_id"</span><span style="color: #007700;">&gt;</span><br />      <span style="color: #007700;">&lt;div</span> <span style="color: #0000cc;">is=</span><span style="background-color: #fff0f0;">"x-click-counter"</span> <span style="color: #0000cc;">id=</span><span style="background-color: #fff0f0;">"click_counter"</span> <span style="color: #0000cc;">count=</span><span style="background-color: #fff0f0;">"{{startingCount}}"</span><span style="color: #007700;">&gt;&lt;/div&gt;</span><br />    <span style="color: #007700;">&lt;/div&gt;</span><br /><br />    <span style="color: #007700;">&lt;script</span> <span style="color: #0000cc;">type=</span><span style="background-color: #fff0f0;">"application/dart"</span> <span style="color: #0000cc;">src=</span><span style="background-color: #fff0f0;">"polymerclicker1.dart"</span><span style="color: #007700;">&gt;&lt;/script&gt;</span><br />    <span style="color: #007700;">&lt;script</span> <span style="color: #0000cc;">src=</span><span style="background-color: #fff0f0;">"packages/browser/dart.js"</span><span style="color: #007700;">&gt;&lt;/script&gt;</span><br />  <span style="color: #007700;">&lt;/body&gt;</span><br /><span style="color: #007700;">&lt;/html&gt;</span><br /></pre></td></tr></tbody></table></div><!-- end --></div><div><br /></div><div>It only takes a couple of simple modifications to change these to use Polymer. &nbsp; To start with, you can remove everything from the .dart file apart from an empty <span style="font-family: Courier New, Courier, monospace;">main()</span> function. &nbsp;We'll add something back into this once we start data binding a little later.<br /><br /></div><h4>polymerclicker1.dart after modification:</h4><div><div style="background: #ffffff; border-width: .1em .1em .1em .8em; border: solid gray; overflow: auto; padding: .2em .6em; width: auto;"><table><tbody><tr><td><pre style="line-height: 125%; margin: 0;">1<br />2<br />3</pre></td><td><pre style="line-height: 125%; margin: 0;"><span style="color: #333399; font-weight: bold;">void</span> main() {<br />  <span style="color: #888888;">// no content here yet.</span><br />}<br /></pre></td></tr></tbody></table></div><!-- end --></div><div><br />Next, lets modify the HTML file. &nbsp;This introduces a new piece of functionality, in the form of <b>boot.js</b>, found in the Polymer package. &nbsp;The comments from that file explain fairly succinctly (we'll see it in action in a moment).<br /><br /><blockquote class="tr_bq">This script dynamically prepares a set of files to  run polymer.dart. It usesthe html_import polyfill  to search for all imported files, then it inlines all  &lt;polymer-element&gt; definitions on the top-level  page (needed by registerPolymerElement), and it removes  script tags that appear inside those tags. It  finally rewrites the main entrypoint to call an  initialization function on each of the  declared &lt;polymer-elements&gt;. </blockquote></div><div>To get this working, replace the existing JavaScript script import on Line 22: &nbsp;<span style="font-family: Courier New, Courier, monospace;">packages/browser/dart.js</span> with polymer's&nbsp;<span style="font-family: Courier New, Courier, monospace;">packages/polymer/boot.js</span><span style="font-family: inherit;">.</span><br /><span style="font-family: inherit;"><br /></span><span style="font-family: inherit;">Let's also modify the #click_counter div to be an actual my-clickcounter element, by changing line 18 so that...</span><br /><span style="font-family: inherit;"><br /></span></div><!-- HTML generated using hilite.me --><br /><div style="background: #ffffff; border-width: .1em .1em .1em .8em; border: solid gray; overflow: auto; padding: .2em .6em; width: auto;"><pre style="line-height: 125%; margin: 0;"><span style="color: #007700;">&lt;div</span> <span style="color: #0000cc;">is=</span><span style="background-color: #fff0f0;">"x-click-counter"</span> <span style="color: #0000cc;">id=</span><span style="background-color: #fff0f0;">"click_counter"</span> <span style="color: #0000cc;">count=</span><span style="background-color: #fff0f0;">"{{startingCount}}"</span><span style="color: #007700;">&gt;&lt;/div&gt;</span><br />  <span style="color: #888888;">&lt;!-- becomes... --&gt;</span><br /><span style="color: #007700;">&lt;my-clickcounter</span> <span style="color: #0000cc;">id=</span><span style="background-color: #fff0f0;">"click_counter"</span> <span style="color: #0000cc;">count=</span><span style="background-color: #fff0f0;">"{{startingCount}}"</span><span style="color: #007700;">&gt;</span></pre><pre style="line-height: 125%; margin: 0;"><span style="color: #007700;">                                                           &lt;/my-clickcounter&gt;</span><br /></pre></div><!-- end --> <br />Now, the polymerclicker1.html should look like this, with lines 18 and 22 changed.:<br /><br /><h4>polymerclicker1.html after modification</h4><!-- HTML generated using hilite.me --><br /><div style="background: #ffffff; border-width: .1em .1em .1em .8em; border: solid gray; overflow: auto; padding: .2em .6em; width: auto;"><table><tbody><tr><td><pre style="line-height: 125%; margin: 0;"> 1<br /> 2<br /> 3<br /> 4<br /> 5<br /> 6<br /> 7<br /> 8<br /> 9<br />10<br />11<br />12<br />13<br />14<br />15<br />16<br />17<br /><b>18</b><br />19<br />20<br />21<br /><b>22</b><br />23<br />24</pre></td><td><pre style="line-height: 125%; margin: 0;"><span style="color: #557799;">&lt;!DOCTYPE html&gt;</span><br /><br /><span style="color: #007700;">&lt;html&gt;</span><br />  <span style="color: #007700;">&lt;head&gt;</span><br />    <span style="color: #007700;">&lt;meta</span> <span style="color: #0000cc;">charset=</span><span style="background-color: #fff0f0;">"utf-8"</span><span style="color: #007700;">&gt;</span><br />    <span style="color: #007700;">&lt;title&gt;</span>Sample app<span style="color: #007700;">&lt;/title&gt;</span><br />    <span style="color: #007700;">&lt;link</span> <span style="color: #0000cc;">rel=</span><span style="background-color: #fff0f0;">"stylesheet"</span> <span style="color: #0000cc;">href=</span><span style="background-color: #fff0f0;">"polymerclicker1.css"</span><span style="color: #007700;">&gt;</span><br />    <br />    <span style="color: #888888;">&lt;!-- import the click-counter --&gt;</span><br />    <span style="color: #007700;">&lt;link</span> <span style="color: #0000cc;">rel=</span><span style="background-color: #fff0f0;">"import"</span> <span style="color: #0000cc;">href=</span><span style="background-color: #fff0f0;">"xclickcounter.html"</span><span style="color: #007700;">&gt;</span><br />  <span style="color: #007700;">&lt;/head&gt;</span><br />  <span style="color: #007700;">&lt;body&gt;</span><br />    <span style="color: #007700;">&lt;h1&gt;</span>Polymerclicker1<span style="color: #007700;">&lt;/h1&gt;</span><br />    <br />    <span style="color: #007700;">&lt;p&gt;</span>Hello world from Dart!<span style="color: #007700;">&lt;/p&gt;</span><br />    <br />    <span style="color: #007700;">&lt;div</span> <span style="color: #0000cc;">id=</span><span style="background-color: #fff0f0;">"sample_container_id"</span><span style="color: #007700;">&gt;</span><br />      <span style="color: #007700;">&lt;my-clickcounter</span> <span style="color: #0000cc;">id=</span><span style="background-color: #fff0f0;">"click_counter"</span> <span style="color: #0000cc;">count=</span><span style="background-color: #fff0f0;">"{{startingCount}}"</span><span style="color: #007700;">&gt;&lt;/my-clickcounter&gt;</span>      <br />    <span style="color: #007700;">&lt;/div&gt;</span><br /><br />    <span style="color: #007700;">&lt;script</span> <span style="color: #0000cc;">type=</span><span style="background-color: #fff0f0;">"application/dart"</span> <span style="color: #0000cc;">src=</span><span style="background-color: #fff0f0;">"polymerclicker1.dart"</span><span style="color: #007700;">&gt;&lt;/script&gt;</span><br />    <span style="color: #007700;">&lt;script</span> <span style="color: #0000cc;">src=</span><span style="background-color: #fff0f0;">"packages/polymer/boot.js"</span><span style="color: #007700;">&gt;&lt;/script&gt;</span><br />  <span style="color: #007700;">&lt;/body&gt;</span><br /><span style="color: #007700;">&lt;/html&gt;</span><br /></pre></td></tr></tbody></table></div><!-- end --><br /><div><h2>Running in Dartium</h2>You can go ahead and run this in now Dartium. &nbsp;It doesn't have any interactivity (it will throw an error when you click the button), but it's worked without the build step<br /><blockquote class="tr_bq"><b>Tip:</b> you might need to delete the <span style="font-family: Courier New, Courier, monospace;">web/out/</span> subfolder&nbsp;created by the old build.dart&nbsp;if you're being automatically redirected.</blockquote><br />Let's take a look under the covers and see what's happened. &nbsp;The old build.dart used to examine the static HTML page and combine all the HTML Imports into a runnable set of files before the application was run. &nbsp;The polymer <span style="font-family: Courier New, Courier, monospace;">boot.js</span> does this, but at runtime by replacing the our applications <span style="font-family: Courier New, Courier, monospace;">main()</span> function (currently empty in polymerclicker1.dart) with a higher level main function that imports all the web componetns, initializes polymer and finally calls our own <span style="font-family: Courier New, Courier, monospace;">main()</span> function (identified as <span style="font-family: Courier New, Courier, monospace;">userMain.main</span>). &nbsp;If you inspect elements in Dartium, you'll see the new script looks something like this:<br /><br /><!-- HTML generated using hilite.me --><br /><div style="background: #ffffff; border-width: .1em .1em .1em .8em; border: solid gray; overflow: auto; padding: .2em .6em; width: auto;"><table><tbody><tr><td><pre style="line-height: 125%; margin: 0;">1<br />2<br />3<br />4<br />5<br />6<br />7<br />8<br />9</pre></td><td><pre style="line-height: 125%; margin: 0;"><span style="color: #008800; font-weight: bold;">import</span> <span style="background-color: #fff0f0;">"http://127.0.0.1:3030/web/xclickcounter.dart"</span> <span style="color: #008800; font-weight: bold;">as</span> i0;<br /><span style="color: #008800; font-weight: bold;">import</span> <span style="background-color: #fff0f0;">"package:polymer/polymer.dart"</span> <span style="color: #008800; font-weight: bold;">as</span> polymer;<br /><span style="color: #008800; font-weight: bold;">import</span> <span style="background-color: #fff0f0;">"http://127.0.0.1:3030/web/polymerclicker1.dart"</span> <span style="color: #008800; font-weight: bold;">as</span> userMain;<br /><br />main() {<br />  polymer.initPolymer([<br />      <span style="background-color: #fff0f0;">"http://127.0.0.1:3030/web/xclickcounter.dart"</span><br />      ], userMain.main);<br />}<br /></pre></td></tr></tbody></table></div><!-- end --><br />This new <span style="font-family: Courier New, Courier, monospace;">main()</span> function passes in a list of all the polymer elements discovered through HTML Imports, and a callback to the original <span style="font-family: Courier New, Courier, monospace;">userMain.main()</span> function.<br /><br />From comments like this in the boot.js,<br /><blockquote class="tr_bq"><blockquote class="tr_bq"><span style="font-family: Courier New, Courier, monospace;">//TODO: rephrase when we split build.dart in two: analysis vs deploy pieces.</span></blockquote><blockquote class="tr_bq"><span style="font-family: Courier New, Courier, monospace;">console.warn('boot.js only works in Dartium. Run the build.dart &nbsp;tool to compile a depolyable JavaScript version')</span></blockquote></blockquote>it seems that the intention is that this is only used for development.<br /><br /><h2>Adding data binding to the custom element</h2></div><div>At the moment we're using the custom element, but it has no interactivity or data binding. &nbsp;Remember that <span style="font-family: Courier New, Courier, monospace;">{{count}}</span> we removed? &nbsp;Let's put it back. &nbsp;Polymer.dart uses an <span style="font-family: Courier New, Courier, monospace;">ObservableMixin</span> to add the ability to observe changes to a variable through the&nbsp;<span style="font-family: Courier New, Courier, monospace;">@observable</span> annotation. &nbsp;This annotation allows two way data binding between the <span style="font-family: Courier New, Courier, monospace;">count</span> field in the class instance, and any <span style="font-family: Courier New, Courier, monospace;">{{ count }}</span>&nbsp;declarations in the template. <br />Uncomment the previously commented out section (lines 6 through 11), and add the <span style="font-family: Courier New, Courier, monospace;">ObservableMixin</span> to the class definition (line 5) in <span style="font-family: Courier New, Courier, monospace;">xclickcounter.dart</span>.<br /><br /></div><h4>xclickcounter.dart after modification with functionality and observable mixin</h4><div><!-- HTML generated using hilite.me --><br /><div style="background: #ffffff; border-width: .1em .1em .1em .8em; border: solid gray; overflow: auto; padding: .2em .6em; width: auto;"><table><tbody><tr><td><pre style="line-height: 125%; margin: 0;"> 1<br /> 2<br /> 3<br /> 4<br /> <b>5</b><br /> <b>6</b><br /> <b>7</b><br /> <b>8</b><br /> <b>9</b><br /><b>10</b><br /><b>11</b><br />12</pre></td><td><pre style="line-height: 125%; margin: 0;"><span style="color: #008800; font-weight: bold;">import</span> <span style="background-color: #fff0f0;">'package:polymer/polymer.dart'</span>;<br /><br /><span style="background-color: #ffaaaa; color: red;">@</span>CustomTag(<span style="background-color: #fff0f0;">"my-clickcounter"</span>)<br /><span style="color: #008800; font-weight: bold;">class</span> <span style="color: #bb0066; font-weight: bold;">CounterComponent</span> <span style="color: #008800; font-weight: bold;">extends</span> PolymerElement <br />                             with ObservableMixin {<br />  <span style="background-color: #ffaaaa; color: red;">@</span>observable<br />  <span style="color: #333399; font-weight: bold;">int</span> count <span style="color: #333333;">=</span> <span style="color: #6600ee; font-weight: bold;">0</span>;<br /><br />  <span style="color: #333399; font-weight: bold;">void</span> increment() {<br />    count<span style="color: #333333;">++</span>;<br />  }<br />}<br /></pre></td></tr></tbody></table></div><!-- end --></div><div><br /></div><div>Let's also put the <span style="font-family: Courier New, Courier, monospace;">{{count}}</span> binding value back into the <span style="font-family: Courier New, Courier, monospace;">xclickcounter.html</span><span style="font-family: inherit;">&nbsp;at line 9. &nbsp;The </span><span style="font-family: Courier New, Courier, monospace;">on-click="increment()"</span><span style="font-family: inherit;"> function call on line 8 changes as well - removing the parentheses (this is inline with the JavaScript version of Polymer).</span><br /><span style="font-family: inherit;"><br /></span></div><h4><span style="font-family: inherit;">xclickcounter.html after modification with functionality and data binding.</span></h4><div><span style="font-family: inherit;"><!-- HTML generated using hilite.me --></span><br /><div style="background: #ffffff; border-width: .1em .1em .1em .8em; border: solid gray; overflow: auto; padding: .2em .6em; width: auto;"><table><tbody><tr><td><pre style="line-height: 125%; margin: 0;"> 1<br /> 2<br /> 3<br /> 4<br /> 5<br /> 6<br /> 7<br /> <b>8</b><br /> <b>9</b><br />10<br />11<br />12<br />13<br />14<br />15</pre></td><td><pre style="line-height: 125%; margin: 0;"><span style="color: #557799;">&lt;!DOCTYPE html&gt;</span><br /><br /><span style="color: #007700;">&lt;html&gt;</span><br />  <span style="color: #007700;">&lt;body&gt;</span><br />    <span style="color: #007700;">&lt;polymer-element</span> <span style="color: #0000cc;">name=</span><span style="background-color: #fff0f0;">"my-clickcounter"</span><span style="color: #007700;">&gt;</span><br />      <span style="color: #007700;">&lt;template&gt;</span><br />        <span style="color: #007700;">&lt;div&gt;</span><br />          <span style="color: #007700;">&lt;button</span> <span style="color: #0000cc;">on-click=</span><span style="background-color: #fff0f0;">"increment"</span><span style="color: #007700;">&gt;</span>Click me<span style="color: #007700;">&lt;/button&gt;&lt;br</span> <span style="color: #007700;">/&gt;</span><br />          <span style="color: #007700;">&lt;span&gt;</span>(click count: {{ count }})<span style="color: #007700;">&lt;/span&gt;</span><br />        <span style="color: #007700;">&lt;/div&gt;</span><br />      <span style="color: #007700;">&lt;/template&gt;</span><br />      <span style="color: #007700;">&lt;script</span> <span style="color: #0000cc;">type=</span><span style="background-color: #fff0f0;">"application/dart"</span> <span style="color: #0000cc;">src=</span><span style="background-color: #fff0f0;">"xclickcounter.dart"</span><span style="color: #007700;">&gt;&lt;/script&gt;</span><br />    <span style="color: #007700;">&lt;/polymer-element&gt;</span><br />  <span style="color: #007700;">&lt;/body&gt;</span><br /><span style="color: #007700;">&lt;/html&gt;</span><br /></pre></td></tr></tbody></table></div><span style="font-family: inherit;"><!-- end --></span></div><div><span style="font-family: inherit;"><br /></span><span style="font-family: inherit;">Finally, run the same </span><span style="font-family: Courier New, Courier, monospace;">polymerclicker1.html</span><span style="font-family: inherit;"> application, and you'll see that you can now click the "<b>Click Me</b>" button to increment the count.</span><br /><span style="font-family: inherit;"><br /></span><br /><h2><span style="font-family: inherit;">Binding initial data values</span></h2></div><div><span style="font-family: inherit;">The last step we need to take is to databind an initial value. &nbsp;The original Web UI click counter initialized the counter with a value of </span><span style="font-family: Courier New, Courier, monospace;">startingCount=5</span><span style="font-family: inherit;">. I've not found a way to do this exactly yet (and it may be that this part of Polymer hasn't been ported over yet), but you can achieve it through template binding.</span></div><div><span style="font-family: inherit;"><br /></span></div><div>The first step is to publish a public attribute on the <span style="font-family: Courier New, Courier, monospace;">my-clickcounter</span> polymer element. &nbsp;You do this using the <span style="font-family: Courier New, Courier, monospace;">attributes=""</span> attribute on the <span style="font-family: Courier New, Courier, monospace;">&lt;polymer-element&gt;</span> definition, making public any properties in the underlying Dart class. &nbsp;Change Line 5 of xclickcounter.html as shown below:<br /><br /></div><h4>xclickcounter.html after modification with published count attribute</h4><div><!-- HTML generated using hilite.me --><br /><div style="background: #ffffff; border-width: .1em .1em .1em .8em; border: solid gray; overflow: auto; padding: .2em .6em; width: auto;"><table><tbody><tr><td><pre style="line-height: 125%; margin: 0;"> 1<br /> 2<br /> 3<br /> 4<br /> 5<br /> 6<br /> 7<br /> 8<br /> 9<br />10<br />11<br />12<br />13<br />14<br />15</pre></td><td><pre style="line-height: 125%; margin: 0;"><span style="color: #557799;">&lt;!DOCTYPE html&gt;</span><br /><br /><span style="color: #007700;">&lt;html&gt;</span><br />  <span style="color: #007700;">&lt;body&gt;</span><br />    <span style="color: #007700;">&lt;polymer-element</span> <span style="color: #0000cc;">name=</span><span style="background-color: #fff0f0;">"my-clickcounter"</span> <span style="color: #0000cc;">attributes=</span><span style="background-color: #fff0f0;">"count"</span><span style="color: #007700;">&gt;</span><br />      <span style="color: #007700;">&lt;template&gt;</span><br />        <span style="color: #007700;">&lt;div&gt;</span><br />          <span style="color: #007700;">&lt;button</span> <span style="color: #0000cc;">on-click=</span><span style="background-color: #fff0f0;">"increment"</span><span style="color: #007700;">&gt;</span>Click me<span style="color: #007700;">&lt;/button&gt;&lt;br</span> <span style="color: #007700;">/&gt;</span><br />          <span style="color: #007700;">&lt;span&gt;</span>(click count: {{ count }})<span style="color: #007700;">&lt;/span&gt;</span><br />        <span style="color: #007700;">&lt;/div&gt;</span><br />      <span style="color: #007700;">&lt;/template&gt;</span><br />      <span style="color: #007700;">&lt;script</span> <span style="color: #0000cc;">type=</span><span style="background-color: #fff0f0;">"application/dart"</span> <span style="color: #0000cc;">src=</span><span style="background-color: #fff0f0;">"xclickcounter.dart"</span><span style="color: #007700;">&gt;&lt;/script&gt;</span><br />    <span style="color: #007700;">&lt;/polymer-element&gt;</span><br />  <span style="color: #007700;">&lt;/body&gt;</span><br /><span style="color: #007700;">&lt;/html&gt;</span><br /></pre></td></tr></tbody></table></div><!-- end --></div><div><br />Now that the <span style="font-family: Courier New, Courier, monospace;">count</span> property is published, let's bind a value to it in our main <span style="font-family: Courier New, Courier, monospace;">polymerclicker1</span> page. &nbsp;To do this, you need to wrap the my-clickcounter in a template binding and bind that template to a model object, accessible through the elements model property in Dart code. <br /><br />The template wrapping looks like this, in the <b>polymerclicker1.html</b> file:<br /><!-- HTML generated using hilite.me --><br /><div style="background: #ffffff; border-width: .1em .1em .1em .8em; border: solid gray; overflow: auto; padding: .2em .6em; width: auto;"><pre style="line-height: 125%; margin: 0;"><span style="color: #007700;">&lt;template</span> <span style="color: #0000cc;">id=</span><span style="background-color: #fff0f0;">"counter_template"</span> <span style="background-color: #ffaaaa; color: red;">bind</span><span style="color: #007700;">&gt;</span><br />  <span style="color: #007700;">&lt;my-clickcounter</span> <span style="color: #0000cc;">id=</span><span style="background-color: #fff0f0;">"click_counter"</span> <span style="color: #0000cc;">count=</span><span style="background-color: #fff0f0;">"{{}}"</span><span style="color: #007700;">&gt;&lt;/my-clickcounter&gt;</span><br /><span style="color: #007700;">&lt;/template&gt;</span><br /></pre></div><br />Template binding uses the <span style="font-family: Courier New, Courier, monospace;">{{}}</span> notation to bind to the model's value (rather than a property of the model).<br />We also need to modify the previously empty polymerclicker1.dart file to set the template model's value to 5.<br /><br /><h4>polymerclicker1.dart after modification, setting a template model value</h4><div><!-- HTML generated using hilite.me --><br /><div style="background: #ffffff; border-width: .1em .1em .1em .8em; border: solid gray; overflow: auto; padding: .2em .6em; width: auto;"><table><tbody><tr><td><pre style="line-height: 125%; margin: 0;">1<br />2<br />3<br />4<br />5</pre></td><td><pre style="line-height: 125%; margin: 0;"><span style="color: #008800; font-weight: bold;">import</span> <span style="background-color: #fff0f0;">'dart:html'</span>;<br /><br /><span style="color: #333399; font-weight: bold;">void</span> main() {<br />  query(<span style="background-color: #fff0f0;">"#counter_template"</span>).model <span style="color: #333333;">=</span> <span style="color: #6600ee; font-weight: bold;">5</span>;<br />}<br /></pre></td></tr></tbody></table></div><!-- end --></div><br />Now, when you run this with the changes, the counter starts with a value of 5, and increments in response to button clicks.<br /><br /><h2>Summary</h2>In this example, you saw how to import custom Polymer elements without requiring a build step by using the new <b>boot.js</b> file imported from the polymer package. &nbsp;This dynamically imports the various elements at runtime, rather than requiring a static build.<br />You also saw some simple data binding within an element itself using the&nbsp;@observable annotation (unchanged from Web UI). <br />Finally, you saw how one way to bind data into a custom element by wrapping it in a template.<br /><br />As ever, comments are welcome, especially if it's to correct something in this post.<br /><h2>References</h2>Most of the documentation on Polymer currently exists on the <a href="http://www.polymer-project.org/">www.Polymer-Project.org</a> homepage, or in as comments in the various source code files in Dart's <a href="https://github.com/dart-lang/web-ui/tree/polymer" target="_blank">Web_UI's polymer branch</a>. &nbsp;For a more fully featured Polymer example, take a look at the <a href="https://github.com/dart-lang/web-ui/tree/polymer/example/todomvc/web" target="_blank">TodoMVC project in the polymer branch</a> (<b>hint</b>, start with index.html).<br /><br />The <a href="https://groups.google.com/forum/?fromgroups=#!forum/polymer-dev" target="_blank">Polymer-dev</a> group and the <a href="https://groups.google.com/a/dartlang.org/forum/#!forum/web-ui" target="_blank">Dart Web-UI</a> group also provide a discussion forum and other information.<br /><br /><h2>Get the Gist:</h2><div>You can find the final versions of the files here:</div><div><a href="https://gist.github.com/chrisbu/6220424">https://gist.github.com/chrisbu/6220424</a></div><br /><br /></div><div class="feedflare">
<a href="http://feeds.feedburner.com/~ff/Dartwatch?a=fX9bNK9cE3A:9ZaGb13bCvc:yIl2AUoC8zA"><img src="http://feeds.feedburner.com/~ff/Dartwatch?d=yIl2AUoC8zA" border="0"></img></a> <a href="http://feeds.feedburner.com/~ff/Dartwatch?a=fX9bNK9cE3A:9ZaGb13bCvc:V_sGLiPBpWU"><img src="http://feeds.feedburner.com/~ff/Dartwatch?i=fX9bNK9cE3A:9ZaGb13bCvc:V_sGLiPBpWU" border="0"></img></a> <a href="http://feeds.feedburner.com/~ff/Dartwatch?a=fX9bNK9cE3A:9ZaGb13bCvc:qj6IDK7rITs"><img src="http://feeds.feedburner.com/~ff/Dartwatch?d=qj6IDK7rITs" border="0"></img></a> <a href="http://feeds.feedburner.com/~ff/Dartwatch?a=fX9bNK9cE3A:9ZaGb13bCvc:63t7Ie-LG7Y"><img src="http://feeds.feedburner.com/~ff/Dartwatch?d=63t7Ie-LG7Y" border="0"></img></a> <a href="http://feeds.feedburner.com/~ff/Dartwatch?a=fX9bNK9cE3A:9ZaGb13bCvc:F7zBnMyn0Lo"><img src="http://feeds.feedburner.com/~ff/Dartwatch?i=fX9bNK9cE3A:9ZaGb13bCvc:F7zBnMyn0Lo" border="0"></img></a>
</div><img src="//feeds.feedburner.com/~r/Dartwatch/~4/fX9bNK9cE3A" height="1" width="1" alt=""/>
