---
title: 'Binding Variables Between Angular and Polymer (latest Dart packages)'
layout: post
published: '2014-09-27T18:46:00-04:00'
feed: 'japh(r) by Chris Strom'
link: 'http://feedproxy.google.com/~r/JaphrByChrisStrom/~3/r1lNBvSYc2w/binding-variables-between-angular-and.html'
author:
    name: 'Chris Strom'
    email: noreply@blogger.com
    url: 'https://plus.google.com/117928918793969810642'
tags:
    - angular
    - chain
    - dart
    - dartlang
    - polymer

---

<div class=top-chain-links></div><br />Last night I was able to get <a href="https://www.dartlang.org/polymer-dart/">Polymer.dart</a> and <a href="https://github.com/angular/angular.dart">Angular.dart</a> working together again. But I don't have them working <i>together</i> yet.<br /><br />I have my <code>&lt;x-pizza></code> Polymer element working within an Angular partial:<br /><br /><a href="http://1.bp.blogspot.com/-1X9UjCqpO4M/VCcbftWCgWI/AAAAAAAAfkk/97Vm3qUn8BI/s1600/01-angular_polymer_dart_working_again.png" imageanchor="1" ><img border="0" src="http://1.bp.blogspot.com/-1X9UjCqpO4M/VCcbftWCgWI/AAAAAAAAfkk/97Vm3qUn8BI/s400/01-angular_polymer_dart_working_again.png" /></a><br /><br />But I do not have the two communicating. When I originally wrote the Angular &amp; Polymer chapter in <a href="http://patternsinpolymer.com/">Patterns in Polymer</a>, I was able to reflect changes from the Polymer element back into the Angular application through the use of <a href="https://pub.dartlang.org/packages/angular_node_bind">angular_node_bind</a>. That was a long time ago, let's see if it still works.<br /><br />Before diving into it, I need to get Angular setup properly. I had remove the variable binding element last night from my partial:<pre class=prettyprint>&lt;h3>Oooh! Let's make beautiful pizza together&lt;/h3><br /><b>&lt;pre>{{ pizzaState }}&lt;/pre></b><br />&lt;p><br />  &lt;x-pizza pizzastate="[[ pizzaState ]]">&lt;/x-pizza><br />&lt;/p></pre>With that <code>&lt;pre></code> element bound to the <code>pizzaState</code> property, I get errors like:<pre class=prettyprint>No getter for 'pizzaState'.<br /><br />STACKTRACE:<br />#0      StaticClosureMap.lookupGetter (package:angular/core/parser/static_closure_map.dart:15:25)<br />#1      DynamicParserBackend.newAccessScope (package:angular/core/parser/dynamic_parser.dart:112:38)<br />#2      DynamicParserImpl.parseAccessOrCallScope (package:angular/core/parser/dynamic_parser_impl.dart:257:67)<br />#3      DynamicParserImpl.parsePrimary (package:angular/core/parser/dynamic_parser_impl.dart:239:36)<br />#4      DynamicParserImpl.parseAccessOrCallMember (package:angular/core/parser/dynamic_parser_impl.dart:193:30)<br />...</pre>This turns out to be caused by omitting the partial from the list of Angular files in my application's <code>pubspec.yaml</code>:<pre class=prettyprint>name: angular_example<br />dependencies:<br />  angular: any<br />  polymer: any<br />  angular_node_bind: any<br />dependency_overrides:<br />  args: '>=0.10.0 &lt;0.12.0'<br />  code_transformers: '>=0.1.4+2 &lt;0.3.0'<br />  html5lib: '>=0.10.0 &lt;0.13.0'<br />dev_dependencies:<br />  unittest: any<br />transformers:<br /><b>- angular:<br />    html_files:<br />      - web/partials/custom.html</b><br />- polymer:<br />    entry_points:<br />    - web/index.html<br />    - test/index.html</pre>With this “custom” pizza partial listed, my error are fixed. But the bound attribute is still not reflected back into the Angular application.<br /><br />To make that work, I need no changes to my <code>&lt;x-pizza></code> backing class definition:<pre class=prettyprint>@CustomTag('x-pizza')<br />class XPizza extends PolymerElement {<br />  // ...<br />  @published String pizzaState;<br />  // ...<br />}</pre>I find that interesting because it does not appear to need the <code>@PublishedProperty(reflect: true)</code> annotation that I <a href="http://japhr.blogspot.com/2014/09/tdd-fix-for-broken-i18n-in-polymerdart.html">would have expected</a>. The only change I that I need is using the angular_node_bind directive in my app:<pre class=prettyprint>// ...<br />import 'package:angular_node_bind/angular_node_bind.dart';<br />// ...<br />main() {<br />  initPolymer().run((){<br /><br />    var app = new PizzaStoreApp()<br /><b>      ..bind(NodeBindDirective)</b><br />      ..bind(NgRoutingUsePushState, toValue: new NgRoutingUsePushState.value(false))<br />      ..bind(RouteInitializerFn, toValue: storeRouteInitializer);<br /><br />    applicationFactory()<br />      .addModule(app)<br />      .run();<br />  });<br />}</pre>Happily, that directive still works just fine. I continue to bind the Angular <code>pizzaState</code> variable to the Polymer element's <code>pizzastate</code> attribute in the template:<pre class=prettyprint>&lt;pre>{{ pizzaState }}&lt;/pre><br />&lt;p><br />  &lt;x-pizza pizzastate="[[ pizzaState ]]">&lt;/x-pizza><br />&lt;/p></pre>With the double-square brackets serving as angular_node_bind's way of watching properties. And it works:<br /><br /><a href="http://4.bp.blogspot.com/-N6wXh4WBRmU/VCc7TtmDclI/AAAAAAAAfkw/WMhGdt7Xmhw/s1600/02-angular_nad_polymer_binding_working_again.png" imageanchor="1" ><img border="0" src="http://4.bp.blogspot.com/-N6wXh4WBRmU/VCc7TtmDclI/AAAAAAAAfkw/WMhGdt7Xmhw/s400/02-angular_nad_polymer_binding_working_again.png" /></a><br /><br />When the Polymer updates its <code>pizzastate</code>, Angular sees the change and updates its <code>pizzaState</code> variable, which is reflected in the <code>&lt;pre></code> element from the Angular template. Nice!<br /><br />The WARNING on the page is Polymer's way of telling me in development mode that it was unable to interpret the <code>&lt;ng-view></code> element from Angular. I can certainly live with that since Polymer was not suppose to interpret it anyway. I think I am nearly satisfied with the solution to the point that I can again include it in the book.<br /><br /><br /><span style="color: #ccc">Day #196</span>  <br /><br /><p class=bottom-chain-links><a href="http://japhr.blogspot.com/2014/09/an-angular-app-using-polymer-element.html">&lsaquo;prev</a> | <a href="http://japhr.blogspot.com/2013/11/new-chain-patterns-in-polymer.html">My Chain</a> | <a href="http://japhr.blogspot.com/2014/09/cant-bind-polymerdart-with-angulardarts.html">next&rsaquo;</a> </p><script>var b_links = document.getElementsByClassName('bottom-chain-links'),      t_links = document.getElementsByClassName('top-chain-links');  if (b_links.length == 1 && t_links.length == 1) {   t_links[0].innerHTML = b_links[0].innerHTML; } </script><img src="http://feeds.feedburner.com/~r/JaphrByChrisStrom/~4/r1lNBvSYc2w" height="1" width="1"/>
