---
title: 'Polymer Elements in Dart'
layout: post
published: '2014-06-02T23:59:00-04:00'
feed: 'japh(r) by Chris Strom'
link: 'http://feedproxy.google.com/~r/JaphrByChrisStrom/~3/PSUXM2ztkMA/polymer-elements-in-dart.html'
author:
    name: 'Chris Strom'
    email: noreply@blogger.com
    url: 'https://plus.google.com/117928918793969810642'
tags:
    - chain
    - dart
    - dartlang
    - polymer
    - polymer-elements

---

<div class=top-chain-links></div><br />So it seems that all of the <a href="http://dartlang.org">Dart</a> flavors of <a href="https://github.com/bwu-dart/polymer_elements">polymer elements</a> and <a href="https://github.com/bwu-dart/core_elements">core elements</a> are deprecated. But in favor of what? <br /><br />My guess is that JavaScript <a href="http://www.polymer-project.org/components/core-docs/index.html">core elements</a>, like <code>&lt;core-ajax></code> are the intended replacement, so I give them a whirl tonight. My <code>&lt;x-pizza></code> custom pizza building element currently uses <code>&lt;polymer-ajax></code> to load the SVG images that comprise the pizza:<br /><br /><a href="http://4.bp.blogspot.com/-cfN4mRZLDI4/U41IAzVal5I/AAAAAAAAaDk/le2OWze65J4/s1600/01-more_toppings_attribtues.png" imageanchor="1" ><img border="0" src="http://4.bp.blogspot.com/-cfN4mRZLDI4/U41IAzVal5I/AAAAAAAAaDk/le2OWze65J4/s320/01-more_toppings_attribtues.png" /></a><br /><br />So I start by Bower installing core-ajax. To get that installation in the correct location (lib/elements), I edit <code>.bowerrc</code>:<pre class=prettyprint>{<br />  "directory": "lib/elements/bower_components"<br />}<br /></pre>Then, I create typical <code>bower.json</code> configuration file:<pre class=prettyprint>{<br />  "name": "svg_example",<br />  "version": "0.0.0",<br />  "homepage": "https://github.com/eee-c/polymer-patterns",<br />  "authors": [<br />    "Chris Strom <github@eeecomputes.com>"<br />  ],<br />  "description": "SVG Example (and more)",<br />  "license": "MIT",<br />  "private": true,<br />  "ignore": [<br />    "**/.*",<br />    "node_modules",<br />    "bower_components",<br />    "test",<br />    "tests"<br />  ],<br />  "dependencies": {<br />    "core-ajax": "Polymer/core-ajax#~0.3.1"<br />  }<br />}<br /></pre>This is already way more work than I want. With the Dart versions of the polymer elements, I could simply add them as dependencies in my elements <code>pubspec.yaml</code>. Now I have to maintain <code>pubspec.yaml</code>, <code>bower.json</code>, and <code>.bowerrc</code>. Hopefully that will not be the case in the final product. Anyhow, I run bower install and get a bunch of dependencies that I do not really want, but I do get the core-ajax package:<pre class=prettyprint>➜  dart git:(master) ✗ bower install --save Polymer/core-ajax<br />...<br /><b>core-ajax#0.3.1 lib/elements/bower_components/core-ajax</b><br />└── polymer#0.3.1<br /><br />polymer#0.3.1 lib/elements/bower_components/polymer<br />├── core-component-page#0.3.1<br />└── platform#0.3.1<br /><br />platform#0.3.1 lib/elements/bower_components/platform<br /><br />core-component-page#0.3.1 lib/elements/bower_components/core-component-page<br />├── platform#0.3.1<br />└── polymer#0.3.1<br /></pre>With that, I am ready to swap out the old Dart <code>&lt;polymer-ajax></code> with the JavaScript <code>&lt;core-ajax></code> in my Polymer element's <code>x-pizza.html</code> definition:<pre class=prettyprint>&lt;!-- &lt;link rel="import" --><br />&lt;!--       href="../../../packages/polymer_elements/polymer_ajax/polymer_ajax.html"> --><br /><b>&lt;link rel="import"<br />      href="bower_components/core-ajax/core-ajax.html"></b><br />&lt;polymer-element name="x-pizza"><br />  &lt;template><br /><b>    &lt;core-ajax<br />      auto<br />       id="pizza.svg"<br />       url="/packages/svg_example/images/pizza.svg"<br />       on-core-response="{{responseReceived}}">&lt;/core-ajax></b><br />    &lt;!-- ... --><br />  &lt;/template><br />  &lt;script type="application/dart" src="x_pizza.dart">&lt;/script><br />&lt;/polymer-element><br /></pre>That produces a lovely multiple-load error when I try it out in Dartium:<pre class=prettyprint>Uncaught Possible attempt to load Polymer twice</pre>So I <i>hand edit</i> the Bower installed <code>core-xhr.html</code> file to use the same <code>polymer.html</code> as is used by my Dart element:<pre class=prettyprint>&lt;!-- &lt;link rel="import" href="../polymer/polymer.html"> --><br /><b>&lt;link rel="import" href="/packages/polymer/polymer.html"></b><br />&lt;polymer-element name="core-xhr" hidden><br />  &lt;script><br />    Polymer('core-xhr', {<br />       // ...<br />    });<br />  &lt;/script><br />&lt;/polymer-element><br /></pre>That actually gets the old-fashioned XHR request to fire. The <code>&lt;core-ajax></code> element even generates events that are invoked in my Dart code:<pre class=prettyprint>@CustomTag('x-pizza')<br />class XPizza extends PolymerElement {<br />  // ...<br /><b>  responseReceived(e, detail, node){<br />    svgContent[node.id] = detail['response'];<br />    if (svgContent.length == shadowRoot.queryAll('core-ajax').length) {<br />      svgLoaded.complete();<br />    }<br />    if (node.id == 'pizza.svg') _updateGraphic();<br />  }</b><br />  // ...<br />}</pre>BUT… there are no details supplied—either in the <code>detail</code> parameter or the <code>detail</code> property of the <code>CustomEvent</code>. This stumps me. My initial attempts to coerce the event into a <code>ProgressEvent</code> are ineffectual as are attempts to query the <code>response</code> attribute on the <code>&lt;core-ajax></code> element.<br /><br />None of this feels terribly robust just yet. Unless I am missing something, there does not seem to be a clear upgrade path for these core elements in Dart. So it seems surprising that they would be deprecated. I will continue investigation tomorrow—perhaps there really is an easy way to do this, it would not be the first time that I missed something mind-blowingly obvious. But my initial thoughts are that <a href="http://patternsinpolymer.com">Patterns in Polymer</a> will likely continue to use the deprecated <code>polymer_elements</code> and <code>core_elements</code> packages for the foreseeable future.<br /><br /><br /><span style="color: #ccc">Day #82</span>  <br /><br /><p class=bottom-chain-links><a href="http://japhr.blogspot.com/2014/06/kicking-tires-on-polymerdart-010.html">&lsaquo;prev</a> | <a href="http://japhr.blogspot.com/2013/11/new-chain-patterns-in-polymer.html">My Chain</a> | <span style="color: #ccc">next&rsaquo;</span> </p><script>var b_links = document.getElementsByClassName('bottom-chain-links'),      t_links = document.getElementsByClassName('top-chain-links');  if (b_links.length == 1 && t_links.length == 1) {   t_links[0].innerHTML = b_links[0].innerHTML; } </script><img src="http://feeds.feedburner.com/~r/JaphrByChrisStrom/~4/PSUXM2ztkMA" height="1" width="1"/>
