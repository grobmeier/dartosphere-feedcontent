---
title: 'Dart Is Much Saner Than It''s Pre-Alpha Days'
layout: post
published: '2014-05-06T23:58:00-04:00'
feed: 'japh(r) by Chris Strom'
link: 'http://feedproxy.google.com/~r/JaphrByChrisStrom/~3/XsLu_KLUQAg/dart-is-much-saner-than-its-pre-alpha.html'
author:
    name: 'Chris Strom'
    email: noreply@blogger.com
    url: 'https://plus.google.com/117928918793969810642'
tags:
    - chain
    - dart
    - dartlang

---

<div class=top-chain-links></div><br />Working through bugs and test failures to produce the next edition of <a href="http://dart4hipsters.com/">Dart for Hipsters</a>, I have come across more than a few that are pretty trivial. And then there are those that are not...<br /><br />Actually, I hope tonight's fall into the former category (they never do though). First up, I wonder if this bit of <a href="http://dartlang.org">Dart</a> is still necessary:<pre class=prettyprint><code>  template(list) {<br /><b>    // This is silly, but [].forEach is broke<br />    if (list.length == 0) return '';</b><br /><br />    var html = '';<br />    list.forEach((comic) {<br />      html = html + _singleComicBookTemplate(comic);<br />    });<br />    return html;<br />  }</code></pre>For a guy that blogs just about every random thought that he has regarding code, I cannot for the life of me find when I decided that <code>forEach()</code> was broken like that. I definitely remember the pain of it, though. It also lives on in the <a href="https://github.com/eee-c/dart-comics/blob/6ff94cbff3a45d1e0ed5d8248a9d42250a8f13a6/lib/Views.Comics.dart#L25-L34">Dart Comics</a> sample app that (loosely) accompanies the book.  Anyhow, it turns out that whatever bug this was has since been solved as iterating over an empty list works just fine now:<pre class=prettyprint><code>  template(list) {<br />    // // This is silly, but [].forEach is broke<br />    // if (list.length == 0) return '';<br /><br /><b>    var list = [];<br /><br />    list.forEach((comic) {<br />      html = html + _singleComicBookTemplate(comic);<br />    });</b><br />    return html;<br />  }</code></pre>Of course, this is probably most concisely done as:<pre class=prettyprint><code>  template(list)=><br />    list.map(_singleComicBookTemplate).join('');</code></pre>But that is early code in the book, so I will likely stick with the more approachable, less “magical” version in that context.<br /><br />Completely unrelated—aside from manifesting as another <code>dartanalyzer</code> hint—is the question of what to do with the dozen or so warnings about unused imports:<pre class=prettyprint>...<br />[hint] Unused import (/home/chris/repos/csdart/Book/code/compiling_javascript/web/scripts/HipsterModel.dart, line 4, col 8)<br />[hint] Unused import (/home/chris/repos/csdart/Book/code/compiling_javascript/web/scripts/HipsterView.dart, line 4, col 8)<br />[hint] Unused import (/home/chris/repos/csdart/Book/code/compiling_javascript/web/scripts/Views.Comics.dart, line 4, col 8)<br />[hint] Unused import (/home/chris/repos/csdart/Book/code/events/collection_event_target.dart, line 3, col 8)<br />[hint] Unused import (/home/chris/repos/csdart/Book/code/events/collection_events.dart, line 3, col 8)<br />...</pre>This is one of those non-real world, but very much real book example problems that I just need to deal with as best I can. There is no good reason for live dart code to import convert and html libraries but not use them. In books and blogs, it often helps to give an overview of code without using anything:<pre class=prettyprint>library skeleton_example;<br /><br />import 'dart:html';<br />import 'dart:convert';<br />main() {<br />  // Do stuff here<br />}<br /></pre>One option is to write a method that uses <i>something</i> from each of those libraries:<pre class=prettyprint>library skeleton_example;<br /><br />import 'dart:html';<br />import 'dart:convert';<br />main() {<br />  // Do stuff here<br />}<br /><br /><b>_satisfyDartAnalyzer() {<br />  query('#foo');<br />  JSON.encode({'foo': 'bar'});<br />}</b></pre>Although that does work, it feels wrong. The code is available for download and doing something like that—even with added comments seems like it will cause confusion for people and only satisfy my obsessive need for test and static type analysis to pass. <br /><br />So, in the end, I opt to add each unused import that I am intentionally keeping to the list of files that are grep-ignored by my Bash <code>test_runner.sh</code>:<pre class=prettyprint>results=$(dartanalyzer test.dart 2>&1)<br />results_ignoring_ok_deprecations=$(<br />  echo "$results" | \<br />    grep -v "'query' is deprecated" | \<br />    grep -v "'queryAll' is deprecated" | \<br /><br />    # Known / intentional errors:<br />    # ...<br /><br /><b>    # Known / intentional unused imports:<br />    grep -v "your_first_dart_app/web/scripts/skel.dart, line 4" | \<br />    grep -v "your_first_dart_app/web/scripts/skel.dart, line 5" | \</b><br /><br />    grep -v "hints found.$"<br />)<br />echo "$results_ignoring_ok_deprecations"<br /># ...</pre>Now I only need to work through the list of a dozen unused imports to decide which are legitimate and which should lose some import statements...<br /><br /><br /><span style="color: #ccc">Day #56</span>  <br /><br /><br /><p class=bottom-chain-links><a href="http://japhr.blogspot.com/2014/05/query-is-not-deprecated-in-dart.html">&lsaquo;prev</a> | <a href="http://japhr.blogspot.com/2013/11/new-chain-patterns-in-polymer.html">My Chain</a> | <a href="http://japhr.blogspot.com/2014/05/dart-annotations-are-no-longer.html">next&rsaquo;</a> </p><script>var b_links = document.getElementsByClassName('bottom-chain-links'),      t_links = document.getElementsByClassName('top-chain-links');  if (b_links.length == 1 && t_links.length == 1) {   t_links[0].innerHTML = b_links[0].innerHTML; } </script><img src="http://feeds.feedburner.com/~r/JaphrByChrisStrom/~4/XsLu_KLUQAg" height="1" width="1"/>
