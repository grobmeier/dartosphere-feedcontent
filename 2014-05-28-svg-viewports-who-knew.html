---
title: 'SVG Viewports: Who Knew?'
layout: post
published: '2014-05-28T23:53:00-04:00'
feed: 'japh(r) by Chris Strom'
link: 'http://feedproxy.google.com/~r/JaphrByChrisStrom/~3/5xGDFvLX9yY/svg-viewports-who-knew.html'
author:
    name: 'Chris Strom'
    email: noreply@blogger.com
    url: 'https://plus.google.com/117928918793969810642'
tags:
    - chain
    - dart
    - dartlang
    - polymer
    - svg

---

<div class=top-chain-links></div><br />Today could be a very important day for me. It could be the last time that I ever blog about SVG and clipping. It's either that or today is the day that I start a new chain supporting a book entitled “SVG Clipping and You.” I'm really hoping for the former.<br /><br />Two days ago I blogged what I hoped at the time would be my last ever <a href="http://japhr.blogspot.com/2014/05/clipping-in-svg.html">SVG clipping post</a>. In it, I essentially gave up trying to get clipping working and instead implemented a workaround in which I used the view port that SVG gave me instead of hoping for more. And then Emanuele Sabetta added a <a href="http://japhr.blogspot.com/2014/05/clipping-in-svg.html#comments">comment to that post</a> potentially identifying what I was doing wrong.<br /><br />The problem remains that I cannot translate the SVG toppings in my <code>&lt;x-pizza></code> pizza building <a href="http://www.polymer-project.org/">Polymer</a> element. Well, I can translate them, but they are mysteriously clipped if I stray too far:<br /><br /><a href="http://2.bp.blogspot.com/-iSXjtp4fUws/U4ZjLZBVpMI/AAAAAAAAZ4s/WQG9gGeuXZY/s1600/02-clipped_on_purpose.png" imageanchor="1" ><img border="0" src="http://2.bp.blogspot.com/-iSXjtp4fUws/U4ZjLZBVpMI/AAAAAAAAZ4s/WQG9gGeuXZY/s400/02-clipped_on_purpose.png" /></a><br /><br />I tried <code>overflow</code> and <code>clip</code> properties on those SVG elements, but to no avail. The SVG images were always clipped when moved too far. The “pepperoni” images are sized initially to 32×32 in the asset:<pre class=prettyprint>&lt;?xml version="1.0" encoding="UTF-8" standalone="no"?><br />&lt;!-- Created with Inkscape (http://www.inkscape.org/) --><br />&lt;svg<br />   xmlns:svg="http://www.w3.org/2000/svg"<br />   xmlns="http://www.w3.org/2000/svg"<br />   version="1.1"<br /><b>   width="32"<br />   height="32"</b>><br />  &lt;path<br />      d="M 22,12 A 10,10 0 1 1 2,12 10,10 0 1 1 22,12 z"<br />      style="fill:#d40000;fill-opacity:1;stroke:#000000;stroke-width:1.5;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none" /><br />&lt;/svg></pre>From what I glean from Emanuele's comments, I may not even be getting 32×32 for the viewport. Rather, I may only be getting 22×22 from the drawing area (plus a little from the stroke and filter). Anyhow, to test the viewport, I start the SVG 16 pixels to the right, which should be outside the default viewport regardless if it is 32×32 or slightly smaller:<pre class=prettyprint><code>    var path = svg.query('path')<br />      ..setAttribute('transform', 'translate(16,0)');</code></pre>And indeed, it is clipped by the viewport:<br /><br /><a href="http://1.bp.blogspot.com/-SBoxTclamjo/U4ZrlmrWyCI/AAAAAAAAZ44/xdqov51hrGA/s1600/01-clipped_viewport.png" imageanchor="1" ><img border="0" src="http://1.bp.blogspot.com/-SBoxTclamjo/U4ZrlmrWyCI/AAAAAAAAZ44/xdqov51hrGA/s400/01-clipped_viewport.png" /></a><br /><br />Now, I apply a viewport. I am going to define the viewport such that it is definitely larger than 32×32 initial size so that it ought to fit my translated image. 48×48 ought to do:<pre class=prettyprint><code>    svg.query('svg')<br />      ..setAttribute('viewBox', '0 0 48 48');</code></pre>And indeed it does the trick. The pepperoni images are no longer clipped:<br /><br /><a href="http://4.bp.blogspot.com/-zIDQFV7Cv1k/U4ZsdoD9gYI/AAAAAAAAZ5A/2wiqI9kVwc0/s1600/02-svg_not_clipped_but_small.png" imageanchor="1" ><img border="0" src="http://4.bp.blogspot.com/-zIDQFV7Cv1k/U4ZsdoD9gYI/AAAAAAAAZ5A/2wiqI9kVwc0/s400/02-svg_not_clipped_but_small.png" /></a><br /><br />It is no longer clipped, but the images are now scaled smaller. The reason that they are smaller is that I am squishing a 48×48 viewport into a 32×32 sized image. If I change the width and height attributes on the SVG image to match the viewport:<pre class=prettyprint><code>    svg.query('svg')<br />      ..setAttribute('viewBox', '0 0 48 48')<br />      ..setAttribute('width', '48')<br />      ..setAttribute('height', '48');<br /></code></pre>Then I have my pepperonis translated 16 pixels, still in the viewport, and not scaled:<br /><br /><a href="http://1.bp.blogspot.com/-_GlNGdMOL1k/U4ZtWdSyYRI/AAAAAAAAZ5I/B_7YeNh1Djw/s1600/03-svg_viewport_not_clipped_not_scaled.png" imageanchor="1" ><img border="0" src="http://1.bp.blogspot.com/-_GlNGdMOL1k/U4ZtWdSyYRI/AAAAAAAAZ5I/B_7YeNh1Djw/s400/03-svg_viewport_not_clipped_not_scaled.png" /></a><br /><br />So the mystery of the clipping seems to be solved (thanks yet again to Emanuele!).<br /><br />Before calling it a night, I note that this viewport stuff is really non-obvious in browsers. Even with the viewport set to 48×48 and the SVG image set to 48×48, the browser reports the size of the drawing to be <i>just</i> the drawing:<br /><br /><a href="http://2.bp.blogspot.com/-XYkvWX0LR6o/U4aq6pbvMaI/AAAAAAAAZ5g/wqcNrUG9MKk/s1600/04-svg_not_clipped_size.png" imageanchor="1" ><img border="0" src="http://2.bp.blogspot.com/-XYkvWX0LR6o/U4aq6pbvMaI/AAAAAAAAZ5g/wqcNrUG9MKk/s640/04-svg_not_clipped_size.png" /></a><br /><br />The group element that holds the translated SVG asset does have appropriately large dimensions:<br /><br /><a href="http://4.bp.blogspot.com/-UZS_uUlr-PE/U4aq6n0UpXI/AAAAAAAAZ5c/D39SBrqnwEg/s1600/05-svg_g_not_cliped_size.png" imageanchor="1" ><img border="0" src="http://4.bp.blogspot.com/-UZS_uUlr-PE/U4aq6n0UpXI/AAAAAAAAZ5c/D39SBrqnwEg/s640/05-svg_g_not_cliped_size.png" /></a><br /><br />But the dimensions are exactly as they were prior to fiddling with the viewport:<br /><br /><a href="http://1.bp.blogspot.com/-zrG-SUUPEK0/U4aq6l1A6PI/AAAAAAAAZ5o/Ftm7PIJqFx8/s1600/06-svg_g_clipped_size.png" imageanchor="1" ><img border="0" src="http://1.bp.blogspot.com/-zrG-SUUPEK0/U4aq6l1A6PI/AAAAAAAAZ5o/Ftm7PIJqFx8/s640/06-svg_g_clipped_size.png" /></a><br /><br />In other words, there is no indication whatsoever that the viewport is at play here, which is what led me down the ill-fated <code>clip</code> and <code>overflow</code> path.<br /><br />Thankfully, I can rely on the kindness of others to educate me when I go wrong. Thanks again, Emanuele.<br /><br />Up tomorrow: I get back to a little pure Polymer code as I prep for the actual <a href="http://patternsinpolymer.com">Patterns in Polymer</a> screencasts.<br /><br /><br /><span style="color: #ccc">Day #77</span>  <br /><br /><p class=bottom-chain-links><a href="http://japhr.blogspot.com/2014/05/mouse-events-and-svg-paths.html">&lsaquo;prev</a> | <a href="http://japhr.blogspot.com/2013/11/new-chain-patterns-in-polymer.html">My Chain</a> | <a href="http://japhr.blogspot.com/2014/05/waiting-for-polymer-assets.html">next&rsaquo;</a> </p><script>var b_links = document.getElementsByClassName('bottom-chain-links'),      t_links = document.getElementsByClassName('top-chain-links');  if (b_links.length == 1 && t_links.length == 1) {   t_links[0].innerHTML = b_links[0].innerHTML; } </script><img src="http://feeds.feedburner.com/~r/JaphrByChrisStrom/~4/5xGDFvLX9yY" height="1" width="1"/>
