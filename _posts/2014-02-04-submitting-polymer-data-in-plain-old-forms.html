---
title: 'Submitting Polymer Data in Plain Old Forms'
layout: post
published: '2014-02-04T23:59:00-05:00'
feed: 'japh(r) by Chris Strom'
link: 'http://feedproxy.google.com/~r/JaphrByChrisStrom/~3/L2y0cnYlkCI/submitting-polymer-data-in-plain-old.html'
author:
    name: 'Chris Strom'
    email: noreply@blogger.com
    url: 'https://plus.google.com/117928918793969810642'
tags:
    - chain
    - dart
    - dartlang
    - 'mutation observer'
    - polymer

---

<div class=top-chain-links></div><br />If an <code>&lt;input></code> element embedded in a <a href="http://www.polymer-project.org/">Polymer</a> which is wrapped by a <code>&lt;form></code> <a href="http://japhr.blogspot.com/2014/02/submitting-forms-containing-polymers.html">cannot be reliably submitted</a> by that <code>&lt;form></code>, what are my options for submitting Polymer form data?<br /><br />More concretely, what are my options for submitting the value in the “Embedded Polymer field” along with the remainder of the form in the following?<br /><br /><a href="http://2.bp.blogspot.com/-o4fYvLn5R-I/UvHC-tfmRWI/AAAAAAAAVDw/ZcJcNXjk0tw/s1600/01-plain_old_polymer_form.png" imageanchor="1" ><img border="0" src="http://2.bp.blogspot.com/-o4fYvLn5R-I/UvHC-tfmRWI/AAAAAAAAVDw/ZcJcNXjk0tw/s320/01-plain_old_polymer_form.png" /></a><br /><br />I am pretty sure that I need some variation the <a href="http://japhr.blogspot.com/2014/02/mutationobserver-as-best-dart-practice.html">mutation observer</a> from the other night, but, before I can get to that, I need to ensure that the form elements inside my Polymer are not submitted on the off chance that the current browser and/or version of Polymer accidentally tries to use them. That is a simple matter of not naming the <code>&lt;input></code> tag from last night. So I remove <code>name="embedded_polymer_param"</code> in the following:<pre class=prettyprint>&lt;polymer-element name="hello-you"><br />  &lt;template><br />    &lt;h2>Hello {{your_name}}&lt;/h2><br />    &lt;p><br /><b>      &lt;input type=text value="{{your_name}}" placeholder="Embedded Polymer field"></b><br />      &lt;button on-click="{{feelingLucky}}">Colorize!&lt;/button><br />    &lt;/p><br />    &lt;p class=help-block><br />      &lt;content>&lt;/content><br />    &lt;/p><br />  &lt;/template><br />  &lt;script type="application/dart" src="hello_you.dart">&lt;/script><br />&lt;/polymer-element></pre>Now that I think about it, if I embed an instance of this <code>&lt;hello-you></code> Polymer inside a <code>&lt;form></code> tag, the Polymer's <code>&lt;button></code> could very well submit the form. I could (and probably should) add <code>type="button"</code> to override the default of <code>submit</code>, but first, I realize that I have no idea what arguments would be sent to the <code>on-click</code> Polymer event handler.<br /><br />It turns out to be a plain-old event (well, a Polymer wrapped event, but still an event). So I can prevent the click with the usual <code>preventDefault</code> and a <code>return false</code>:<pre class=prettyprint>@CustomTag('hello-you')<br />class HelloYou extends PolymerElement {<br />  // ...<br />  feelingLucky(e) {<br />    //  Pick a random color here...<br /><b>    e.preventDefault();<br />    return false;</b><br />  }<br />}</pre>(the same thing works in the JavaScript equivalent)<br /><br />That is good information to have for my Polymer toolbelt, but it seems safest to use non-form interacting form elements: inputs without names and buttons with <code>type="button"</code>:<pre class=prettyprint><code>      &lt;input value="{{your_name}}" placeholder="Embedded Polymer field"><br />      &lt;button type="button" on-click="{{feelingLucky}}">Colorize!&lt;/button></code></pre>To actually get that data into the form, I add a mutation observer from the <code>main()</code> entry point:<pre class=prettyprint>main() {<br />  initPolymer().run((){<br />    var observer = new MutationObserver((mutations, _) {<br />      var el = query('#your_name');<br />      mutations.forEach((mutation) {<br />        if (mutation.attributeName == 'your_name') {<br />          el.value = mutation.target.attributes[mutation.attributeName];<br />        }<br />      });<br />    });<br />    observer.observe(query('hello-you'), attributes: true);<br />  });<br />}</pre>There is nothing too new in there. I find a hidden input with <code>id=your_name</code> in the form. Whenever the mutation observer notices a change to the <code>your_name</code> attribute on the Polymer, it updates the value of that same hidden input.<br /><br />This will not work for arbitrary form elements inside the Polymer. If there were additional <code>&lt;input></code> tags inside the Polymer, the mutation observer approach would not work—at least not without working pretty hard to dig down into the shadow DOM of the Polymer. But really, this seems OK. Unless the Polymer publishes a value as an attribute, the external page context should almost certainly treat unpublished values as private. In such cases, either the Polymer would have to change to expose another attribute or the developer using the Polymer would have to rethink the best use of the Polymer.<br /><br /><br /><br /><span style="color: #ccc">Day #1,017</span>  <br /><br /><p class=bottom-chain-links><a href="http://japhr.blogspot.com/2014/02/submitting-forms-containing-polymers.html">&lsaquo;prev</a> | <a href="http://japhr.blogspot.com/2013/11/new-chain-patterns-in-polymer.html">My Chain</a> | <a href="http://japhr.blogspot.com/2014/02/running-two-dart-scripts-from-same-page.html">next&rsaquo;</a> </p><script>var b_links = document.getElementsByClassName('bottom-chain-links'),      t_links = document.getElementsByClassName('top-chain-links');  if (b_links.length == 1 && t_links.length == 1) {   t_links[0].innerHTML = b_links[0].innerHTML; } </script><img src="http://feeds.feedburner.com/~r/JaphrByChrisStrom/~4/L2y0cnYlkCI" height="1" width="1"/>
