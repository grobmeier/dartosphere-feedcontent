---
title: 'Polymers that Accept External CSS'
layout: post
published: '2014-02-08T14:19:00-05:00'
feed: 'japh(r) by Chris Strom'
link: 'http://feedproxy.google.com/~r/JaphrByChrisStrom/~3/BX5ocAveknI/polymers-that-accept-external-css.html'
author:
    name: 'Chris Strom'
    email: noreply@blogger.com
    url: 'https://plus.google.com/117928918793969810642'
tags:
    - chain
    - css
    - dart
    - javascript
    - polymer

---

<div class=top-chain-links></div><br /><a href="http://www.polymer-project.org/">Polymer</a> is a fantastic horizontal code tool. Unlike <a href="http://angularjs.org/">Angular</a> and its brethren which carve out vertical slices (think URLs) in an application, Polymer carves out brilliant little <i>isolated</i> sections on a page. Wherever Polymers are used, they create new, blank shadow DOMs in which to play—blissfully unaware of any craziness that might be occurring on the rest of the page. Polymers can be used in Angular, Ember, Backbone and plain old pages with equal effectiveness because they only operate in their tiny little shadow DOM. <br /><br />But, if they are so isolated, how do they end up looking like the rest of the application?<br /><br />Really, I am wondering how Polymers might solve the window toolkit problem that has plagued so many windowing toolkits over the years: how do you go about creating a window toolkit widget that looks like the application in which it is used, not like the window toolkit. As I found last night, if the Polymer is intended for reuses only with a single website, it is possible for the site-specific Polymer to pull in the CSS from the site. This also applies if the Polymer is intended to be reused with a common CSS, such as <a href="http://getbootstrap.com/">Bootstrap</a>.<br /><br />But what if you want to create a new, custom HTML element with Polymer that is a bit more general? What if you wanted, say, to create the ultimate pizza builder HTML tag that could be used on any pizza related site, regardless of CSS framework, local styles, etc?<br /><br />I know that things like <a href="https://jqueryui.com/">jQuery UI</a> use themes for this problem. To my eye, these never look <i>quite</i> right. A writing teacher once told me that reading from one paragraph of mine to the next was like riding in a manual transmission car with someone who couldn't drive stick shift. Eventually you get to where you need to be, but the ride along the way is filled with many unexpected, jarring jerks. Maybe I'm just too fussy, but that's how themed widgets look to me.<br /><br />To avoid the “bad stick shift” visuals, I inevitably wind up customizing the theme. That may be fine with jQuery UI and other “light DOM” toolkits, but how do you style something in the shadow DOM? The <a href="http://japhr.blogspot.com/2014/02/cat-hat-in-dartium.html">cat and hat</a> selectors (if they become widespread) might be one way. Is it possible to include styles directly inside the custom element tags instead? Something like:<pre class=prettyprint><code>    &lt;pricing-plans><br /><b>      &lt;link type="text/css" rel="stylesheet" href="css/mine.css"><br />      &lt;style><br />        p { border: 5px solid orange }<br />      &lt;/style></b><br />      &lt;pricing-plan name="Multi-Language">&lt;!-- ... -->&lt;/pricing-plan><br />      &lt;pricing-plan name="I Only Like One"&lt;!-- ... -->&lt;/pricing-plan>><br />      &lt;pricing-plan name="Extras" type="primary">&lt;!-- ... -->&lt;/pricing-plan><br />    &lt;/pricing-plans></code></pre>Content inside a Polymer tag like that is distributed into the Polymer's <code>&lt;content></code> tag:<pre class=prettyprint>&lt;polymer-element name="pricing-plans"><br />  &lt;template><br />    &lt;div class="container"><br />      &lt;div class="col-md-12 col-sm-4"><br /><b>        &lt;content>&lt;/content></b><br />      &lt;/div><br />    &lt;/div><br />  &lt;/template><br />  &lt;!-- ... --><br />&lt;/polymer-element></pre>The problem is the word “distributed.” That content—the CSS and the individual <code>&lt;pricing-plan></code> elements—are not actually inserted into the Polymer's DOM, just rendered there. Still, if “distributed” means that the styles are applied, then this ought to work.<br /><br />It does not:<br /><br /><a href="http://2.bp.blogspot.com/-p5QcRvYyu4M/UvZ34zIUdhI/AAAAAAAAVUY/2JTqmdAWtMU/s1600/01-styles_distributed_outside_the_shadow_root.png" imageanchor="1" ><img border="0" src="http://2.bp.blogspot.com/-p5QcRvYyu4M/UvZ34zIUdhI/AAAAAAAAVUY/2JTqmdAWtMU/s640/01-styles_distributed_outside_the_shadow_root.png" /></a><br /><br />Neither the <code>&lt;link></code> nor the <code>&lt;style></code> tags are included in the shadow DOM and, certainly, none of the paragraphs have large orange borers around them. Bother.<br /><br />I am not quite out of luck, however. I can expose a <code>css</code> attribute on the Polymer:<pre class="prettyprint"><code>    &lt;pricing-plans <b>css="/assets/cat_hat/mine.css"</b>><br />      &lt;pricing-plan name="Multi-Language">&lt;!-- ... -->&lt;/pricing-plan><br />      &lt;pricing-plan name="I Only Like One"&lt;!-- ... -->&lt;/pricing-plan>><br />      &lt;pricing-plan name="Extras" type="primary">&lt;!-- ... -->&lt;/pricing-plan><br />    &lt;/pricing-plans></code></pre>Then, in the Polymer Dart code, I can add a <code>&lt;style></code> element that imports that style into the Polymer's shadow DOM:<pre class=prettyprint>@CustomTag('pricing-plans')<br />class PricingPlansElement extends PolymerElement {<br /><b>  @published String css;</b><br />  PricingPlansElement.created() : super.created();<br />  enteredView() {<br />    super.enteredView();<br />    if (css != null) {<br />      shadowRoot.append(<br /><b>        new StyleElement()..text = "@import '${css}';"</b><br />      );<br />    }<br />  }<br />}</code></pre>Or the equivalent JavaScript version:<pre class=prettyprint><code>    Polymer('pricing-plans', {<br />      enteredView: function() {<br /><b>        if (this.css) {<br />          var ss = document.createElement("style");<br />          ss.textContent = "@import '" + this.css + "';";<br />          this.shadowRoot.appendChild(ss);<br />        }</b><br />      }<br />    });</code></pre>With that, I can affect the styles of my Polymer from the outside—even if my particular tastes leave something to be desired:<br /><br /><a href="http://3.bp.blogspot.com/-roLpO0gdCWA/UvaArykDNCI/AAAAAAAAVUo/0yMK8pwXQAU/s1600/02-ugly_css.png" imageanchor="1" ><img border="0" src="http://3.bp.blogspot.com/-roLpO0gdCWA/UvaArykDNCI/AAAAAAAAVUo/0yMK8pwXQAU/s640/02-ugly_css.png" /></a><br /><br />For completeness sake, I note that the equivalent <code>&lt;link></code> import of the same CSS was silently ignored.<br /><br />This approach requires some effort, but, now that I have all the pieces in place, not as much as I feared. This is still more of an edge case. I would imagine that folks creating shareable Polymers across sites would be more than willing to add something like this to their Polymers (along with an example or two). I tend to view sharing Polymers within a site as the 80% case and that already works out of the box. <br /><br /><span style="color: #ccc">Day #1,021</span>  <br /><br /><p class=bottom-chain-links><a href="http://japhr.blogspot.com/2014/02/application-css-in-polymers-redux.html">&lsaquo;prev</a> | <a href="http://japhr.blogspot.com/2013/11/new-chain-patterns-in-polymer.html">My Chain</a> | <a href="http://japhr.blogspot.com/2014/02/extending-built-in-elements-with-polymer.html">next&rsaquo;</a> </p><script>var b_links = document.getElementsByClassName('bottom-chain-links'),      t_links = document.getElementsByClassName('top-chain-links');  if (b_links.length == 1 && t_links.length == 1) {   t_links[0].innerHTML = b_links[0].innerHTML; } </script><img src="http://feeds.feedburner.com/~r/JaphrByChrisStrom/~4/BX5ocAveknI" height="1" width="1"/>
