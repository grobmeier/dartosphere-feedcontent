---
title: 'Extending Built-in Elements with Polymer'
layout: post
published: '2014-02-09T14:21:00-05:00'
feed: 'japh(r) by Chris Strom'
link: 'http://feedproxy.google.com/~r/JaphrByChrisStrom/~3/7U4BY1QhAIE/extending-built-in-elements-with-polymer.html'
author:
    name: 'Chris Strom'
    email: noreply@blogger.com
    url: 'https://plus.google.com/117928918793969810642'
tags:
    - chain
    - dart
    - dartlang
    - javascript
    - 'mutation observer'
    - polymer

---

<div class=top-chain-links></div><br />I just completed the writeup for using custom <a href="http://www.polymer-project.org/">Polymer</a> elements in plain-old HTML forms in <a href="http://patternsinpolymer.com">Patterns in Polymer</a>. Now I wonder if the entire premise was wrong. That's par for the course for me, but thankfully I have these little research spurts to allow me to investigate.<br /><br />The solution currently presented in <a href="http://patternsinpolymer.com">Patterns in Polymer</a> is based on using <a href="https://developer.mozilla.org/en-US/docs/Web/API/MutationObserver">mutation observers</a> to watch a Polymer attribute, updating a hidden HTML form element accordingly. That works fine and really is not too much code. Still, I wonder if there is a better solution. Specifically, what if the Polymer inherits from <a href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLInputElement">InputElement</a>? Would the Polymer work directly inside a form like any other element?<br /><br />In the <a href="http://dartlang.org">Dart</a> version of a very simple <code>&lt;hello-you></code>, I update the polymer-element declaration to extend the <code>input</code> element:<pre class=prettyprint><b>&lt;polymer-element name="hello-you" extends="input"></b><br />  &lt;template><br />    &lt;!-- ... --><br />    &lt;input type=text name="embedded_polymer_param" value="{{value}}"><br />    &lt;!-- ... --><br />  &lt;/template><br />  &lt;script type="application/dart" src="hello_you.dart">&lt;/script><br />&lt;/polymer-element></pre>Then, in the backing <code>hello_you.dart</code>, I change the class to extend <code>InputElement</code> and mixin both <code>Polymer</code>  and <code>Observable</code>:<pre class="prettyprint">@CustomTag('hello-you')<br /><b>class HelloYou extends InputElement with Polymer, Observable {</b><br />  @published String value;<br />  HelloYou.created() : super.created() {<br />    polymerCreated();<br />  }<br />  // ...<br />}</pre>Since this no longer extends <code>PolymerElement</code> directly, I also have to manually invoke <code>polymerCreated()</code> when the element is created.<br /><br />With that, I am ready to use a “hello-you” version of an <code>&lt;input></code>. Since this is extending a built-in field, I have to use the regular HTML name and tack on <code>is="hello-you"</code> to use the extended version:<pre class=prettyprint><code>      &lt;form action="test" method="post"><br />        &lt;input type=hidden id=your_name><br />        &lt;h1>Plain-old Form&lt;/h1><br />        &lt;input type=text name="plain_old_param"><br /><b>        &lt;input name="polymer_value" is="hello-you"></b><br />          &lt;input type=text name="distributed_param"><br />        &lt;/input><br />        &lt;button>Play&lt;/button><br />      &lt;/form></code></pre>And that works. Kind of.<br /><br />When I submit the form, I see the value from the Polymer extended <code>&lt;input></code> among the form parameters:<pre class=prettyprint>plain_old_param:<br /><b>polymer_value:asdf</b><br />distributed_param:</pre>The problem is the use of the <code>&lt;input></code> element. It does not accept child elements, which breaks trying to project content into the Polymer:<br /><br /><a href="http://2.bp.blogspot.com/-vV_7zX401Yk/Uve-pL6PAOI/AAAAAAAAVU4/_3jtNWiLUNc/s1600/01-extended_input_field.png" imageanchor="1" ><img border="0" src="http://2.bp.blogspot.com/-vV_7zX401Yk/Uve-pL6PAOI/AAAAAAAAVU4/_3jtNWiLUNc/s640/01-extended_input_field.png" /></a><br /><br />The element with the “Projected” placeholder text ought to be rendered in the Polymer, not to the side. There is also the weird styling on the <code>&lt;input></code>. Well, not too weird, this is an <code>&lt;input></code> after all. Still, it would have to be addressed if I wanted to push this further.<br /><br />The main reason that I would be unlikely to use this approach over mutation observing is that it makes it hard to work with multiple values from the Polymer. Also, unless I am mistaken, extending browser elements does not work at all in the JavaScript version of Polymer. <a href="http://www.polymer-project.org/polymer.html#extending-other-elements">The example</a> given in the documentation extends another Polymer, not a standard browser element. When I tried it in JavaScript:<pre class=prettyprint>&lt;polymer-element name="hello-you" extends="input" attributes="value"></pre>Then the element was ignored completely. <br /><br />Phew! So a complete chapter rewrite is not necessary, which is always nice. I will likely add a sentence in the JavaScript version of <a href="http://patternsinpolymer.com">Patterns in Polymer</a> about not being able to extend built-in elements. It may be a paragraph about the limitations of doing so in the Dart version. But either way, the current mutation observer approach seems solid.<br /><br /><br /><span style="color: #ccc">Day #1,022</span>  <p class=bottom-chain-links><a href="http://japhr.blogspot.com/2014/02/polymers-that-accept-external-css.html">&lsaquo;prev</a> | <a href="http://japhr.blogspot.com/2013/11/new-chain-patterns-in-polymer.html">My Chain</a> | <span style="color: #ccc">next&rsaquo;</span> </p><script>var b_links = document.getElementsByClassName('bottom-chain-links'),      t_links = document.getElementsByClassName('top-chain-links');  if (b_links.length == 1 && t_links.length == 1) {   t_links[0].innerHTML = b_links[0].innerHTML; } </script><img src="http://feeds.feedburner.com/~r/JaphrByChrisStrom/~4/7U4BY1QhAIE" height="1" width="1"/>
