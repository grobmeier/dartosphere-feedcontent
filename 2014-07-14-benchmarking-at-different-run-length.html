---
title: 'Benchmarking at Different Run Length'
layout: post
published: '2014-07-14T23:59:00-04:00'
feed: 'japh(r) by Chris Strom'
link: 'http://feedproxy.google.com/~r/JaphrByChrisStrom/~3/_Bt856IZlPs/benchmarking-at-different-run-length.html'
author:
    name: 'Chris Strom'
    email: noreply@blogger.com
    url: 'https://plus.google.com/117928918793969810642'
tags:
    - benchmarking
    - chain
    - dart
    - dartlang
    - 'design patterns'
    - 'visitor pattern'

---

<div class=top-chain-links></div><br />It seems that my benchmarks may be hitting a garbage collection limit somewhere along the way.<br /><br />So I add command line options to my benchmarks, write a shell script to exercise them:<pre class=prettyprint>#!/bin/sh<br /><br />for X in 10 100 1000 10000 100000<br />do<br />    echo ''<br />    echo '=='<br />    echo "Loop size: $X"<br />    ./tool/benchmark.dart --loop-size=$X<br />    echo '--'<br />    ./tool/benchmark_single_dispatch_iteration.dart --loop-size=$X<br />    echo '--'<br />    ./tool/benchmark_visitor_traverse.dart --loop-size=$X<br />done<br /></pre>What I find is:<br /><table><tr><th>Loop Size</th><th>Classic</th><th>Nodes Traverse<br/>(single dispatch)</th><th>Visitor Traverses<th></tr><tr><td>10</td><td>131.6</td><td>122.7</td><td>121.4</td></tr><tr><td>100</td><td>125.9</td><td>113.6</td><td>120.15</td></tr><tr><td>1000</td><td>123.8</td><td>122.8</td><td>120.65</td></tr><tr><td>10000</td><td>157.0</td><td>153.25</td><td>120.45</td></tr><tr><td>100000</td><td>158.05</td><td>154.65</td><td>121.05</td></tr></table><br />Or, in graphical form:<br /><br /><a href="http://2.bp.blogspot.com/-4A8OL17sYFg/U8SnDRkgoXI/AAAAAAAAdOA/rruRWxn8-88/s1600/image+(1).png" imageanchor="1" ><img border="0" src="http://2.bp.blogspot.com/-4A8OL17sYFg/U8SnDRkgoXI/AAAAAAAAdOA/rruRWxn8-88/s640/image+(1).png" /></a><br /><br /><br />I am unsure if that is really garbage collection, but <i>something</i> reliably affects the two implementations in which the node structure is responsible for traversing itself. And somehow making the visitor responsible for traversing the node structure (even with double dispatching) is not affected.<br /><br /><br /><br /><br /><br /><br /><a href="http://dartlang.org">Dart</a> <a href="http://designpatternsindart.com/">Design Patterns in Dart</a> <a href="http://en.wikipedia.org/wiki/Design_Patterns">Gang of Four book</a> <a href="https://www.dartlang.org/polymer-dart/">Polymer.dart</a> <a href="http://www.polymer-project.org/">Polymer</a><br /><br /><br /><span style="color: #ccc">Day #122</span>  <br /><br /><p class=bottom-chain-links><a href="http://japhr.blogspot.com/2014/07/long-vs-short-benchmarks-also-im-true.html">&lsaquo;prev</a> | <a href="http://japhr.blogspot.com/2013/11/new-chain-patterns-in-polymer.html">My Chain</a> | <span style="color: #ccc">next&rsaquo;</span> </p><script>var b_links = document.getElementsByClassName('bottom-chain-links'),      t_links = document.getElementsByClassName('top-chain-links');  if (b_links.length == 1 && t_links.length == 1) {   t_links[0].innerHTML = b_links[0].innerHTML; } </script><img src="http://feeds.feedburner.com/~r/JaphrByChrisStrom/~4/_Bt856IZlPs" height="1" width="1"/>
