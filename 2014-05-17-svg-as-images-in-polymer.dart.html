---
title: 'SVG as Images in Polymer.dart'
layout: post
published: '2014-05-17T23:59:00-04:00'
feed: 'japh(r) by Chris Strom'
link: 'http://feedproxy.google.com/~r/JaphrByChrisStrom/~3/R0z0VBDUTC0/svg-as-images-in-polymerdart.html'
author:
    name: 'Chris Strom'
    email: noreply@blogger.com
    url: 'https://plus.google.com/117928918793969810642'
tags:
    - chain
    - dart
    - dartlang
    - inkscape
    - polymer
    - svg

---

<div class=top-chain-links></div><br />I am dynamically generating the SVG in my <code>&lt;x-pizza></code> pizza-building <a href="http://www.polymer-project.org/">Polymer</a>. And for the life of me, I don't know why. But it may have been a lucky guess.<br /><br />For my fist pass, the shapes were all circles:<br /><br /><a href="http://4.bp.blogspot.com/-x9zrUjryHTU/U3gMiFKCglI/AAAAAAAAZUI/l_3ZIEZ4Fvs/s1600/x_pizza_builder_dart.png" imageanchor="1" ><img border="0" src="http://4.bp.blogspot.com/-x9zrUjryHTU/U3gMiFKCglI/AAAAAAAAZUI/l_3ZIEZ4Fvs/s320/x_pizza_builder_dart.png" /></a><br /><br />The pizza was effectively inlined in the Polymer element's shadow DOM with a bit of JavaScript:<pre class=prettyprint><code>  _updateGraphic: function() {<br />    this.$['pizza-graphic'].innerHTML = '' +<br />      '&lt;circle cx="150" cy="150" r="150" fill="tan" />' +<br />      '&lt;circle cx="150" cy="150" r="140" fill="darkred" />' +<br />      '&lt;circle cx="150" cy="150" r="135" fill="lightyellow" />';<br /><br />    this._addWholeToppings();<br />    this._addFirstHalfToppings();<br />    this._addSecondHalfToppings();<br />  },</code></pre>For now, I am going to leave that in place in my custom element. Instead, I will concentrate on loading an external SVG file for the toppings and adding them to the SVG.<br /><br />I thought I had the hang of saving SVG from Inkscape, but when I create a 10x10 pixel pepperoni, set the document properties so that the page is 10x10 as well and save:<br /><br /><a href="http://2.bp.blogspot.com/-N6hh3wgnlOs/U3ga9DvXcCI/AAAAAAAAZUQ/7kDlu_ksHC4/s1600/01-10_by_10_pepperoni.png" imageanchor="1" ><img border="0" src="http://2.bp.blogspot.com/-N6hh3wgnlOs/U3ga9DvXcCI/AAAAAAAAZUQ/7kDlu_ksHC4/s400/01-10_by_10_pepperoni.png" /></a><br /><br />I always get a matrix transform in the resulting plain (not Inkscape formatted) SVG file:<pre class=prettyprint>&lt;svg<br />   xmlns:svg="http://www.w3.org/2000/svg"<br />   xmlns="http://www.w3.org/2000/svg"<br />   version="1.1"<br />   width="10"<br />   height="10"><br />  &lt;g transform="translate(0,-1042.3622)"><br />    &lt;path<br />       d="m 239.99999,318.07648 a 34.285713,37.142857 0 1 1 -68.57142,0 34.285713,37.142857 0 1 1 68.57142,0 z"<br /><b>       transform="matrix(0.14380379,0,0,0.13275542,-24.582993,1005.1358)"</b><br />       style="fill:#d40000;fill-opacity:1;stroke:#000000;stroke-width:1;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none" /><br />  &lt;/g><br />&lt;/svg></pre>This may not be a huge deal—this is vector graphic manipulation, after all. Still, I bothers me that my SVG is being translated -1042.3622 pixels and then run through that transform matrix. Heh, I realize that I trying to get pixel perfection in a scalable vector graphic, which is just silly. So I press on for now (but I will revisit at some point).<br /><br />Anyhow, I copy said <code>pepperoni.svg</code> into my Polymer library's asset directory, then try to use it in my Dart code thusly:<pre class=prettyprint><code>  _svgPepperoni() {<br />    var svgImage = new ImageElement(src: '/assets/svg_example/pepperoni.svg');<br />    return new GElement()<br />      ..append(svgImage);<br />  }</code></pre>Which does not work at all—there is no matching constructor. Eventually, I realize that <code>ImageElement</code> is different than an <code>&lt;img></code> element. In order to load an SVG as an image, I need the XLINK namespace, which requires the <code>setAttributeNS</code> method:<pre class=prettyprint><code>  _svgPepperoni() {<br />    var svgImage = new ImageElement()<br /><b>      ..setAttributeNS('http://www.w3.org/1999/xlink', 'href', '/assets/svg_example/pepperoni.svg')</b><br />      // ..setAttribute('href', '/assets/svg_example/pepperoni.svg')<br />      ..setAttribute('width', '10')<br />      ..setAttribute('height', '10');<br /><br />    return new GElement()<br />      ..append(svgImage);<br />  }</code></pre>(the commented out, non-namespace version does not work)<br /><br />That's pretty ugly, but it works:<br /><br /><a href="http://4.bp.blogspot.com/-eUcnfHXPi2A/U3g3QmeIJcI/AAAAAAAAZUc/RpoZBtKwzBQ/s1600/01-worky_pepperoni_from_image.png" imageanchor="1" ><img border="0" src="http://4.bp.blogspot.com/-eUcnfHXPi2A/U3g3QmeIJcI/AAAAAAAAZUc/RpoZBtKwzBQ/s400/01-worky_pepperoni_from_image.png" /></a><br /><br />Ugh. This SVG stuff sure is a pain. I am unsure if Dart has any facilities for making this easier. The current approach is very much a JavaScript-y approach and it feels like it. It is hacky and of the barely-holding-duct-tape variety. Still, it does work, which is a start.<br /><br /><br /><span style="color: #ccc">Day #66</span>  <br /><br /><p class=bottom-chain-links><a href="http://japhr.blogspot.com/2014/05/improved-slightly-inkscape-svg-workflow.html">&lsaquo;prev</a> | <a href="http://japhr.blogspot.com/2013/11/new-chain-patterns-in-polymer.html">My Chain</a> | <a href="http://japhr.blogspot.com/2014/05/drawing-simple-svg-and-xml-in-inkscape.html">next&rsaquo;</a> </p><script>var b_links = document.getElementsByClassName('bottom-chain-links'),      t_links = document.getElementsByClassName('top-chain-links');  if (b_links.length == 1 && t_links.length == 1) {   t_links[0].innerHTML = b_links[0].innerHTML; } </script><img src="http://feeds.feedburner.com/~r/JaphrByChrisStrom/~4/R0z0VBDUTC0" height="1" width="1"/>
