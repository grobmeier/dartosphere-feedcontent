---
title: 'DOM Animation of SVG'
layout: post
published: '2014-05-23T23:59:00-04:00'
feed: 'japh(r) by Chris Strom'
link: 'http://feedproxy.google.com/~r/JaphrByChrisStrom/~3/IeGAP1ub82M/dom-animation-of-svg.html'
author:
    name: 'Chris Strom'
    email: noreply@blogger.com
    url: 'https://plus.google.com/117928918793969810642'
tags:
    - chain
    - dart
    - dartlang
    - polymer
    - polymer-elements
    - svg

---

<div class=top-chain-links></div><br />Up today, I try to build on the SVG loading solution for my <code>&lt;x-pizza></code> custom <a href="http://dartlang.org">Dart</a> <a href="http://www.polymer-project.org/">Polymer</a> element:<br /><br /><a href="http://4.bp.blogspot.com/-yqDr0zIZvx4/U4AYnRuXe8I/AAAAAAAAZtg/waDd7UwX2oM/s1600/03-x_pizza_with_svg_images.png" imageanchor="1" ><img border="0" src="http://4.bp.blogspot.com/-yqDr0zIZvx4/U4AYnRuXe8I/AAAAAAAAZtg/waDd7UwX2oM/s320/03-x_pizza_with_svg_images.png" /></a><br /><br />Thanks to last night, I am loading SVG content directly into my application via the Polymer Elements' <code>&lt;polymer-ajax></code>:<pre class=prettyprint>&lt;link rel="import" <br />      href="../../../packages/polymer_elements/polymer_ajax/polymer_ajax.html"><br />&lt;polymer-element name="x-pizza"><br />  &lt;template><br />    &lt;polymer-ajax<br />       id="pizza.svg"<br />       url="/packages/svg_example/images/pizza.svg"<br />       on-polymer-response="{{responseReceived}}">&lt;/polymer-ajax><br />    &lt;polymer-ajax<br />       id="pepperoni.svg"<br />       url="/packages/svg_example/images/pepperoni.svg"<br />       on-polymer-response="{{responseReceived}}">&lt;/polymer-ajax><br />    &lt;!-- ... --><br />  &lt;/template><br />  &lt;script type="application/dart" src="x_pizza.dart">&lt;/script><br />&lt;/polymer-element></pre>When each is loaded, I populate a content map:<pre class=prettyprint><code>  Map svgContent = {};<br />  responseReceived(e, detail, node){<br />    svgContent[node.id] = detail['response'];<br />  }</code></pre>And then use that content to build up groups of toppings from that SVG text:<pre class=prettyprint><code>  _svgPepperoni()   => _svgImage('pepperoni');<br />  _svgSausage()     => _svgImage('sausage');<br />  _svgGreenPepper() => _svgImage('green_pepper');<br /><br />  _svgImage(basename) => new GElement()<br />    ..append(<br />      new SvgElement.svg(svgContent['$basename.svg'])<br />    );</code></pre>To animate, I convert the <code>_svgPepperoni()</code> method to make use of the two layers that I <a href="http://japhr.blogspot.com/2014/05/simple-mouse-animations-in-svg.html">added to the SVG toppings</a> the other day:<pre class=prettyprint><code><br />  _svgPepperoni() {<br />    var svg = _svgImage('pepperoni');<br />    return svg<br />      ..onMouseOver.listen((e){<br />        svg.query('#up').style.display = '';<br />        svg.query('#down').style.display = 'none';<br />      })<br />      ..onMouseLeave.listen((e){<br />        svg.query('#up').style.display = 'none';<br />        svg.query('#down').style.display = '';<br />      });<br />  }</code></pre>Which does the trick nicely:<br /><br /><a href="http://1.bp.blogspot.com/-E4MfRLaifuo/U4AZ02ym15I/AAAAAAAAZto/1n2TLAHW1oo/s1600/01-mouse_over_svg.png" imageanchor="1" ><img border="0" src="http://1.bp.blogspot.com/-E4MfRLaifuo/U4AZ02ym15I/AAAAAAAAZto/1n2TLAHW1oo/s400/01-mouse_over_svg.png" /></a><br /><br />Except for one little problem. The SVG image is clipped to 25 pixels, which cuts off the nice drop shadow effect of the topping:<br /><br /><a href="http://1.bp.blogspot.com/-Qb47O7lJPTI/U4AaPON_VcI/AAAAAAAAZtw/wr66CgF1cNU/s1600/03-no_drop_shadow.png" imageanchor="1" ><img border="0" src="http://1.bp.blogspot.com/-Qb47O7lJPTI/U4AaPON_VcI/AAAAAAAAZtw/wr66CgF1cNU/s640/03-no_drop_shadow.png" /></a><br /><br />Unfortunately, I can find no explanation for why this is the case. My best guess is that the path only accounts for roughly 25 square pixels, which is where the browser gets this value from. Setting width attributes and style values has no effect. It is also possible that this is a function of adding SVG elements to another SVG:<br /><br /><a href="http://3.bp.blogspot.com/-di7ACdA-dmg/U4Ab-y921JI/AAAAAAAAZt8/8xMKFfxhO3c/s1600/04-nested_svg.png" imageanchor="1" ><img border="0" src="http://3.bp.blogspot.com/-di7ACdA-dmg/U4Ab-y921JI/AAAAAAAAZt8/8xMKFfxhO3c/s640/04-nested_svg.png" /></a><br /><br />The “inner” SVG in this case is the pepperoni SVG, which I use to populate a <code>&lt;g></code> element for the topping. I do try adding the path directly to the topping <code>&lt;g></code> tag, but even that does not make a difference. <br /><br />Stumped, I call it a night here. Thankfully, the DOM mouse-over code was quite easy. Hopefully I am just making a dumb SVG mistake with the topping size. I will investigate further tomorrow.<br /><br /><span style="color: #ccc">Day #72</span>  <br /><br /><p class=bottom-chain-links><a href="http://japhr.blogspot.com/2014/05/polymer-elements-loading-svg-in-polymer.html">&lsaquo;prev</a> | <a href="http://japhr.blogspot.com/2013/11/new-chain-patterns-in-polymer.html">My Chain</a> | <a href="http://japhr.blogspot.com/2014/05/inkscape-vs-browser-svg-filter.html">next&rsaquo;</a> </p><script>var b_links = document.getElementsByClassName('bottom-chain-links'),      t_links = document.getElementsByClassName('top-chain-links');  if (b_links.length == 1 && t_links.length == 1) {   t_links[0].innerHTML = b_links[0].innerHTML; } </script><img src="http://feeds.feedburner.com/~r/JaphrByChrisStrom/~4/IeGAP1ub82M" height="1" width="1"/>
