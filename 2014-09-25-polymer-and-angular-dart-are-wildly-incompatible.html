---
title: 'Polymer and Angular Dart are Wildly Incompatible'
layout: post
published: '2014-09-25T23:59:00-04:00'
feed: 'japh(r) by Chris Strom'
link: 'http://feedproxy.google.com/~r/JaphrByChrisStrom/~3/fzeJuFUQYb0/polymer-and-angular-dart-are-wildly.html'
author:
    name: 'Chris Strom'
    email: noreply@blogger.com
    url: 'https://plus.google.com/117928918793969810642'
tags:
    - angular
    - chain
    - dart
    - dartlang
    - polymer
    - 'web components'

---

<div class=top-chain-links></div><br />I am desperately trying to get all chapter projects under test in <a href="http://patternsinpolymer.com/">Patterns in Polymer</a>. I have the JavaScript chapters done and am now working through the <a href="http://dartlang.org">Dart</a> versions of those same chapters. For most chapters, I already have tests, but sadly one chapter that lacks tests is the <a href="https://github.com/angular/angular.dart">Angular.dart</a> chapter. Hopefully I can mostly reuse the approach that I took in the <a href="http://angularjs.org/">AngularJS</a> version of the chapter, which is admittedly less that great coverage, but infinitely better than what I have currently for the Dart code. <br /><br />But first I need to get the darn thing to run.<br /><br />The dependencies in my <code>pubspec.yml</code> are unconstrained:<pre class=prettyprint>name: angular_example<br />dependencies:<br />  angular: any<br />  polymer: any<br />  angular_node_bind: any<br />dev_dependencies:<br />  unittest: any<br />transformers:<br />- polymer:<br />    entry_points:<br />    - web/index.html<br />    - test/index.html</pre>So the first think I do is a <code>pub upgrade</code>, which works just fine. I am unsure if <code>angular_node_bind</code>, which facilitates double binding of attributes between Polymer and Angular, is strictly necessary anymore, but I will find out.<br /><br />Next, I update the setup of the <code>web/index.html</code> smoke test page that I have, fire up the server and find that the update needs an update:<pre class=prettyprint>[Warning from polymer (Linter) on angular_example|web/index.html]:<br />line 27, column 7 of web/index.html: definition for Polymer element with tag name "ng-view" not found.<br />&lt;ng-view><br />^^^^^^^^^<br />[Warning from polymer (Linter) on angular_example|web/index.html]:<br /><b>line 24, column 3 of web/index.html: To run a polymer application you need to include the following HTML import: &lt;link rel="import" href="packages/polymer/polymer.html">.</b> This will include the common polymer logic needed to boostrap your application. The old style of initializing polymer with boot.js or initPolymer are now deprecated. <br />&lt;body><br />^^^^^^<br />Build completed successfully<br /></pre>I will ignore the <code>&lt;ng-view></code> warning for now. I do wonder if there is a way to tell the linter to ignore certain tags that are under the control of another library—grist for another day (maybe). The other warning is worrisome. I had just moved all of my Polymer.dart elements over to sourcing the <code>packages/web_components/platform.js</code> script and now it seems that Polymer.dart has changed under my feet.<br /><br />Except it hasn't.<br /><br />I wonder if this same message is occurring for the chapter projects currently being tested every day (to accumulate new dependencies). This message is not present for any of these chapters, which leads me to check the <code>pubspec.lock</code> file revealing that Polymer.dart is still back at 0.10:<pre class=prettyprint><code>  # ...<br />  polymer:<br />    description: polymer<br />    source: hosted<br />    version: "0.10.0-pre.12"</code></pre>It seems that angular_node_bind has not been updated for 4 months, leaving it constrained to an old Polymer version. So I drop it from <code>pubspec.yml</code>, run <code>pub upgrade</code> and find… that the really old version of Polymer is <i>still</i> being installed:<pre class=prettyprint>$ pub upgrade<br />  ....<br />  polymer 0.10.0-pre.12 (0.15.0 available)<br />  ...</pre>Yeah, thanks <a href="http://pub.dartlang.org/">Dart Pub</a>, I know 0.15 is available, why the heck aren't you installing it?!<br /><br />Hey, there is no need to get angry with pub, it can answer the question if I ask nicely—by upgrading just the problem dependency:<pre class=prettyprint>$ pub upgrade polymer<br />Resolving dependencies... (8.4s)<br />Incompatible version constraints on browser:<br />- angular 0.0.8 depends on version >=0.8.7 &lt;0.9.0<br />- polymer 0.15.0 depends on version >=0.10.0 &lt;0.11.0<br /></pre>Wait... that is a <i>really</i> old version of Angular.dart—it should be up to 0.14 nowadays. What gives pub?<pre class=prettyprint>$ pub upgrade angular polymer<br />Resolving dependencies... (7.9s)<br />Incompatible version constraints on args:<br />- angular 0.14.0 depends on version >=0.10.0 &lt;0.11.0<br />- polymer 0.15.0 depends on version >=0.11.0 &lt;0.13.0</pre>Gosh. Darn. It.<br /><br />This does not seem like a problem that I am going to solve in one night, but I would still like to have some idea of the extent of the problem. So I fork <a href="https://github.com/angular/angular.dart">Angular.dart</a>, clone it locally and hand-edit their <code>pubspec.yaml</code> to include a more recent of <code>args</code>:<pre class=prettyprint>name: angular<br />version: 0.14.0<br /># ...<br />dependencies:<br />  args: '>=0.10.0 <0.12.0'<br />  # ...<br /></pre>To use this forked Angular.dart repo, I switch the <code>pubspec.yaml</code> in my chapter project code to point to this local package:<pre class=prettyprint>name: angular_example<br />dependencies:<br /><b>  angular:<br />    path: /home/chris/repos/angular.dart</b><br />  polymer: any<br />  # angular_node_bind: any</pre>With that, I get:<pre class=prettyprint>$ pub upgrade<br />Resolving dependencies... (21.8s)<br />Incompatible version constraints on analyzer:<br />- angular 0.14.0 depends on version >=0.15.0 &lt;0.19.0<br />- polymer 0.10.0-pre.0 depends on version >=0.12.2 &lt;0.13.0</pre>Bleh. Now I am back to trying to install an old version of Polymer. I explicitly stick with the most recent by pub upgrading the polymer dependency:<pre class=prettyprint>$ pub upgrade polymer<br />Resolving dependencies... (1.6s)<br />Incompatible version constraints on code_transformers:<br />- angular 0.14.0 depends on version >=0.1.4+2 &lt;0.2.0<br />- polymer 0.15.0 depends on version >=0.2.3 &lt;0.3.0</pre>So I need to again hand-edit Angular.dart's <code>pubspec.yaml</code>, after which I find:<pre class=prettyprint>$ pub upgrade polymer<br />Resolving dependencies... (1.7s)<br />Incompatible version constraints on html5lib:<br />- angular 0.14.0 depends on version >=0.10.0 &lt;0.11.0<br /></pre>After another hand edit, I am finally able to <code>pub upgrade</code>:<pre class=prettyprint>$ pub upgrade polymer<br />...<br />* angular 0.14.0 from path /home/chris/repos/angular.dart (was 0.12.0)<br />...<br />> polymer 0.15.0 (was 0.10.0-pre.12)<br />...<br /></pre>In the end I had to change three different dependencies to get the latest Angular.dart and Polymer.dart installed side-by-side:<pre class=prettyprint>name: angular<br /># ... <br />dependencies:<br />  args: '>=0.10.0 &lt;0.12.0'<br />  # ...<br />  code_transformers: '>=0.1.4+2 &lt;0.3.0'<br />  # ...<br />  html5lib: '>=0.10.0 &lt;0.13.0'<br />  # ...</pre>That is very much a bummer. It is especially troublesome for the book. Do I pursue this path and attempt to figure out if Angular.dart works with these new dependencies? Or do I stick with the old version of the packages? Neither is particularly appealing, but I will likely start with a limited attempt at working with a dependency augmented version of Angular.dart. I would hope that these two packages will be eventually consistent and dependency augmentation would position me best for that eventual future.   <p><span style="color: #ccc">Day #194</span>  </p><p class=bottom-chain-links><a href="http://japhr.blogspot.com/2014/09/still-cant-test-dart-keyboard-events-still.html">&lsaquo;prev</a> | <a href="http://japhr.blogspot.com/2013/11/new-chain-patterns-in-polymer.html">My Chain</a> | <a href="http://japhr.blogspot.com/2014/09/an-angular-app-using-polymer-element.html">next&rsaquo;</a> </p><script>var b_links = document.getElementsByClassName('bottom-chain-links'),      t_links = document.getElementsByClassName('top-chain-links');  if (b_links.length == 1 && t_links.length == 1) {   t_links[0].innerHTML = b_links[0].innerHTML; } </script><img src="//feeds.feedburner.com/~r/JaphrByChrisStrom/~4/fzeJuFUQYb0" height="1" width="1" alt=""/>
