---
title: 'Model Driven Polymer Attributes'
layout: post
published: '2014-05-30T23:59:00-04:00'
feed: 'japh(r) by Chris Strom'
link: 'http://feedproxy.google.com/~r/JaphrByChrisStrom/~3/Icp5KmcKQno/model-driven-attributes.html'
author:
    name: 'Chris Strom'
    email: noreply@blogger.com
    url: 'https://plus.google.com/117928918793969810642'
tags:
    - chain
    - dart
    - dartlang
    - mdv
    - polymer

---

<div class=top-chain-links></div><br />Up tonight, a (hopefully) simple update of a <a href="http://www.polymer-project.org/">Polymer</a> feature.<br /><br />Last night I was able to use attributes to set the initial toppings for a pizza in the <code>&lt;x-pizza></code> Polymer-based custom element:<br /><br /><a href="http://4.bp.blogspot.com/-6TqRzOQfotg/U4kgDWHeQOI/AAAAAAAAZ9E/WtGgijtHJbQ/s1600/01-setting_polymer_attributes.png" imageanchor="1" ><img border="0" src="http://4.bp.blogspot.com/-6TqRzOQfotg/U4kgDWHeQOI/AAAAAAAAZ9E/WtGgijtHJbQ/s400/01-setting_polymer_attributes.png" /></a><br /><br />Today, I would like to do the opposite: ensure that topping changes are reflected in the same attributes that are used to set the initial toppings. That is, if an <code>&lt;x-pizza></code> starts with:<pre class=prettyprint>&lt;x-pizza toppings="pepperoni,sausage">&lt;/x-pizza></pre>And the user adds green peppers, then the attribute should report:<pre class=prettyprint>&lt;x-pizza toppings="pepperoni,sausage,green peppers">&lt;/x-pizza></pre>Mercifully, this is fairly easy in Polymer. It also helps that the infrastructure is already in place in the backing <code>x_pizza.dart</code> backing class. The whole toppings attribute (<code>toppings</code>) and the first and second half attributes (<code>toppings1</code> and <code>toppings2</code>) are already published in the backing class. I also have an <code>updatePizzaState</code> method that gets invoked whenever the model in my model driven view is updated:<pre class='prettyprint'>@CustomTag('x-pizza')<br />class XPizza extends PolymerElement {<br />  // ...<br /><b>  @published String toppings = '';<br />  @published String toppings1 = '';<br />  @published String toppings2 = '';</b><br /><br />  XPizza.created(): super.created() {<br /><b>    model = new Pizza()<br />      ..changes.listen(updatePizzaState);</b><br />    // ...<br />  }<br />  // ...<br />}</pre>The above <code>changes</code> stream just works because the model class has all the observables in place:<pre class=prettyprint>class Pizza extends Observable {<br /><b>  ObservableList&lt;String> firstHalfToppings = toObservable([]);<br />  ObservableList&lt;String> secondHalfToppings = toObservable([]);<br />  ObservableList&lt;String> wholeToppings = toObservable([]);</b><br /><br />  Pizza() {<br />    firstHalfToppings.changes.listen((_)=> notifyChange(_));<br />    secondHalfToppings.changes.listen((_)=> notifyChange(_));<br />    wholeToppings.changes.listen((_)=> notifyChange(_));<br />  }<br />}<br /></pre>Back in the MDV class, <code>updatePizzaState</code> needs only a new secondary method call, to the new <code>_updateAttributes()</code> method which simply assigns the three attributes::<pre class=prettyprint><code>  <br />  // ...<br />  updatePizzaState([_]) {<br />    _updateText();<br />    _updateGraphic();<br /><b>    _updateAttributes();</b><br />  }<br />  // ...<br /><b>  _updateAttributes() {<br />    toppings = model.wholeToppings.join(',');<br />    toppings1 = model.firstHalfToppings.join(',');<br />    toppings2 = model.secondHalfToppings.join(',');<br />  }</b><br />  // ...</code></pre>And that does the trick nicely:<br /><br /><a href="http://3.bp.blogspot.com/-nFAXapJA2FQ/U4laUzQGKXI/AAAAAAAAZ9U/GaUqOQeSH2A/s1600/01-more_toppings_attribtues.png" imageanchor="1" ><img border="0" src="http://3.bp.blogspot.com/-nFAXapJA2FQ/U4laUzQGKXI/AAAAAAAAZ9U/GaUqOQeSH2A/s400/01-more_toppings_attribtues.png" /></a><br /><br />I am not sure that is the simplest solution possible, so I had hoped to drive some of this with tests. Unfortunately, testing turns out to be a little harder than expected. But that's a tale for tomorrow. For today, I am happy that updating attributes had no unexpected surprises.<br /><br /><br /><span style="color: #ccc">Day #79</span>  <br /><br /><p class=bottom-chain-links><a href="http://japhr.blogspot.com/2014/05/waiting-for-polymer-assets.html">&lsaquo;prev</a> | <a href="http://japhr.blogspot.com/2013/11/new-chain-patterns-in-polymer.html">My Chain</a> | <a href="http://japhr.blogspot.com/2014/05/the-unforunate-case-of-annotation-and.html">next&rsaquo;</a> </p><script>var b_links = document.getElementsByClassName('bottom-chain-links'),      t_links = document.getElementsByClassName('top-chain-links');  if (b_links.length == 1 && t_links.length == 1) {   t_links[0].innerHTML = b_links[0].innerHTML; } </script><img src="http://feeds.feedburner.com/~r/JaphrByChrisStrom/~4/Icp5KmcKQno" height="1" width="1"/>
