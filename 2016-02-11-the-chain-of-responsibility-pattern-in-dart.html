---
title: 'The Chain of Responsibility Pattern in Dart'
layout: post
published: '2016-02-11T21:41:00-08:00'
feed: 'japh(r) by Chris Strom'
link: 'http://feedproxy.google.com/~r/JaphrByChrisStrom/~3/YBYoQCGifzI/the-chain-of-responsibility-pattern-in.html'
author:
    name: 'Chris Strom'
    email: noreply@blogger.com
    url: 'https://plus.google.com/117928918793969810642'
tags:
    - chain
    - 'chain of responsibility pattern'
    - dart
    - dartlang
    - 'design patterns'

---

<div class=top-chain-links></div><br />How can anyone not love a pattern named <a href="https://en.wikipedia.org/wiki/Chain-of-responsibility_pattern">chain of responsibility</a>? I mean c'mon, the name invokes all sorts of linked interaction between objects that somehow manage to cooperate on ownership for an action of some sort. It's the kind of thing that makes bureaucracy so awful, but there's a pattern in programming that makes it elegant. So what's not to love?<br /><br />I start my investigation of the pattern as I so often do, by copying the Java example on the Wikipedia page into lovely <a href="http://dartlang.org">Dart</a> code. The prime mover in the pattern—the interface used by the outside world—is the handler. It gets its name, as one might suspect, from its job to… handle a request (and then optionally forward the request on). The handler in the Wikipedia example describes purchasing power.<br /><br />In Dart, the purchasing power interface looks like:<pre class=prettyprint>abstract class PurchasePower {<br />  PurchasePower _successor;<br />  void set successor(PurchasePower successor) {<br />    _successor = successor;<br />  }<br /><br />  void processRequest(PurchaseRequest request);<br />}</pre>The "chain" portion of this pattern is handled by the <code>_successor</code> private variable. If this <code>PurchasePower</code> class does not want to handle the request, the <code>_successor</code> is specified as the next in the chain. The <code>processRequest()</code> method holds the responsibility for handling the request. It receives a purchase request and must decide to handle it or forward the request on to the <code>_successor</code>. <br /><br />The lowest level of purchasing power in the example is that of a lowly manager:<pre class=prettyprint>class ManagerPurchasePower extends PurchasePower {<br />  final double _allowable = 10 * 1000;<br /><br />  void processRequest(PurchaseRequest request) {<br />    if (request.amount < _allowable) {<br />      print("Manager will approve $request.");<br />    }<br />    else if (_successor != null) {<br />      _successor.processRequest(request);<br />    }<br />  }<br />}</pre><p>The upper limit that a manager can approve of is $10,000. If the request is for less than that, then the chain ends with the approval by the manager. If it is more than that, then the <code>_successor</code> is then asked to process the same request.</p><p>The object being processed by the pattern's handler is a purchase request:</p><pre class=prettyprint>class PurchaseRequest {<br />  double amount;<br />  String purpose;<br />  PurchaseRequest(this.amount, this.purpose);<br />  String toString() =><br />    "\$${amount.toStringAsFixed(2)} for $purpose";<br />}</pre><p>It requires a dollar amount and a description of the reason for the purchase. I provide a <code>toString()</code> method so that the entire object can be interpolated in a string (as it is when the manager approves the request).</p><p>That is the whole of the pattern. For it to be a true chain, I declare director, VP and presidential purchasing power. Anything that the president, who will be last in succession, cannot purchase needs board approval and not another successor:</p><pre class=prettyprint>class PresidentPurchasePower extends PurchasePower {<br />  final double _allowable = 60 * 1000;<br /><br />  void processRequest(PurchaseRequest request) {<br />    if (request.amount < _allowable) {<br />      print("President will approve $request");<br />    }<br />    else {<br />      print("Your request for $request needs a board meeting!");<br />    }<br />  }<br />}</pre>In client code, I can create each of these purchasing power objects:<pre class=prettyprint><code>  var manager = new ManagerPurchasePower();<br />  var director = new DirectorPurchasePower();<br />  var vp = new VicePresidentPurchasePower();<br />  var president = new PresidentPurchasePower();</code></pre>Then I can specify the chain:<pre class=prettyprint><code>  manager.successor = director;<br />  director.successor = vp;<br />  vp.successor = president;</code></pre>Lastly, I can parse the dollar amount being requested and start the chain on its merry path:<pre class=prettyprint><code>  var amount = (args[0] == null) ?<br />    1000 : double.parse(args[0]);<br /><br />  var req = new PurchaseRequest(amount, "General Purpose Usage");<br />  manager.processRequest(req);</code></pre>With that, I can quickly determine who to bug for the new company automobiles (including my Tesla):<pre class=prettyprint>$ ./bin/purchase.dart 5000 <br />Manager will approve $5000.00 for General Purpose Usage.<br />$ ./bin/purchase.dart 10000<br />Director will approve $10000.00 for General Purpose Usage<br />$ ./bin/purchase.dart 20000<br />Vice President will approve $20000.00 for General Purpose Usage<br />$ ./bin/purchase.dart 50000<br />President will approve $50000.00 for General Purpose Usage<br />$ ./bin/purchase.dart 75000<br />Your request for $75000.00 for General Purpose Usage needs a board meeting!</pre><p>That was a nice start to exploration of the chain of responsibility pattern. I am already looking forward to kicking the tires on this pattern a little more.</p><p><i>Play with the code on DartPad: <a href="https://dartpad.dartlang.org/818215777ae57169e6a1">https://dartpad.dartlang.org/818215777ae57169e6a1</a>.</i></p><br><p><span style="color: #ccc">Day #92</span>  </p><p class=bottom-chain-links><a href="http://japhr.blogspot.com/2016/02/factory-method-pattern-and-polymer.html">&lsaquo;prev</a> | <a href="http://japhr.blogspot.com/2015/11/design-patterns-in-dart.html">My Chain</a> | <span style="color: #ccc">next&rsaquo;</span> </p><script>var b_links = document.getElementsByClassName('bottom-chain-links'),      t_links = document.getElementsByClassName('top-chain-links');  if (b_links.length == 1 && t_links.length == 1) {   t_links[0].innerHTML = b_links[0].innerHTML; } </script><img src="http://feeds.feedburner.com/~r/JaphrByChrisStrom/~4/YBYoQCGifzI" height="1" width="1" alt=""/>
